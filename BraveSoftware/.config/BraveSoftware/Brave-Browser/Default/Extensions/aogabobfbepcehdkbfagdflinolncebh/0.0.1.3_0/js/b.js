function showTopSites(e){chrome.topSites.get(function(t){var n=document.getElementById(e);_.each(t.slice(0,5),function(e){var t=document.createElement("a"),o='<img src="chrome://favicon/'+e.url+'">';t.setAttribute("href",e.url);try{var s=e.url.match(/^https?\:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i)[1];s.length>14&&(s.match(/\./g)||[]).length>1?t.innerHTML=o+s.substring(s.indexOf(".")+1,s.length):t.innerHTML=o+s}catch(i){console.log("hostname failed: "+e.url),t.innerHTML=o+e.title.substring(0,14)}t.title=e.title;var a=document.createElement("li");a.className="extension-links-item",a.appendChild(t),n.appendChild(a)})})}function getToggleContainer(){return $(".is-toggleable").find(".is-toggler").parents(".is-toggleable")}$.ajax({url:"https://tacoapp.com/user/me.json",type:"GET",dataType:"json",success:function(e){!e.theme||theme&&_.isEqual(theme,e.theme)||(console.log("Caching theme"),setTheme(e.theme),localStorage.theme=JSON.stringify(e.theme),console.log("Cached theme"))}}),window.addEventListener("load",function(){return theme?theme.show_top_sites?void chrome.permissions.contains({permissions:["topSites"]},function(e){e?showTopSites("extension-links"):(message=' <a id="topsites-permission-request" href="#">Click here to enable frequently accessed sites</a>',Taco.Tasks.trigger("taco:alert:notification",message),document.querySelector("#topsites-permission-request").addEventListener("click",function(e){chrome.permissions.request({permissions:["topSites"]},function(e){e&&showTopSites("extension-links")})}))}):void console.log("show_top_sites disabled"):void console.log("show_top_sites value not found")}),Mousetrap.bind("\\",function(){Taco.Tasks.trigger("taco:sidebar:toggle")}),Mousetrap.bind("/",function(){return $container=getToggleContainer(),$container.hasClass("is-active")?!0:(Taco.Tasks.trigger("taco:sidebar:show"),$container.addClass("is-active"),$container.find(":input:first").focus(),!1)}),Mousetrap.bind("esc",function(){$container=getToggleContainer(),$container.hasClass("is-active")&&($container.removeClass("is-active"),Taco.Tasks.trigger("taco:search:stopped"))}),Mousetrap.bind("enter",function(){$container=getToggleContainer(),$container.hasClass("is-active")&&$container.find(":input:first").blur()}),$(function(){$("#menu [data-toggle=tooltip]").tooltip({placement:"bottom"})});