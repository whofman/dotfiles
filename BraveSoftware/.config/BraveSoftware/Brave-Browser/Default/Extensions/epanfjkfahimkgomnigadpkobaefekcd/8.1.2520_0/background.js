/**
 * Blur Copyright (c) 2008-2015 by Abine, Inc. All Rights Reserved.
 *
 * This software is the confidential and proprietary information
 * of Abine, Inc. ("Confidential Information"), subject
 * to the Non-Disclosure Agreement and/or License Agreement you entered
 * into with Abine. You shall use such Confidential Information only
 * in accordance with the terms of said Agreement(s). Abine makes
 * no representations or warranties about the suitability of the
 * software. The software is provided with ABSOLUTELY NO WARRANTY
 * and Abine will NOT BE LIABLE for ANY DAMAGES resulting from
 * the use of the software.
 *
 * Contact license@getabine.com with any license-related questions.
 *
 * https://www.abine.com
 * @license
 *
 */ABINE_DNTME.define("abine/url",function(){function i(e){return e?e.toLowerCase().replace(/\w+/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1)}):e}function s(e){var t=e.match(n);return t&&1<t.length?t[1].toString():e}function r(e){var t=s(e);if(t.match(l)||t.match(u))return t;var n=t.split(".");if(n.length<2)return t;var a=n.pop(),i=n.pop(),r=i+"."+a;return o.test(r)&&0<n.length&&(a=r,r=(i=n.pop())+"."+a),c.test(r)&&0<n.length&&!t.match(/signup.wordpress.com|new.aol.com|(oauth|www).squarespace.com|secure.onsugar.com|www.tumblr.com/i)&&(r=n.pop()+"."+r),r}function e(e){if((e=r(e)).match(l))return e;var t=e.split(".");if(2<t.length){var n=t.pop(),a=t.pop();return e=a+"."+n,o.test(e)&&0<t.length&&(n=e,e=(a=t.pop())+"."+n),c.test(e)&&0<t.length?i(a+" "+t.pop()):i(a)}return i(t[0])}var o=/^(((co|ac|go|ed|ga|mn|nj|nc|or|ne|in|gr|ca|on|pa|qc|bc|sh|at|va|us|il|tv|me|lg|at|ny|gv|com|edu|org|net|gov|mil|biz)\...)|(163\.com)|(kiev\.ua)|(gob\.pe)|(gen\.tr)|(waw.pl)|(jus.br))$/,c=/^(((go|typepad|tumblr|blogspot|squarespace|wordpress|myshopify|blogfa|blog|blogs|blinkweb|ning|posterous|over-blog|mihanblog|appspot|webs|weebly|onsugar|ucoz|uk|pch|ecwid)(\.com|\.in))|(nic\.in)|((ucoz|spb|narod)\.ru)|(blog\.163\.com)|((gouv|free)\.fr)|(uol\.com\.br)|(web\.id)|(gob\.mx)|(blogg\.se)|(home.pl))$/,n=/^http(?:s)?\:\/\/([^/\?\#]+)/im,l=/^[0-9\.]+(:[0-9]+)?$/,u=/^localhost(:[0-9]+)?$/;return{getHostname:s,getTLD:r,getSiteName:e}}),
/**
 * Copyright (c) 2010 Zef Hemel <zef@zef.me>
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
ABINE_DNTME.define("persistence",[],function(){function initPersistence(_){if(_.isImmutable)return _;_.isImmutable=function(e){return"id"==e},_.defineProp=function(e,t,n,a){Object.defineProperty?Object.defineProperty(e,t,{get:function(){return a()},set:function(e){n(e)}}):(e.__defineSetter__(t,function(e){n(e)}),e.__defineGetter__(t,function(){return a()}))},_.set=function(e,t,n){if(_.isImmutable(t))throw new Error("immutable field: "+t);e[t]=n},_.get=function(e,t){return 1==arguments.length?e:e[t]},function(){function h(e){return b[e]}function e(e){this.trackedObjects={},this.trackedObjectsByEntity={},this.objectsToRemove={},this.objectsRemoved=[],this.globalPropertyListeners={},this.queryCollectionCache={},this.conn=e}function g(s){function l(o,e,t){var n=E.getArgs(arguments,[{name:"session",optional:!0,check:_.isSession,defaultValue:_},{name:"obj",optional:!0,check:function(e){return e},defaultValue:{}}]);if(u.isMixin)throw new Error("Cannot instantiate mixin");o=n.session,e=n.obj;var c=this;for(var a in this.id=e.id||_.createUUID(),this._new=!0,this._type=s,this._dirtyProperties={},this._data={},this._data_obj={},this._session=o||_,this.subscribers={},u.fields)!function(){if(u.fields.hasOwnProperty(a)){var n=a;_.defineProp(c,n,function(e){var t=c._data[n];(t!==e||t&&e&&t.getTime&&e.getTime)&&(c._data[n]=e,c._dirtyProperties[n]=t,c.triggerEvent("set",c,n,e),c.triggerEvent("change",c,n,e),o.propertyChanged(c,n,t,e))},function(){return c._data[n]}),c._data[a]=d(u.fields[a])}}();for(var i in u.hasOne)u.hasOne.hasOwnProperty(i)&&function(){var r=i,s=u.hasOne[i].type.meta.isMixin?r+"_class":null;_.defineProp(c,r,function(e){var t=c._data[r],n=c._data_obj[r]||o.trackedObjects[c._data[r]];if(null==e?(c._data[r]=null,c._data_obj[r]=undefined,s&&(c[s]="")):e.id?(c._data[r]=e.id,c._data_obj[r]=e,s&&(c[s]=e._type),o.add(e),o.add(c)):c._data[r]=e,c._dirtyProperties[r]=t,c.triggerEvent("set",c,r,e),c.triggerEvent("change",c,r,e),u.hasOne[r].inverseProperty){var a,i=c[r];if(i)(a=i[u.hasOne[r].inverseProperty]).list&&a._filter&&a.triggerEvent("change",c,r,e);if(n)(a=n[u.hasOne[r].inverseProperty]).list&&a._filter&&a.triggerEvent("change",c,r,e)}},function(){if(c._data[r]){if(c._data_obj[r]!==undefined)return c._data_obj[r];if(c._data[r]&&o.trackedObjects[c._data[r]])return c._data_obj[r]=o.trackedObjects[c._data[r]],c._data_obj[r];throw new Error("Property '"+r+"' of '"+u.name+"' with id: "+c._data[r]+" not fetched, either prefetch it or fetch it manually.")}return null})}();for(var i in u.hasMany)u.hasMany.hasOwnProperty(i)&&function(){var s=i;u.hasMany[s].manyToMany?_.defineProp(c,s,function(e){if(!e||!e._items)throw new Error("Not yet supported.");for(var t=e._items,n=0;n<t.length;n++)_.get(c,s).add(t[n])},function(){if(c._data[s])return c._data[s];var e=u.hasMany[s],t=e.type.meta,n=t.hasMany[e.inverseProperty],a=e.mixin?e.mixin.meta.name:u.name,i=n.mixin?n.mixin.meta.name:t.name,r=new _.ManyToManyDbQueryCollection(o,t.name);return r.initManyToMany(c,s),r._manyToManyFetch={table:e.tableName,prop:a+"_"+s,inverseProp:i+"_"+e.inverseProperty,id:c.id},c._data[s]=r,o.uniqueQueryCollection(r)}):_.defineProp(c,s,function(e){if(!e||!e._items)throw new Error("Not yet supported.");for(var t=e._items,n=0;n<t.length;n++)_.get(c,s).add(t[n])},function(){if(c._data[s])return c._data[s];var e=o.uniqueQueryCollection(new _.DbQueryCollection(o,u.hasMany[s].type.meta.name).filter(u.hasMany[s].inverseProperty,"=",c));return c._data[s]=e})}();for(var r in this.initialize&&this.initialize(),e)e.hasOwnProperty(r)&&"id"!==r&&_.set(c,r,e[r])}function f(n,i,r,e){n._session;var t=[],s=h(n._type),a=s.fields;for(var o in r)r.hasOwnProperty(o)&&t.push(o);var c=[],l=[];t.forEach(function(e){!0!==r[e]||s.hasMany[e]?l.push(e):c.push(e)});var u=n._data,d={};c.forEach(function(e){"id"===e?d.id=n.id:s.hasOne[e]?d[e]=u[e]?{id:u[e]}:null:d[e]=_.entityValToJson(u[e],a[e])}),t=l.slice(),_.asyncForEach(t,function(a,t){s.hasOne[a]?n.fetch(i,a,function(e){e?f(e,i,r[a],function(e){d[a]=e,t()}):(d[a]=null,t())}):s.hasMany[a]&&_.get(n,a).list(function(n){d[a]=[],_.asyncForEach(n,function(e,t){e=n.pop();!0===r[a]?(d[a].push({id:e.id}),t()):f(e,i,r[a],function(e){d[a].push(e),t()})},t)})},function(){e(d)})}if(v[s])return v[s];var u=b[s];l.prototype=new r,l.meta=u,l.prototype.equals=function(e){return this.id==e.id},l.prototype.toJSON=function(){var e={id:this.id};for(var t in this._data)this._data.hasOwnProperty(t)&&("object"==typeof this._data[t]&&null!=this._data[t]?this._data[t].toJSON!=undefined&&(e[t]=this._data[t].toJSON()):e[t]=this._data[t]);return e},l.prototype.selectJSON=function(e,t,n){var a=this,i=E.getArgs(arguments,[{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"props",optional:!1},{name:"callback",optional:!1}]);if(e=i.tx,t=i.props,n=i.callback,e){var s={};t.forEach(function(e){for(var t=s,n=e.split("."),a=0;a<n.length;a++){var i=n[a];if(a===n.length-1)if("*"===i){for(var r in t.id=!0,u.fields)u.fields.hasOwnProperty(r)&&(t[r]=!0);for(var r in u.hasOne)u.hasOne.hasOwnProperty(r)&&(t[r]=!0);for(var r in u.hasMany)u.hasMany.hasOwnProperty(r)&&(t[r]=!0)}else if("["===i[0]){(i=i.substring(1,i.length-1)).split(/,\s*/).forEach(function(e){t[e]=!0})}else t[i]=!0;else t[i]=t[i]||{},t=t[i]}}),f(this,e,s,n)}else this._session.transaction(function(e){a.selectJSON(e,t,n)})},l.prototype.fetch=function(e,t,n){var a=E.getArgs(arguments,[{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"rel",optional:!1,check:E.hasType("string")},{name:"callback",optional:!1,check:E.isCallback()}]);e=a.tx,t=a.rel,n=a.callback;var i=this,r=this._session;if(e)if(this._data[t])if(this._data_obj[t])n&&n(this._data_obj[t]);else{var s=u.hasOne[t].type;s.meta.isMixin&&(s=g(this._data[t+"_class"])),s.load(r,e,this._data[t],function(e){i._data_obj[t]=e,n&&n(e)})}else n&&n(null);else r.transaction(function(e){i.fetch(e,t,n)})},l.prototype.markDirty=function(e){this._dirtyProperties[e]=!0},l.all=function(e){return(e=E.getArgs(arguments,[{name:"session",optional:!0,check:_.isSession,defaultValue:_}]).session).uniqueQueryCollection(new p(e,s))},l.query=function(n,a){_.transaction(function(e){var t="";n&&(t=" where "+n),e.executeSql("SELECT * FROM "+s+t,null,function(e){a(e)})})},l.deleteQuery=function(n,a){_.transaction(function(e){var t="";n&&(t=" where "+n),e.executeSql("DELETE FROM "+s+t,null,function(e){a(e)})})},l.fromSelectJSON=function(s,o,c,n){function e(a){a||(a=new l(s),c.id&&(a.id=c.id)),s.add(a);var e=[];for(var t in c)if(c.hasOwnProperty(t)){if("id"===t)continue;u.fields[t]?_.set(a,t,_.jsonToEntityVal(c[t],u.fields[t])):(u.hasOne[t]||u.hasMany[t])&&e.push(t)}_.asyncForEach(e,function(t,n){if(u.hasOne[t])u.hasOne[t].type.fromSelectJSON(s,o,c[t],function(e){_.set(a,t,e),n()});else if(u.hasMany[t]){var i=_.get(a,t),e=c[t].slice(0),r=u.hasMany[t].type;i.list(o,function(a){_.asyncForEach(e,function(e,n){r.fromSelectJSON(s,o,e,function(e){for(var t=0;t<a.length;t++)if(a[t].id===e.id)return void n();i.add(e),n()})},function(){n()})})}},function(){n(a)})}var t=E.getArgs(arguments,[{name:"session",optional:!0,check:_.isSession,defaultValue:_},{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"jsonObj",optional:!1},{name:"callback",optional:!1,check:E.isCallback()}]);s=t.session,o=t.tx,c=t.jsonObj,n=t.callback,o?("string"==typeof c&&(c=JSON.parse(c)),c?c.id?l.load(s,o,c.id,e):e(new l(s)):n(null)):s.transaction(function(e){l.fromSelectJSON(s,e,c,n)})},l.load=function(e,t,n,a){var i=E.getArgs(arguments,[{name:"session",optional:!0,check:_.isSession,defaultValue:_},{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"id",optional:!1,check:E.hasType("string")},{name:"callback",optional:!0,check:E.isCallback(),defaultValue:function(){}}]);l.findBy(i.session,i.tx,"id",i.id,i.callback)},l.findBy=function(t,e,n,a,i){var r=E.getArgs(arguments,[{name:"session",optional:!0,check:_.isSession,defaultValue:_},{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"property",optional:!1,check:E.hasType("string")},{name:"value",optional:!1},{name:"callback",optional:!0,check:E.isCallback(),defaultValue:function(){}}]);if(t=r.session,e=r.tx,n=r.property,a=r.value,i=r.callback,"id"===n&&a in t.trackedObjects)i(t.trackedObjects[a]);else{var s=l.meta;if(s.alternatePK&&n===s.alternatePK&&t.trackedObjectsByEntity){var o=s.name+"."+s.alternatePK;if(!(o in t.trackedObjectsByEntity&&a in t.trackedObjectsByEntity[o]))return l.cached?void i(null):void l.initCache(function(){l.findBy(t,e,n,a,i)});if(t.trackedObjectsByEntity[o][a]in t.trackedObjects)return void i(t.trackedObjects[t.trackedObjectsByEntity[o][a]]);delete t.trackedObjectsByEntity[o][a]}e?l.all(t).filter(n,"=",a).one(e,function(e){i(e)}):t.transaction(function(e){l.findBy(t,e,n,a,i)})}},l.index=function(e,t){var n=t||{};"string"==typeof e&&(e=[e]),n.columns=e,u.indexes.push(n)},l.hasMany=function(e,t,n){var a=t.meta;if(a.hasMany[n]){var i=u.name+"_"+e+"_"+a.name,r=a.name+"_"+n+"_"+u.name;r<i&&(i=r),u.hasMany[e]={type:t,inverseProperty:n,manyToMany:!0,tableName:i},a.hasMany[n]={type:l,inverseProperty:e,manyToMany:!0,tableName:i},delete u.hasOne[e],delete u.fields[e+"_class"]}else u.hasMany[e]={type:t,inverseProperty:n},a.hasOne[n]={type:l,inverseProperty:e},u.isMixin&&(a.fields[n+"_class"]=_.typeMapper?_.typeMapper.classNameType:"TEXT")},l.hasOne=function(e,t,n){u.hasOne[e]={type:t,inverseProperty:n},t.meta.isMixin&&(u.fields[e+"_class"]=_.typeMapper?_.typeMapper.classNameType:"TEXT")},l.is=function(e){var t=e.meta;if(!t.isMixin)throw new Error("not a mixin: "+e);for(var n in e.meta.mixedIns=e.meta.mixedIns||[],e.meta.mixedIns.push(u),t.fields)t.fields.hasOwnProperty(n)&&(u.fields[n]=t.fields[n]);for(var a in t.hasOne)t.hasOne.hasOwnProperty(a)&&(u.hasOne[a]=t.hasOne[a]);for(var a in t.hasMany)t.hasMany.hasOwnProperty(a)&&(t.hasMany[a].mixin=e,u.hasMany[a]=t.hasMany[a])};for(var e=_.entityDecoratorHooks,t=0;t<e.length;t++)e[t](l);return v[s]=l}function t(){if(_.typeMapper&&_.typeMapper.newUuid)return _.typeMapper.newUuid();for(var e=[],t="0123456789ABCDEF",n=0;n<32;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[12]="4",e[16]=t.substr(3&e[16]|8,1),e.join("")}function d(e){if(_.typeMapper&&_.typeMapper.defaultValue)return _.typeMapper.defaultValue(e);switch(e){case"TEXT":return"";case"BOOL":return!1;default:return-1!==e.indexOf("INT")?0:-1!==e.indexOf("CHAR")?"":null}}function a(e,t){for(var n=e.length,a=0;a<n;a++){var i=e[a];if(i.equals&&i.equals(t))return!0;if(i===t)return!0}return!1}function n(e,t){for(var n=e.length,a=0;a<n;a++){var i=e[a];if(i.equals&&i.equals(t))return void e.splice(a,1);if(i===t)return void e.splice(a,1)}}function i(e,t,n){this.obj=e,this.eventType=t,this.fn=n}function r(){this.subscribers={}}function s(){}function o(e,t){this.left=e,this.right=t}function c(e,t){this.left=e,this.right=t}function l(e,t,n){this.property=e,this.operator=t.toLowerCase(),this.value=n}function u(){}function f(e,t){this.init(e,t,f)}function p(e,t){this.init(e,t,p)}function m(e,t){this.init(e,t,_.ManyToManyDbQueryCollection),this._localAdded=[],this._localRemoved=[]}function y(e){this.init(_,null,y),this._items=e||[]}var b={},v={};_.getEntityMeta=function(){return b},_.trackedObjects={},_.trackedObjectsByEntity={},_.objectsToRemove={},_.objectsRemoved=[],_.globalPropertyListeners={},_.queryCollectionCache={},_.getObjectsToRemove=function(){return this.objectsToRemove},_.getTrackedObjects=function(){return this.trackedObjects},_.entityDecoratorHooks=[],_.flushHooks=[],_.schemaSyncHooks=[],_.debug=!1,_.subscribeToGlobalPropertyListener=function(e,t,n){var a=t+"__"+n;if(a in this.globalPropertyListeners){for(var i=this.globalPropertyListeners[a],r=0;r<i.length;r++)if(i[r]===e)return;this.globalPropertyListeners[a].push(e)}else this.globalPropertyListeners[a]=[e]},_.unsubscribeFromGlobalPropertyListener=function(e,t,n){for(var a=t+"__"+n,i=this.globalPropertyListeners[a],r=0;r<i.length;r++)if(i[r]===e)return void i.splice(r,1)},_.propertyChanged=function(e,t,n,a){if(this.trackedObjects[e.id]){var i=e._type+"__"+t;if(i in this.globalPropertyListeners)for(var r=this.globalPropertyListeners[i],s=0;s<r.length;s++){var o=r[s],c=e._data;c[t]=n;var l=o._filter.match(c);c[t]=a,l!=o._filter.match(c)&&o.triggerEvent("change",o,e)}}},_.objectRemoved=function(e){var t=e._type;if(this.queryCollectionCache[t]){var n=this.queryCollectionCache[t];for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i._filter.match(e)&&i.triggerEvent("change",i,e)}}},_.getMeta=h,(e.prototype=_).Session=e,_.undefine=function(e){v[e]&&delete v[e],e in b&&delete b[e]},_.define=function(e,t){if(b[e])return g(e);var n={name:e,fields:t,isMixin:!1,indexes:[],hasMany:{},hasOne:{}};return b[e]=n,g(e)},_.isDefined=function(e){return!!b[e]},_.defineMixin=function(e,t){var n=this.define(e,t);return n.meta.isMixin=!0,n},_.isTransaction=function(e){return!e||e&&e.executeSql},_.isSession=function(e){return!e||e&&e.schemaSync},_.addToEntityCache=function(e){var t=v[e._type];if(t.meta.cached){var n=t.meta.alternatePK||"id";if(n){var a=e._type+"."+n;a in this.trackedObjectsByEntity||(this.trackedObjectsByEntity[a]={}),this.trackedObjectsByEntity[a][e[n]]=e.id}}this.addIndex(e)},_.clearFromEntityCache=function(e){if(e){var t=v[e._type];if(t.meta.cached){var n=t.meta.alternatePK||"id";if(n){var a=e._type+"."+n;a in this.trackedObjectsByEntity&&(e.id==this.trackedObjectsByEntity[a][e[n]]&&delete this.trackedObjectsByEntity[a][e[n]],e.id in this.trackedObjects&&delete this.trackedObjects[e.id])}}this.removeIndex(e)}},_.addIndex=function(e){if(e){var t=v[e._type];if(t.meta.indexed){var n=(e[t.meta.indexed]||"").toString().toLowerCase(),a=e._type+"."+n;a in this.trackedObjectsByEntity||(this.trackedObjectsByEntity[a]={}),this.trackedObjectsByEntity[a][e.id]=!0}}},_.removeIndex=function(e){if(e){var t=v[e._type];if(t.meta.indexed){var n=(e[t.meta.indexed]||"").toString().toLowerCase(),a=e._type+"."+n;a in this.trackedObjectsByEntity&&delete this.trackedObjectsByEntity[a][e.id]}}},_.getEntityByAlternatePK=function(e,t){var n=e.meta.alternatePK;if(n){var a=e.meta.name+"."+n;if(a in this.trackedObjectsByEntity&&t in this.trackedObjectsByEntity[a])return this.trackedObjects[this.trackedObjectsByEntity[a][t]]}return null},_.getEntitiesByIndex=function(e,t){var n=e.meta.indexed;if(n){t=(t||"").toString().toLowerCase();var a=e.meta.name+"."+t;if(a in this.trackedObjectsByEntity){var i=[];for(var r in this.trackedObjectsByEntity[a])this.trackedObjectsByEntity[a].hasOwnProperty(r)&&r in this.trackedObjects&&this.trackedObjects[r][n]==t&&i.push(this.trackedObjects[r]);return i}}return[]},_.getCachedEntities=function(e){var t=[];if(e.meta.cached){var n=e.meta.alternatePK||"id";if(n){var a=e.meta.name+"."+n;if(a in this.trackedObjectsByEntity){var i=this.trackedObjectsByEntity[a];for(var r in i)i[r]in this.trackedObjects?t.push(this.trackedObjects[i[r]]):delete i[r]}}}return t},_.add=function(e){if(e){if(!this.trackedObjects[e.id]&&(this.trackedObjects[e.id]=e,this.addToEntityCache(e),e._new))for(var t in e._data)e._data.hasOwnProperty(t)&&this.propertyChanged(e,t,undefined,e._data[t]);return this}},_.forceAdd=function(e){if(e){if(!this.trackedObjects[e.id]||this.trackedObjects[e.id]!=e){var t=v[e._type];if(t.meta.cached){var n=t.meta.alternatePK;if(n){var a=_.getEntityByAlternatePK(t,e[n]);!a||a.id in this.objectsToRemove||a.id!=e.id&&(e.id=a.id)}}if(this.trackedObjects[e.id]=e,this.addToEntityCache(e),e._new)for(var i in e._data)e._data.hasOwnProperty(i)&&this.propertyChanged(e,i,undefined,e._data[i])}return this}},_.remove=function(e){this.objectsToRemove[e.id]||(this.objectsToRemove[e.id]=e),this.objectsRemoved.push({id:e.id,entity:e._type});try{delete this.trackedObjects[e.id]}catch(t){}return this.clearFromEntityCache(e),this.objectRemoved(e),this},_.clean=function(){this.trackedObjects={},this.objectsToRemove={},this.objectsRemoved=[],this.globalPropertyListeners={},this.queryCollectionCache={},this.trackedObjectsByEntity={},_.GlobalEvent.triggerEvent("clean")},_.asyncForEach=function(n,t,a){function i(){var e=n.pop();t(e,function(e,t){0<n.length?i():a(e,t)})}0<(n=n.slice(0)).length?i():a()},_.asyncParForEach=function(e,t,n){var a=0,i=e.length;0===i&&n();for(var r=0;r<i;r++)t(e[r],function(e,t){++a===i&&n(e,t)})},_.jsonToEntityVal=function(e,t){if(!t)return e;switch(t){case"DATE":return"number"==typeof e?1e12<e?new Date(e):new Date(1e3*e):null;default:return e}},_.entityValToJson=function(e,t){if(!t)return e;switch(t){case"DATE":return e?(e=new Date(e),Math.round(e.getTime()/1e3)):null;default:return e}},_.dump=function(f,e,t){var n=E.getArgs(arguments,[{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"entities",optional:!0,check:function(e){return!e||e&&e.length&&!e.apply},defaultValue:null},{name:"callback",optional:!1,check:E.isCallback(),defaultValue:function(){}}]);if(f=n.tx,e=n.entities,t=n.callback,!e)for(var a in e=[],v)v.hasOwnProperty(a)&&e.push(v[a]);var i={};_.asyncParForEach(e,function(d,t){d.all().list(f,function(e){var u=[];_.asyncParForEach(e,function(e,t){var a={},n=d.meta.fields;for(var i in n)n.hasOwnProperty(i)&&(a[i]=_.entityValToJson(e._data[i],n[i]));var r=d.meta.hasOne;for(var s in r)r.hasOwnProperty(s)&&(a[s]=e._data[s]);var o=d.meta.hasMany,c=[];for(var l in o)o.hasOwnProperty(l)&&c.push(l);_.asyncParForEach(c,function(t,n){_.get(e,t).list(f,function(e){a[t]=e.map(function(e){return e.id}),n()})},function(){a.id=e.id,u.push(a),t()})},function(){i[d.meta.name]=u,t()})})},function(){t(i)})},_.load=function(e,t,n){var a=E.getArgs(arguments,[{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"dump",optional:!1},{name:"callback",optional:!0,check:E.isCallback(),defaultValue:function(){}}]);e=a.tx,t=a.dump,n=a.callback;var i=[],r=this;for(var s in t)if(t.hasOwnProperty(s))for(var o=g(s),c=o.meta.fields,l=t[s],u=0;u<l.length;u++){var d=l[u],f=new o;for(var h in f.id=d.id,d)if(d.hasOwnProperty(h))if(_.isImmutable(h))f[h]=d[h];else if(o.meta.hasMany[h]){var p=o.meta.hasMany[h];if(p.manyToMany&&o.meta.name<p.type.meta.name)continue;var m=_.get(f,h);0<d[h].length&&d[h].forEach(function(e){i.push({Entity:o,coll:m,id:e})})}else _.set(f,h,_.jsonToEntityVal(d[h],c[h]));this.add(f)}r.flush(e,function(){_.asyncForEach(i,function(t,n){t.Entity.load(r,e,t.id,function(e){t.coll.add(e),n()})},function(){r.flush(e,n)})})},_.dumpToJson=function(e,t,n){var a=E.getArgs(arguments,[{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"entities",optional:!0,check:function(e){return e&&e.length&&!e.apply},defaultValue:null},{name:"callback",optional:!1,check:E.isCallback(),defaultValue:function(){}}]);e=a.tx,t=a.entities,n=a.callback,this.dump(e,t,function(e){n(JSON.stringify(e))})},_.dumpDatabaseForSync=function(r,t){var e=E.getArgs(arguments,[{name:"entities",optional:!1,check:function(e){return e},defaultValue:null},{name:"callback",optional:!1,check:E.isCallback(),defaultValue:function(){}}]);r=e.entities,t=e.callback,ABINE_DNTME.require(["documentcloud/underscore"],function(e){var i={};e.async.forEach(e.keys(r),function(n,a){_.transaction(function(e){var t="";"all"!=r[n]&&(t=" where "+r[n]),e.executeSql("SELECT * FROM "+n+t,null,function(e){i[n]=e,a()})})},function(){t(i)})})},_.loadFromJson=function(e,t,n){var a=E.getArgs(arguments,[{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"jsonDump",optional:!1},{name:"callback",optional:!0,check:E.isCallback(),defaultValue:function(){}}]);e=a.tx,t=a.jsonDump,n=a.callback,this.load(e,JSON.parse(t),n)},_.createUUID=t,i.prototype.unsubscribe=function(){this.obj.removeEventListener(this.eventType,this.fn)},r.prototype.addEventListener=function(e,t){return this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push(t),new i(this,e,t)},r.prototype.removeEventListener=function(e,t){for(var n=this.subscribers[e],a=0;a<n.length;a++)if(n[a]==t)return this.subscribers[e].splice(a,1),!0;return!1},r.prototype.triggerEvent=function(e){if(this.subscribers[e])for(var t=this.subscribers[e].slice(0),n=0;n<t.length;n++)t[n].apply(null,arguments)},s.prototype.match=function(){return!0},s.prototype.makeFit=function(){},s.prototype.makeNotFit=function(){},s.prototype.toUniqueString=function(){return"NULL"},s.prototype.subscribeGlobally=function(){},s.prototype.unsubscribeGlobally=function(){},o.prototype.match=function(e){return this.left.match(e)&&this.right.match(e)},o.prototype.makeFit=function(e){this.left.makeFit(e),this.right.makeFit(e)},o.prototype.makeNotFit=function(e){this.left.makeNotFit(e),this.right.makeNotFit(e)},o.prototype.toUniqueString=function(){return this.left.toUniqueString()+" AND "+this.right.toUniqueString()},o.prototype.subscribeGlobally=function(e,t){this.left.subscribeGlobally(e,t),this.right.subscribeGlobally(e,t)},o.prototype.unsubscribeGlobally=function(e,t){this.left.unsubscribeGlobally(e,t),this.right.unsubscribeGlobally(e,t)},c.prototype.match=function(e){return this.left.match(e)||this.right.match(e)},c.prototype.makeFit=function(e){this.left.makeFit(e),this.right.makeFit(e)},c.prototype.makeNotFit=function(e){this.left.makeNotFit(e),this.right.makeNotFit(e)},c.prototype.toUniqueString=function(){return this.left.toUniqueString()+" OR "+this.right.toUniqueString()},c.prototype.subscribeGlobally=function(e,t){this.left.subscribeGlobally(e,t),this.right.subscribeGlobally(e,t)},c.prototype.unsubscribeGlobally=function(e,t){this.left.unsubscribeGlobally(e,t),this.right.unsubscribeGlobally(e,t)},l.prototype.match=function(e){var t=this.value,n=_.get(e,this.property);switch(t&&t.getTime&&(t=1e3*Math.round(t.getTime()/1e3),n&&n.getTime&&(n=1e3*Math.round(n.getTime()/1e3))),this.operator){case"=":return n===t;case"!=":return n!==t;case"<":return n<t;case"<=":return n<=t;case">":return t<n;case">=":return t<=n;case"in":return a(t,n);case"not in":return!a(t,n)}},l.prototype.makeFit=function(e){if("="!==this.operator)throw new Error("Sorry, can't perform makeFit for other filters than =");_.set(e,this.property,this.value)},l.prototype.makeNotFit=function(e){if("="!==this.operator)throw new Error("Sorry, can't perform makeNotFit for other filters than =");_.set(e,this.property,null)},l.prototype.subscribeGlobally=function(e,t){_.subscribeToGlobalPropertyListener(e,t,this.property)},l.prototype.unsubscribeGlobally=function(e,t){_.unsubscribeFromGlobalPropertyListener(e,t,this.property)},l.prototype.toUniqueString=function(){var e=this.value;return e&&e._type&&(e=e.id),this.property+this.operator+e},_.NullFilter=s,_.AndFilter=o,_.OrFilter=c,_.PropertyFilter=l,_.uniqueQueryCollection=function(e){var t=e._entityName;if(e._items)return e;this.queryCollectionCache[t]||(this.queryCollectionCache[t]={});var n=e.toUniqueString();return this.queryCollectionCache[t][n]||(this.queryCollectionCache[t][n]=e),this.queryCollectionCache[t][n]},u.prototype=new r,u.prototype.oldAddEventListener=u.prototype.addEventListener,u.prototype.setupSubscriptions=function(){this._filter.subscribeGlobally(this,this._entityName)},u.prototype.teardownSubscriptions=function(){this._filter.unsubscribeGlobally(this,this._entityName)},u.prototype.addEventListener=function(e,t){var n=this,a=this.oldAddEventListener(e,t);return 1===this.subscribers[e].length&&this.setupSubscriptions(),a.oldUnsubscribe=a.unsubscribe,a.unsubscribe=function(){this.oldUnsubscribe(),0===n.subscribers[e].length&&n.teardownSubscriptions()},a},u.prototype.persistQueries=function(){return[]},u.prototype.init=function(e,t,n){this._filter=new s,this._orderColumns=[],this._prefetchFields=[],this._entityName=t,this._constructor=n,this._limit=-1,this._skip=0,this._reverse=!1,this._session=e||_,this.subscribers={}},u.prototype.toUniqueString=function(){var e=this._constructor.name+": "+this._entityName;e+="|Filter:";var t=[];e+=this._filter.toUniqueString(),e+="|Values:";for(var n=0;n<t.length;n++)e+=t+"|^|";e+="|Order:";for(n=0;n<this._orderColumns.length;n++){var a=this._orderColumns[n];e+=a[0]+", "+a[1]+", "+a[2]}e+="|Prefetch:";for(n=0;n<this._prefetchFields.length;n++)e+=this._prefetchFields[n];return e+="|Limit:",e+=this._limit,e+="|Skip:",e+=this._skip,e+="|Reverse:",e+=this._reverse},u.prototype.clone=function(e){var t=new this._constructor(this._session,this._entityName);if(t._filter=this._filter,t._prefetchFields=this._prefetchFields.slice(0),t._orderColumns=this._orderColumns.slice(0),t._limit=this._limit,t._skip=this._skip,t._reverse=this._reverse,e){var n={};for(var a in this.subscribers)this.subscribers.hasOwnProperty(a)&&(n[a]=this.subscribers[a].slice(0));t.subscribers=n}else t.subscribers=this.subscribers;return t},u.prototype.filter=function(e,t,n){var a=this.clone(!0);a._filter=new o(this._filter,new l(e,t,n));var i=this._session;return a=i.uniqueQueryCollection(a),i.uniqueQueryCollection(a)},u.prototype.or=function(e){var t=this.clone(!0);return t._filter=new c(this._filter,e),this._session.uniqueQueryCollection(t)},u.prototype.and=function(e){var t=this.clone(!0);return t._filter=new o(this._filter,e),this._session.uniqueQueryCollection(t)},u.prototype.order=function(e,t,n){t=t===undefined||t,n=n===undefined||n;var a=this.clone();return a._orderColumns.push([e,t,n]),this._session.uniqueQueryCollection(a)},u.prototype.limit=function(e){var t=this.clone();return t._limit=e,this._session.uniqueQueryCollection(t)},u.prototype.skip=function(e){var t=this.clone();return t._skip=e,this._session.uniqueQueryCollection(t)},u.prototype.reverse=function(){var e=this.clone();return e._reverse=!0,this._session.uniqueQueryCollection(e)},u.prototype.prefetch=function(e){var t=this.clone();return t._prefetchFields.push(e),this._session.uniqueQueryCollection(t)},u.prototype.selectJSON=function(a,i,t){var e=E.getArgs(arguments,[{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"props",optional:!1},{name:"callback",optional:!1}]),n=this._session,r=this;if(a=e.tx,i=e.props,t=e.callback,a){g(this._entityName);this.list(function(e){var n=[];_.asyncForEach(e,function(e,t){e.selectJSON(a,i,function(e){n.push(e),t()})},function(){t(n)})})}else n.transaction(function(e){r.selectJSON(e,i,t)})},u.prototype.add=function(e){if(!e.id||!e._type)throw new Error("Cannot add object of non-entity type onto collection.");this._session.add(e),this._filter.makeFit(e),this.triggerEvent("add",this,e),this.triggerEvent("change",this,e)},u.prototype.addAll=function(e){for(var t=0;t<e.length;t++){var n=e[t];this._session.add(n),this._filter.makeFit(n),this.triggerEvent("add",this,n)}this.triggerEvent("change",this)},u.prototype.remove=function(e){if(!e.id||!e._type)throw new Error("Cannot remove object of non-entity type from collection.");this._filter.makeNotFit(e),this.triggerEvent("remove",this,e),this.triggerEvent("change",this,e)},u.prototype.each=function(e,n){var t=E.getArgs(arguments,[{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"eachFn",optional:!0,check:E.isCallback()}]);e=t.tx,n=t.eachFn,this.list(e,function(e){for(var t=0;t<e.length;t++)n(e[t])})},u.prototype.forEach=u.prototype.each,u.prototype.one=function(e,t){var n=E.getArgs(arguments,[{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"oneFn",optional:!1,check:E.isCallback()}]);e=n.tx,t=n.oneFn;this.limit(1).list(e,function(e){0===e.length?t(null):t(e[0])})},f.prototype=new u,p.prototype=new f,p.prototype.add=function(e){this._session.add(e),this.triggerEvent("add",this,e),this.triggerEvent("change",this,e)},p.prototype.remove=function(e){this._session.remove(e),this.triggerEvent("remove",this,e),this.triggerEvent("change",this,e)},m.prototype=new f,m.prototype.initManyToMany=function(e,t){this._obj=e,this._coll=t},m.prototype.add=function(e){a(this._localAdded,e)||(this._session.add(e),this._localAdded.push(e),this.triggerEvent("add",this,e),this.triggerEvent("change",this,e))},m.prototype.addAll=function(e){for(var t=0;t<e.length;t++){var n=e[t];a(this._localAdded,n)||(this._session.add(n),this._localAdded.push(n),this.triggerEvent("add",this,n))}this.triggerEvent("change",this)},m.prototype.clone=function(){var e=f.prototype.clone.call(this);return e._localAdded=this._localAdded,e._localRemoved=this._localRemoved,e._obj=this._obj,e._coll=this._coll,e},m.prototype.remove=function(e){a(this._localAdded,e)?n(this._localAdded,e):a(this._localRemoved,e)||this._localRemoved.push(e),this.triggerEvent("remove",this,e),this.triggerEvent("change",this,e)},y.prototype=new u,y.prototype.clone=function(){var e=f.prototype.clone.call(this);return e._items=this._items,e},y.prototype.add=function(e){a(this._items,e)||(this._session.add(e),this._items.push(e),this.triggerEvent("add",this,e),this.triggerEvent("change",this,e))},y.prototype.addAll=function(e){for(var t=0;t<e.length;t++){var n=e[t];a(this._items,n)||(this._session.add(n),this._items.push(n),this.triggerEvent("add",this,n))}this.triggerEvent("change",this)},y.prototype.remove=function(e){for(var t=this._items,n=0;n<t.length;n++)t[n]===e&&(this._items.splice(n,1),this.triggerEvent("remove",this,e),this.triggerEvent("change",this,e))},y.prototype.list=function(e,t){(t=E.getArgs(arguments,[{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:E.isCallback()}]).callback)&&!t.executeSql||(t=t);for(var n=this._items.slice(0),c=this,a=[],i=0;i<n.length;i++)this._filter.match(n[i])&&a.push(n[i]);if(a.sort(function(e,t){for(var n=0;n<c._orderColumns.length;n++){var a=c._orderColumns[n][0],i=c._orderColumns[n][1],r=c._orderColumns[n][2],s=_.get(e,a),o=_.get(t,a);if(r||(s=s.toLowerCase(),o=o.toLowerCase()),s<o)return i?-1:1;if(o<s)return i?1:-1}return 0}),this._skip&&a.splice(0,this._skip),-1<this._limit&&(a=a.slice(0,this._limit)),this._reverse&&a.reverse(),!t)return a;t(a)},y.prototype.destroyAll=function(e,t){e&&!e.executeSql||(e=t),this._items=[],this.triggerEvent("change",this),e&&e()},y.prototype.count=function(e,t){var n=E.getArgs(arguments,[{name:"tx",optional:!0,check:_.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:E.isCallback()}]);e=n.tx,t=n.callback;var a=this.list();if(!t)return a.length;t(a.length)},_.QueryCollection=u,_.DbQueryCollection=f,_.ManyToManyDbQueryCollection=m,_.LocalQueryCollection=y,_.Observable=r,_.Subscription=i,_.AndFilter=o,_.OrFilter=c,_.PropertyFilter=l,_.GlobalEvent=new r}();var E={getArgs:function(e,t){for(var n=0,a=0,i={};a<t.length;){var r=t[a],s=e[n];if(r.optional)s!==undefined&&r.check(s)?(i[r.name]=s,n++):r.defaultValue!==undefined&&(i[r.name]=r.defaultValue),a++;else{if(r.check&&!r.check(s))throw new Error("Invalid value for argument: "+r.name+" Value: "+s);i[r.name]=s,a++,n++}}return i},hasProperty:function(t){return function(e){return e&&e[t]!==undefined}},hasType:function(t){return function(e){return typeof e===t}},isCallback:function(){return function(e){return e&&e.apply}}};return _.argspec=E,_}var persistence=initPersistence("undefined"!=typeof window&&window.persistence||{});return"undefined"==typeof JSON&&(JSON={}),JSON.stringify||function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,a,i,r,s,o=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(c)){for(r=c.length,n=0;n<r;n+=1)s[n]=str(n,c)||"null";return i=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+o+"]":"["+s.join(",")+"]",gap=o,i}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;n<r;n+=1)"string"==typeof(a=rep[n])&&(i=str(a,c))&&s.push(quote(a)+(gap?": ":":")+i);else for(a in c)Object.hasOwnProperty.call(c,a)&&(i=str(a,c))&&s.push(quote(a)+(gap?": ":":")+i);return i=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+o+"}":"{"+s.join(",")+"}",gap=o,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var a;if(indent=gap="","number"==typeof n)for(a=0;a<n;a+=1)indent+=" ";else"string"==typeof n&&(indent=n);if((rep=t)&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,a,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.hasOwnProperty.call(i,n)&&((a=walk(i,n))!==undefined?i[n]=a:delete i[n]);return reviver.call(e,t,i)}var j;if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),persistence}),ABINE_DNTME.define("persistence/store/memory",["persistence"],function(e){e.store||(e.store={}),e.store.memory={},e.store.memory.config=function(r,n){function a(e){var t=i[e._entityName];return t||(t=new r.LocalQueryCollection),(t=t.clone())._filter=e._filter,t._prefetchFields=e._prefetchFields,t._orderColumns=e._orderColumns,t._limit=e._limit,t._skip=e._skip,t._reverse=e._reverse,t}var s=r.argspec;n=n||"persistenceData";var i={};r.getAllObjects=function(){return i};var o=r.add;r.add=function(e){if(!this.trackedObjects[e.id]){o.call(this,e);var t=e._type;i[t]||(i[t]=new r.LocalQueryCollection,i[t]._session=r),i[t].add(e)}return this};var c=r.forceAdd;r.forceAdd=function(e){if(e){if(!this.trackedObjects[e.id]||this.trackedObjects[e.id]!=e){c.call(this,e);var t=e._type;i[t]||(i[t]=new r.LocalQueryCollection,i[t]._session=r);try{i[t].remove(this.trackedObjects[e.id])}catch(n){}i[t].add(e)}return this}};var l=r.remove;r.remove=function(e){l.call(this,e);var t=e._type;i[t].remove(e)};var u=r.clearFromEntityCache;r.clearFromEntityCache=function(e){if(e){u.call(this,e);var t=e._type;i[t].remove(e)}},r.schemaSync=function(e,t,n){s.getArgs(arguments,[{name:"tx",optional:!0,check:r.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:s.isCallback(),defaultValue:function(){}},{name:"emulate",optional:!0,check:s.hasType("boolean")}]).callback()},r.flush=function(n,e){var a=s.getArgs(arguments,[{name:"tx",optional:!0,check:r.isTransaction},{name:"callback",optional:!0,check:s.isCallback(),defaultValue:function(){}}]),t=r.flushHooks,i=this;r.asyncForEach(t,function(e,t){e(i,n,t)},function(){var e=r.trackedObjects;for(var t in e)e.hasOwnProperty(t)&&(r.objectsToRemove.hasOwnProperty(t)?delete e[t]:e[t]._dirtyProperties={});a.callback()})},r.transaction=function(e){e({executeSql:function(){}})},r.loadFromLocalStorage=function(e){var t=window.localStorage.getItem(n);t?this.loadFromJson(t,e):e&&e()},r.saveToLocalStorage=function(t){this.dumpToJson(function(e){window.localStorage.setItem(n,e),t&&t()})},r.reset=function(e,t){var n=s.getArgs(arguments,[{name:"tx",optional:!0,check:r.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:s.isCallback(),defaultValue:function(){}}]);e=n.tx,t=n.callback,i={},this.clean(),t()},r.close=function(){},r.DbQueryCollection.prototype.list=function(e,t){var n=s.getArgs(arguments,[{name:"tx",optional:!0,check:r.isTransaction,defaultValue:null},{name:"callback",optional:!1,check:s.isCallback()}]);e=n.tx,t=n.callback,a(this).list(null,t)},r.DbQueryCollection.prototype.destroyAll=function(e,t){var n=s.getArgs(arguments,[{name:"tx",optional:!0,check:r.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:s.isCallback(),defaultValue:function(){}}]);e=n.tx,t=n.callback,a(this).destroyAll(null,t)},r.DbQueryCollection.prototype.count=function(e,t){var n=s.getArgs(arguments,[{name:"tx",optional:!0,check:r.isTransaction,defaultValue:null},{name:"callback",optional:!1,check:s.isCallback()}]);e=n.tx,t=n.callback,a(this).count(null,t)},r.ManyToManyDbQueryCollection=function(e,t){this.init(e,t,r.ManyToManyDbQueryCollection),this._items=[]},r.ManyToManyDbQueryCollection.prototype=new r.LocalQueryCollection,r.ManyToManyDbQueryCollection.prototype.initManyToMany=function(e,t){this._obj=e,this._coll=t},r.ManyToManyDbQueryCollection.prototype.add=function(e,t){if(r.LocalQueryCollection.prototype.add.call(this,e),!t){var n=r.getMeta(this._obj._type).hasMany[this._coll].inverseProperty;r.get(e,n).add(this._obj,!0)}},r.ManyToManyDbQueryCollection.prototype.remove=function(e,t){if(r.LocalQueryCollection.prototype.remove.call(this,e),!t){var n=r.getMeta(this._obj._type).hasMany[this._coll].inverseProperty;r.get(e,n).remove(this._obj,!0)}}}}),ABINE_DNTME.define("persistence/caching",["documentcloud/underscore","abine/core","persistence","abine/eventLogger","abine/timer"],function(e,t,a){return a.entityDecoratorHooks.push(function(n){n.enableCaching=function(e,t){"function"==typeof e&&(t=e,e=null),n.cached=!1,n.meta.cached=!0,n.meta.alternatePK=e,a.GlobalEvent.addEventListener("clean",function(){n.cached=!1,t&&t()})},n.enableIndexing=function(e){n.meta.indexed=e}}),null}),ABINE_DNTME.require("persistence/store/memory",function(e){console.log("defined memory: "+e)}),ABINE_DNTME.define("abine/ajax",["jquery"],function(e){return{ajax:e.ajax,get:e.get,getJSON:e.getJSON,post:e.post,getScript:e.getScript}}),ABINE_DNTME.define("abine/assets",["wycats/handlebars"],function(e){function t(e,t,n){return chrome.extension.getURL(e+("string"==typeof t?t+("string"==typeof n?n:""):""))}function n(e,t,n){var a=e+t+n;return chrome.extension.getURL(a)}return e.registerHelper("assetUrl",t),e.registerHelper("cardAssetUrl",n),{assetUrl:t,cardAssetUrl:n}}),ABINE_DNTME.define("abine/backgroundMessenger",["documentcloud/underscore","abine/core"],function(a,e){var n=function n(e,t){if(t&&t.tab)return"FWD"==e.eventName?(e.via_bg=!0,void chrome.tabs.sendRequest(t.tab.id,e)):void this.trigger(e.eventName,e.payload,t.tab.id)},t=function(){throw"Error. Attempt to call destroyed BackgroundMessenger."};return{implementation:"Chrome",BackgroundMessenger:e.BaseClass.extend({initialize:function(){this.listener=a.bind(n,this),chrome.extension.onRequest.addListener(this.listener)},send:function(t,n,a){if(this.trigger(t,n,a),"test"!=a)if(a&&-1!=a||!chrome.tabs){if(!a||"background"==a||-1==a)return;chrome.tabs.sendRequest(a,{eventName:t,payload:void 0===n?{}:n})}else chrome.tabs.getSelected(null,function(e){a=e.id,chrome.tabs.sendRequest(a,{eventName:t,payload:void 0===n?{}:n})})},broadcast:function(t,n){n=n||{},this.trigger(t,n),chrome.tabs.query({url:chrome.extension.getURL("pages/index.html")},function(e){a(e).each(function(e){chrome.tabs.sendRequest(e.id,{eventName:t,payload:n})})})},broadcastToAllTabs:function(t,n){n=n||{},this.trigger(t,n),chrome.tabs.query({},function(e){a(e).each(function(e){chrome.tabs.sendRequest(e.id,{eventName:t,payload:n})})})},destroy:function(){this.off(),chrome.extension.onRequest.removeListener(n),this.on=this.off=this.trigger=t},sendToWebapp:function(t,n){ABINE_DNTME.require(["abine/window"],function(e){e.getWebappTabs(function(e){a.each(e,function(e){chrome.tabs.sendRequest(e,{eventName:t,payload:n})})})})}})}}),ABINE_DNTME.define("abine/browserSyncStorage",["documentcloud/underscore","abine/core"],function(n,e){return new(chrome&&chrome.storage&&chrome.storage.sync?e.BaseClass.extend({initialize:function(){},set:function(e,t){chrome.storage.sync.set(e,t)},remove:function(e,t){chrome.storage.sync.remove(e,t)},get:function(e,t){chrome.storage.sync.get(e,t)},clear:function(e){chrome.storage.sync.clear(e)}}):e.BaseClass.extend({initialize:function(){this.storage={}},set:function(e,t){n.extend(this.storage,e),t&&t()},remove:function(e,t){e="string"==typeof e?[e]:e,n.each(e,n.bind(function(e){delete this.storage[e]},this)),t&&t()},get:function(e,t){e="string"==typeof e?[e]:e,t&&t(n.pick(this.storage,e))},clear:function(e){this.storage={},e&&e()}}))({})}),ABINE_DNTME.define("abine/clipboard",["abine/eventLogger"],function(){return{copyToClipboard:function(e){var t=document.createElement("textarea");document.getElementById("navbar").appendChild(t),t.focus(),t.value=e,document.execCommand("selectAll"),document.execCommand("copy"),document.getElementById("navbar").removeChild(t)}}}),ABINE_DNTME.define("abine/baseConfig",[],function(){var a=ABINE_DNTME.config={version:"8.1.2520",buildNum:"2520.4c649d9e520ee1286ca49193c7cc44ceaf878112",appName:"Blur",environment:"production",tags:["chromestore"],crypt:!0,silent:!1,payments:!0,browser:null,serverHost:"mm.abine.com",webHost:"www.abine.com",webAppHost:"dnt.abine.com",mappingServerHost:"mapping.abine.com",phoneServerHost:"phone.abine.com",licenseServerHost:"license.abine.com",emailServerHost:"emails.abine.com",pushNotificationUrl:"https://push.abine.com",disposableDomain:"opayq.com",paymentsServerHost:"payments.abine.com",logLevel:"ERROR",pfVersion:".790 Chrome development",mmVersion:"0.0.1 development",features:"accounts,wallet,abinestore,shareWebsocket",buildTag:"chromestore",stripe_key:"pk_live_J13Da0TuELwopBJeF4HlBwU9",overriddenKeys:{}};return a.protocol="development"===ABINE_DNTME.config.environment?"http://":"https://",a.tellWebapp=function(e,t){if(e.documentElement.hasAttribute("abine_webapp")&&(e.documentElement.setAttribute("dnt",a.version),e.documentElement.setAttribute("dnt-features",a.features),e.documentElement.setAttribute("dnt-tag",a.tags[0]),e.documentElement.setAttribute("dnt-build-tag",a.buildTag),t)){var n=e.createEvent("Event");n.initEvent("data:tag:changed",!0,!0),e.dispatchEvent(n)}},a.updateTag=function(e,t){a.tags[0]!=e&&(a.tags[0]=e,t&&a.tellWebapp(t,!0))},a}),ABINE_DNTME.define("abine/config",["abine/baseConfig"],function(e){return e.browser="Chrome",e.tellWebapp(document),e}),ABINE_DNTME.require("abine/config"),ABINE_DNTME.define("abine/conflict_handler",["storage","persistence","abine/localStorage","abine/timer"],function(a,i,r,s){function t(){return openDatabase("idme_data","1.0","Storage for the idme extension",5242880)}function o(e,t,n,a){e.transaction(function(e){e.executeSql(t,null,function(e,t){0<t.rows.length?a(t.rows.item(0)[n]):a(null)},function(){a(null)})})}function e(a){a=a||function(){};var i=t();o(i,"SELECT * FROM sqlite_master WHERE type='table' AND name='Preferences'","name",function(e){c="Preferences"==e,(ABINE_DNTME.merged_data_available=c)?o(i,"select * from Preferences where key = 'regEmail' ","value",function(n){o(i,"select * from Preferences where key = 'entitledToPhone' ","value",function(t){o(i,"select count(*) as cnt from DisposableEmails ","cnt",function(e){a(c,!n||1<e||"true"==t)})})}):a(c)})}function n(e,n){(n=n||function(){},e)?o(t(),"select * from Preferences where key = 'installAuthToken' ","value",function(t){t&&""!=t?a.Preference.findOrCreate({key:"installAuthToken"},function(e){e.value=t,e.modifiedAt=l(),i.flush(function(){n()})}):n()}):n()}var c=null,l=function(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e};return{installAuthTokenCheck:n,checkForMergedAddon:e,checkForMaskme:function(a){function t(e){if(e<=0)return ABINE_DNTME.maskme_installed=!1,r.setItem("maskme.installed","0"),void a(!1);var n=s.setTimeout(function(){t(e-1)},200);_.each(ABINE_DNTME.MASKME_EXTENSION_ID,function(e,t){chrome.runtime.sendMessage(t,{message:"ping"},function(e){e&&e.installed&&(s.clearTimeout(n),r.setItem("maskme.installed","1"),ABINE_DNTME.maskme_installed=!0,ABINE_DNTME.maskme_can_export=!1,chrome.runtime.sendMessage(t,{message:"can_export"},function(e){!0===e&&(ABINE_DNTME.maskme_can_export=!0)}),a(!0))})})}"undefined"==typeof ABINE_DNTME.maskme_installed?("0"===r.getItem("maskme.installed")&&(ABINE_DNTME.maskme_installed=!1,a(!1)),t(3)):a(ABINE_DNTME.maskme_installed)}}}),ABINE_DNTME.define("abine/contentMessenger",["documentcloud/underscore","abine/core"],function(e,t){var n=function n(e){"FWD"==e.eventName?e.via_bg&&e.payload.to==ABINE_DNTME.context&&this.trigger(e.payload.eventName,e.payload.payload,e.payload.from):this.trigger(e.eventName,e.payload)},a=function(){throw"Error. Attempt to call destroyed ContentMessenger."};return{ContentMessenger:t.BaseClass.extend({initialize:function(){this.listener=e.bind(n,this),chrome.extension.onRequest.addListener(this.listener)},sendToCS:function(e,t,n){chrome&&chrome.extension&&chrome.extension.sendRequest({eventName:"FWD",payload:{to:e,from:ABINE_DNTME.context,eventName:t,payload:void 0===n?{}:n}})},send:function(e,t){this.trigger(e,t),chrome&&chrome.extension&&chrome.extension.sendRequest({eventName:e,payload:void 0===t?{}:t})},destroy:function(){this.off();try{chrome.extension.onRequest.removeListener(this.listener)}catch(e){}this.on=this.off=this.trigger=a}})}}),ABINE_DNTME.define("abine/contextMenu",["documentcloud/underscore","abine/core","abine/contextHelper","storage","abine/securityManager"],function(a,e,n,i,r){var l=["editable"];return{contextMenuHelper:new(e.BaseClass.extend({init:function(e){chrome.contextMenus.onClicked.addListener(a.bind(this.onClick,this)),e.on("contentscript:contextmenu:refresh",this.refreshMenu,this),e.on("background:contextmenu:refresh",this.refreshMenu,this),r.on("background:securityManager:unlocked",a.bind(function(){this.previousDomain=null},this)),r.on("background:securityManager:locked",a.bind(function(){this.previousDomain=null},this)),this.messenger=e},refreshMenu:function(t){if(this.previousDomain!=t.domain&&(this.previousDomain=t.domain,!this.alreadyRefreshing)){this.domain=t.domain,this.alreadyRefreshing=!0;var n=a.bind(function(){this.mappingMenu(a.bind(function(){this.alreadyRefreshing=!1},this))},this);chrome.contextMenus.removeAll(a.bind(function(){"abine.com"!=this.domain?0<=this.domain.indexOf("chrome-extension://")||ABINE_DNTME.maskme_installed?this.alreadyRefreshing=!1:i.Preference.findBy("key","hasRegistered",a.bind(function(e){e&&!e.isFalse()?r.isLocked()?chrome.contextMenus.create({title:"Blur",contexts:l,id:"abine_dntme_context_root"},a.bind(function(){chrome.contextMenus.create({title:"locked, click to unlock",contexts:l,id:"abine_dntme_unlock",parentId:"abine_dntme_context_root"},n)},this)):this.createStaticMenu(t.domain,a.bind(function(){this.createDynamicMenu(t.domain,n)},this)):i.Preference.batchFindBy([{by:"key",value:"mapping:mapper"},{by:"key",value:"autofill:mapper"}],a.bind(function(e){e["mapping:mapper"]||e["autofill:mapper"]?chrome.contextMenus.create({title:"Blur",contexts:l,id:"abine_dntme_context_root"},n):this.alreadyRefreshing=!1},this))},this)):this.alreadyRefreshing=!1},this))}},onClick:function(e,t){n.onClick(this.messenger,e.menuItemId,t.id,this.domain)},createDynamicMenu:function(e,t){a.async.series([a.bind(function(t){chrome.contextMenus.create({title:"Accounts for "+e,contexts:l,id:"abine_dntme_logins",parentId:"abine_dntme_context_root"},a.bind(function(){i.Account.listCached("domain",e,a.bind(function(e){0==e.length?chrome.contextMenus.create({title:"You have no accounts here",contexts:l,id:"abine_dntme_no_accounts",parentId:"abine_dntme_logins"},t):a.async.forEachSeries(e,a.bind(this.addLoginItem,this),t)},this))},this))},this),a.bind(function(t){i.Preference.findBy("key","masked_card_auth",a.bind(function(e){e&&"biometric"==e.value?t():i.RealCard.index(null,a.bind(function(e){0==e.length?t():a.async.forEachSeries(e,a.bind(this.addCardItem,this),t)},this))},this))},this),a.bind(function(t){i.Address.index(null,a.bind(function(e){0==e.length?t():chrome.contextMenus.create({title:"Addresses",contexts:l,id:"abine_dntme_address_parent",parentId:"abine_dntme_context_root"},a.bind(function(){a.async.forEachSeries(e,a.bind(this.addAddressItem,this),t)},this))},this))},this),t])},addLoginItem:function(e,t){e.mfa?chrome.contextMenus.create({title:(e.email||e.username||(e.password?"- Only Password -":"- Not Set -"))+" - protected",contexts:l,id:"abine_dntme_accountfield_parent_"+e.id,parentId:"abine_dntme_logins"},function(){t()}):chrome.contextMenus.create({title:e.email||e.username||(e.password?"- Only Password -":"- Not Set -"),contexts:l,id:"abine_dntme_accountfield_parent_"+e.id,parentId:"abine_dntme_logins"},function(){e.email&&chrome.contextMenus.create({title:"Fill email",contexts:l,id:"abine_dntme_accountfield_email_"+e.id,parentId:"abine_dntme_accountfield_parent_"+e.id},function(){}),e.username&&chrome.contextMenus.create({title:"Fill username",contexts:l,id:"abine_dntme_accountfield_username_"+e.id,parentId:"abine_dntme_accountfield_parent_"+e.id},function(){}),e.password&&chrome.contextMenus.create({title:"Fill password",contexts:l,id:"abine_dntme_accountfield_password_"+e.id,parentId:"abine_dntme_accountfield_parent_"+e.id},function(){}),t()})},addCardItem:function(e,t){chrome.contextMenus.create({title:"Card ending in x"+e.number.substr(e.number.length-4),contexts:l,id:"abine_dntme_fillcard_parent_"+e.id,parentId:"abine_dntme_card_parent"},function(){e.number&&chrome.contextMenus.create({title:"Fill card number",contexts:l,id:"abine_dntme_fillcard_number_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),(e.first_name||e.last_name)&&chrome.contextMenus.create({title:"Fill name - "+e.getFullName(),contexts:l,id:"abine_dntme_fillcard_name_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),e.cvc&&chrome.contextMenus.create({title:"Fill CVC/CVV",contexts:l,id:"abine_dntme_fillcard_cvc_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),chrome.contextMenus.create({title:"Fill expiry month - mm",contexts:l,id:"abine_dntme_fillcard_month_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),chrome.contextMenus.create({title:"Fill expiry year - yyyy",contexts:l,id:"abine_dntme_fillcard_year_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),chrome.contextMenus.create({title:"Fill expiry year - yy",contexts:l,id:"abine_dntme_fillcard_yy_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),chrome.contextMenus.create({title:"Fill expiry - mm/yyyy",contexts:l,id:"abine_dntme_fillcard_mmyyyy_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),chrome.contextMenus.create({title:"Fill expiry - mm/yy",contexts:l,id:"abine_dntme_fillcard_mmyy_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),t()})},addAddressItem:function(e,t){chrome.contextMenus.create({title:e.label,contexts:l,id:"abine_dntme_address_parent_"+e.id,parentId:"abine_dntme_address_parent"},function(){e.address1&&chrome.contextMenus.create({title:"Line 1: "+e.address1,contexts:l,id:"abine_dntme_address_line1_"+e.id,parentId:"abine_dntme_address_parent_"+e.id},function(){}),e.address2&&chrome.contextMenus.create({title:"Line 2: "+e.address2,contexts:l,id:"abine_dntme_address_line2_"+e.id,parentId:"abine_dntme_address_parent_"+e.id},function(){}),e.city&&chrome.contextMenus.create({title:"City: "+e.city,contexts:l,id:"abine_dntme_address_city_"+e.id,parentId:"abine_dntme_address_parent_"+e.id},function(){}),e.state&&chrome.contextMenus.create({title:"State: "+e.state,contexts:l,id:"abine_dntme_address_state_"+e.id,parentId:"abine_dntme_address_parent_"+e.id},function(){}),e.country&&chrome.contextMenus.create({title:"Country: "+e.country,contexts:l,id:"abine_dntme_address_country_"+e.id,parentId:"abine_dntme_address_parent_"+e.id},function(){}),e.zip&&chrome.contextMenus.create({title:"Zip: "+e.zip,contexts:l,id:"abine_dntme_address_zip_"+e.id,parentId:"abine_dntme_address_parent_"+e.id},function(){}),t()})},mappingMenu:function(t){i.Preference.batchFindBy([{by:"key",value:"mapping:mapper"},{by:"key",value:"mapping:reviewer"},{by:"key",value:"autofill:mapper"}],function(e){e["mapping:mapper"]||e["mapping:reviewer"]?chrome.contextMenus.create({title:"Map this form",contexts:l,parentId:"abine_dntme_context_root",id:"abine_dntme_map_form"},t):e["autofill:mapper"]?chrome.contextMenus.create({title:"Autofill this form",contexts:l,parentId:"abine_dntme_context_root",id:"abine_dntme_autofill_form"},t):chrome.contextMenus.create({title:"Ignore this field",contexts:l,parentId:"abine_dntme_context_root",id:"abine_dntme_ignore"},t)})},addPhoneMenu:function(e,t){var n="abine_dntme_phone_"+t+"_parent",a=e.country_code,i=e.number;if(chrome.contextMenus.create({title:"Full: "+i,contexts:l,id:"abine_dntme_phone_"+t+"_full",parentId:n},function(){}),1==a&&10==i.length){var r=i.substr(0,3),s=i.substr(3,3),o=i.substr(6,4),c=i.substr(3,7);chrome.contextMenus.create({title:"Last 7: "+c,contexts:l,id:"abine_dntme_phone_"+t+"_last7",parentId:n},function(){}),chrome.contextMenus.create({title:"Area: "+r,contexts:l,id:"abine_dntme_phone_"+t+"_area",parentId:n},function(){}),chrome.contextMenus.create({title:"Exchange: "+s,contexts:l,id:"abine_dntme_phone_"+t+"_exchange",parentId:n},function(){}),chrome.contextMenus.create({title:"Local: "+o,contexts:l,id:"abine_dntme_phone_"+t+"_local",parentId:n},function(){})}},createStaticMenu:function(e,t){var n=this;a.async.series([function(e){chrome.contextMenus.create({title:"Blur",contexts:l,id:"abine_dntme_context_root"},e)},function(e){chrome.contextMenus.create({title:"Email",contexts:l,parentId:"abine_dntme_context_root",id:"abine_dntme_email_parent"},e)},function(e){chrome.contextMenus.create({title:"Mask My Email",contexts:l,parentId:"abine_dntme_email_parent",id:"abine_dntme_email_mask"},e)},function(e){chrome.contextMenus.create({title:"Use My Email",contexts:l,parentId:"abine_dntme_email_parent",id:"abine_dntme_email_disclose"},e)},function(e){chrome.contextMenus.create({title:"Password",contexts:l,parentId:"abine_dntme_context_root",id:"abine_dntme_password_parent"},e)},function(e){chrome.contextMenus.create({title:"Generate strong password",contexts:l,parentId:"abine_dntme_password_parent",id:"abine_dntme_password_mask"},e)},function(e){chrome.contextMenus.create({title:"Phone",contexts:l,parentId:"abine_dntme_context_root",id:"abine_dntme_phone_parent"},e)},function(t){i.DisposablePhone.index(null,function(e){0<e.length?chrome.contextMenus.create({title:"Mask my Phone",contexts:l,parentId:"abine_dntme_phone_parent",id:"abine_dntme_phone_mask_parent"},function(){n.addPhoneMenu(e[0],"mask"),t()}):t()})},function(t){i.ShieldedPhone.index(null,function(e){0<e.length?chrome.contextMenus.create({title:"Disclose my phone",contexts:l,parentId:"abine_dntme_phone_parent",id:"abine_dntme_phone_disclose_parent"},function(){n.addPhoneMenu(e[0],"disclose"),t()}):chrome.contextMenus.create({title:"Set up your phone",contexts:l,parentId:"abine_dntme_phone_parent",id:"abine_dntme_setup_phone"},t)})},function(t){chrome.contextMenus.create({title:"Credit Card",contexts:l,parentId:"abine_dntme_context_root",id:"abine_dntme_card_parent"},function(){i.Preference.findBy("key","hasEnabledPayments",function(e){e&&e.isTrue()?chrome.contextMenus.create({title:"Mask my Credit Card",contexts:l,parentId:"abine_dntme_card_parent",id:"abine_dntme_card_mask"},t):chrome.contextMenus.create({title:"Activate Masked Cards",contexts:l,parentId:"abine_dntme_card_parent",id:"abine_dntme_activate_card"},t)})})}],function(){t()})}}))}}),ABINE_DNTME.define("abine/dntmeUpgrade",["storage","persistence","abine/localStorage","abine/conflict_handler"],function(e,t,s,n){function a(){h=openDatabase("abine2","1.1","abine2",5242880)}function i(a,i){h.transaction(function(e){e.executeSql("SELECT * FROM trackers",[],function(e,t){a.trackerMap={};for(var n=0;n<t.rows.length;n++)a.trackerMap[t.rows.item(n).domain]||(a.trackerMap[t.rows.item(n).domain]={}),a.trackerMap[t.rows.item(n).domain][t.rows.item(n).name]=t.rows.item(n).blocked;i()},function(){i()})})}function r(r,s){h.transaction(function(e){e.executeSql("SELECT * from blockcount",[],function(e,t){r.totals={};for(var n=0;n<t.rows.length;n++){var a=t.rows.item(n).name,i=t.rows.item(n).value;"totalOptout"!=a&&("totalb"==a&&(a="total"),r.totals[a]=i)}s()},function(){s()})})}function o(r,s){h.transaction(function(e){e.executeSql("SELECT * from settings",[],function(e,t){r.settings={};for(var n=0;n<t.rows.length;n++){var a=t.rows.item(n).name;if(!a.match(/rules|converted|reason/)){var i=t.rows.item(n).value;r.settings[a.toLowerCase()]=i}}"dntp.useglobalallow"in r.settings&&(r.settings["dntp.useglobalallow"]=""!=r.settings["dntp.useglobalallow"]),"dntp.showmedals"in r.settings&&(r.settings["dntp.showmedals"]=""!=r.settings["dntp.showmedals"]),s()},function(){s()})})}function c(e,t){s.getItem("global.blocked")&&(e.settings||(e.settings={}),e.settings.defaultBlocked="0"!=s.getItem("global.blocked")),s.getItem("origin")&&(e.settings||(e.settings={}),e.settings.origin=s.getItem("origin")),e.badTrackers={},e.dailyTotals={},s.getItem("badTrackerTotals")&&(e.badTrackers.totals=JSON.parse(s.getItem("badTrackerTotals")));for(var n=(new Date).getFullYear(),a=2011;a<=n;a++)for(var i in s.getItem("dailyTotals"+a)&&(e.dailyTotals[a]=JSON.parse(s.getItem("dailyTotals"+a))),e.badTrackers.totals){var r=i+"."+a;s.getItem("badTrackerDaily."+r)&&("daily"in e.badTrackers||(e.badTrackers.daily={}),e.badTrackers.daily[r]=JSON.parse(s.getItem("badTrackerDaily."+r)))}t()}function u(){return openDatabase("idme_data","1.0","Storage for the idme extension",5242880)}function d(t){function o(e,n){if(n>=c.length)t(l);else{var a=c[n];e.executeSql("SELECT * FROM sqlite_master WHERE type='table' AND name='"+a+"'",null,function(e,t){0<t.rows.length?(l[a]={schema:t.rows.item(0).sql},i(e,n)):o(e,n+1)})}}function i(e,r){var s=c[r];e.executeSql("SELECT * FROM "+s,null,function(e,t){for(var n=[],a=t.rows.length,i=0;i<a;i++)n.push(t.rows.item(i));l[s].rows=n,o(e,r+1)})}if(null!==f)if(!1!==f){var c="AccountField,Accounts,DisposableCards,DisposableEmails,Preferences,ShieldedEmails,Sites".split(","),l={};u().transaction(function(e){o(e,0)})}else t(null);else n.checkForMergedAddon(function(e){f=e,d(t)})}function l(n){_.each(ABINE_DNTME.MASKME_EXTENSION_ID,function(e,t){chrome.runtime.sendMessage(t,{message:"export_to_dntme"},function(e){e&&n(e)})})}var f=null,h=null;return{getMaskmeData:d,exportFromMaskme:l,getOldData:function(e){if(s.getItem("upgradeDone"))e(null);else{s.setItem("upgradeDone",!0),a();var t={};i(t,function(){r(t,function(){o(t,function(){c(t,function(){e(t)})})})})}}}}),ABINE_DNTME.define("abine/compressedLocalStorage",[],function(){function e(n){
// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>
var a=function(){function n(e,t){if(!r[e]){r[e]={};for(var n=0;n<e.length;n++)r[e][e.charAt(n)]=n}return r[e][t]}var y=String.fromCharCode,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={},s={compressToBase64:function(e){if(null==e)return"";var t=s._compress(e,6,function(e){return a.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:s._decompress(t.length,32,function(e){return n(a,t.charAt(e))})},compressToUTF16:function(e){return null==e?"":s._compress(e,15,function(e){return y(e+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:s._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(e){for(var t=s.compress(e),n=new Uint8Array(2*t.length),a=0,i=t.length;a<i;a++){var r=t.charCodeAt(a);n[2*a]=r>>>8,n[2*a+1]=r%256}return n},decompressFromUint8Array:function(e){if(null===e||e===undefined)return s.decompress(e);for(var t=new Array(e.length/2),n=0,a=t.length;n<a;n++)t[n]=256*e[2*n]+e[2*n+1];var i=[];return t.forEach(function(e){i.push(y(e))}),s.decompress(i.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":s._compress(e,6,function(e){return i.charAt(e)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),s._decompress(t.length,32,function(e){return n(i,t.charAt(e))}))},compress:function(e){return s._compress(e,16,function(e){return y(e)})},_compress:function(e,t,n){if(null==e)return"";var a,i,r,s={},o={},c="",l="",u="",d=2,f=3,h=2,p=[],m=0,g=0;for(r=0;r<e.length;r+=1)if(c=e.charAt(r),Object.prototype.hasOwnProperty.call(s,c)||(s[c]=f++,o[c]=!0),l=u+c,Object.prototype.hasOwnProperty.call(s,l))u=l;else{if(Object.prototype.hasOwnProperty.call(o,u)){if(u.charCodeAt(0)<256){for(a=0;a<h;a++)m<<=1,g==t-1?(g=0,p.push(n(m)),m=0):g++;for(i=u.charCodeAt(0),a=0;a<8;a++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1}else{for(i=1,a=0;a<h;a++)m=m<<1|i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i=0;for(i=u.charCodeAt(0),a=0;a<16;a++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1}0==--d&&(d=Math.pow(2,h),h++),delete o[u]}else for(i=s[u],a=0;a<h;a++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1;0==--d&&(d=Math.pow(2,h),h++),s[l]=f++,u=String(c)}if(""!==u){if(Object.prototype.hasOwnProperty.call(o,u)){if(u.charCodeAt(0)<256){for(a=0;a<h;a++)m<<=1,g==t-1?(g=0,p.push(n(m)),m=0):g++;for(i=u.charCodeAt(0),a=0;a<8;a++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1}else{for(i=1,a=0;a<h;a++)m=m<<1|i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i=0;for(i=u.charCodeAt(0),a=0;a<16;a++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1}0==--d&&(d=Math.pow(2,h),h++),delete o[u]}else for(i=s[u],a=0;a<h;a++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1;0==--d&&(d=Math.pow(2,h),h++)}for(i=2,a=0;a<h;a++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1;for(;;){if(m<<=1,g==t-1){p.push(n(m));break}g++}return p.join("")},decompress:function(t){return null==t?"":""==t?null:s._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(e,t,n){var a,i,r,s,o,c,l,u=[],d=4,f=4,h=3,p="",m=[],g={val:n(0),position:t,index:1};for(a=0;a<3;a+=1)u[a]=a;for(r=0,o=Math.pow(2,2),c=1;c!=o;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=n(g.index++)),r|=(0<s?1:0)*c,c<<=1;switch(r){case 0:for(r=0,o=Math.pow(2,8),c=1;c!=o;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=n(g.index++)),r|=(0<s?1:0)*c,c<<=1;l=y(r);break;case 1:for(r=0,o=Math.pow(2,16),c=1;c!=o;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=n(g.index++)),r|=(0<s?1:0)*c,c<<=1;l=y(r);break;case 2:return""}for(i=u[3]=l,m.push(l);;){if(g.index>e)return"";for(r=0,o=Math.pow(2,h),c=1;c!=o;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=n(g.index++)),r|=(0<s?1:0)*c,c<<=1;switch(l=r){case 0:for(r=0,o=Math.pow(2,8),c=1;c!=o;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=n(g.index++)),r|=(0<s?1:0)*c,c<<=1;u[f++]=y(r),l=f-1,d--;break;case 1:for(r=0,o=Math.pow(2,16),c=1;c!=o;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=n(g.index++)),r|=(0<s?1:0)*c,c<<=1;u[f++]=y(r),l=f-1,d--;break;case 2:return m.join("")}if(0==d&&(d=Math.pow(2,h),h++),u[l])p=u[l];else{if(l!==f)return null;p=i+i.charAt(0)}m.push(p),u[f++]=i+p.charAt(0),i=p,0==--d&&(d=Math.pow(2,h),h++)}}};return s}();if(!!0)return n;var e={getItem:function(){var e=n.getItem.apply(n,arguments);return e&&0===e.indexOf("LZ_")&&(e=a.decompress(e.substr(3))),e},setItem:function(e,t){return t&&e&&e.match(/mapping-|loginurl-|-to-push|form-rules/i)&&500<t.length&&(t="LZ_"+a.compress(t)),n.setItem(e,t)},removeItem:function(e){return n.removeItem(e)},clear:function(){n.clear()}};if(!e.getItem("compressed")){Date.now();e.setItem("compressed",1);var t=e.getItem("mapping-buckets",null);if(t){t=JSON.parse(t);for(var i=0;i<t.length;i++){var r=e.getItem("mapping-"+t[i],null);r&&e.setItem("mapping-"+t[i],r)}}}return e}return{wrap:e}}),ABINE_DNTME.define("abine/localStorage",["abine/compressedLocalStorage"],function(e){return e.wrap(window.localStorage)}),ABINE_DNTME.define("abine/pay_button",[],function(){return{show:function(e,t){t&&t.match(/^(1800flowers.com|bestbuy.com|walmart.com|kohls.com|target.com)$/)&&chrome.tabs.executeScript(e,{file:"/pages/pay_button.js",allFrames:!1,runAt:"document_end"})}}}),ABINE_DNTME.define("abine/tabs",["abine/core","abine/url"],function(e,a){return{tabHelper:new(e.BaseClass.extend({init:function(n){chrome.tabs.onActivated.addListener(function(e){-1!=e.tabId&&chrome.tabs.get(e.tabId,function(e){e&&e.url&&(e.url.match("https?://")||e.url.match("chrome-extension://"))&&n.send("background:contextmenu:refresh",{domain:a.getTLD(e.url)})})}),chrome.windows.onFocusChanged.addListener(function(e){-1!=e&&chrome.windows.get(e,{populate:!0},function(e){if(e&&e.tabs)for(var t=0;t<e.tabs.length;t++)e.tabs[t].active&&e.tabs[t].url&&(e.tabs[t].url.match("https?://")||e.tabs[t].url.match("chrome-extension://"))&&n.send("background:contextmenu:refresh",{domain:a.getTLD(e.tabs[t].url)})})})}}))}}),ABINE_DNTME.define("abine/toolbar",["documentcloud/underscore","abine/timer","jquery","abine/securityManager","storage"],function(t,e,n,c){function a(){}function i(e){chrome.browserAction.setIcon({path:"pages/images/icon-lock.png",tabId:e})}function r(e){chrome.browserAction.setIcon({path:"images/Icon.png",tabId:e})}function s(e){var t=c.isLocked(),n=[255,0,0,255],a=[225,193,0,255],i=[0,125,0,255];e.total>e.blocked+e.suggested?i=n:0<e.suggested&&(i=a);var r=e.total+"";if(!e.disabled&&ABINE_DNTME.dnt_api.getDefaultBlocking()||(r="off",i=n),chrome.browserAction.setBadgeText({text:r,tabId:e.tabId}),chrome.browserAction.setBadgeBackgroundColor({color:i,tabId:e.tabId}),e.isBadge)chrome.browserAction.setIcon({path:e.iconPath,tabId:e.tabId});else if(e.customImage){var s=document.createElement("canvas").getContext("2d"),o=new Image;o.onload=function(){s.drawImage(this,0,0),chrome.browserAction.setIcon({imageData:s.getImageData(0,0,o.width,o.height),tabId:e.tabId})},o.src=e.customImage}else chrome.browserAction.setIcon({path:t?"pages/images/icon-lock.png":"/images/Icon.png",tabId:e.tabId})}return c.on("background:securityManager:initialized",function(){c.on("background:securityManager:locked",function(){chrome.tabs.query({},t.bind(function(e){t.each(e,t.bind(function(e){i(e.id)},this))},this))}),c.on("background:securityManager:unlocked",function(){chrome.tabs.query({},t.bind(function(e){t.each(e,t.bind(function(e){r(e.id)},this))},this))}),c.isLocked()?chrome.tabs.query({},t.bind(function(e){t.each(e,t.bind(function(e){i(e.id)},this))},this)):chrome.tabs.query({},t.bind(function(e){t.each(e,t.bind(function(e){r(e.id)},this))},this))}),{freshInstall:a,updateIcon:s}}),ABINE_DNTME.define("abine/tour",[],function(){return{show:function(e){chrome.tabs.insertCSS(e,{file:"/pages/postinstall.css"}),chrome.tabs.executeScript(e,{file:"/pages/postinstall.js",allFrames:!1,runAt:"document_end"})}}}),ABINE_DNTME.define("abine/window",["documentcloud/underscore","abine/timer","jquery"],function(o,n,f){function c(e){var n=[];return o.each(e,function(e,t){n.push(t.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})+":"+e)}),n.join(" !important;")}function l(n,e){o.each(e,function(e,t){n.setAttribute(t,e)})}var u="panel.html",t=function(){},d=function(e,t){e.documentElement?e.documentElement.appendChild(t):n.setTimeout(function(){d(e,t)},100)};return{createTab:function(n,a){function e(e){var t=o.find(e,function(e){return-1!=e.url.indexOf(r)});t||n.doNotOpenNewTab?t&&(chrome.tabs.update(t.id,{active:!n.doNotActivate,url:i}),chrome.windows.get(t.windowId,function(e){"minimized"==e.state&&chrome.windows.update(e.id,{state:"normal"}),chrome.windows.update(e.id,{focused:!0}),a()})):(chrome.tabs.create({active:!0,url:i}),a())}a=a||t;var i=n.localUrl?chrome.extension.getURL(n.localUrl):n.url;if(n.force)return chrome.tabs.create({active:!0,url:i}),void a();var r=i.replace(/http[s]?/i,"").replace(/\?.*/i,"").replace(/\#.*/i,"");chrome.tabs.query({},e)},getWebappTabs:function(n){chrome.tabs.query({url:ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost+"/*"},function(e){var t=[];o.each(e,function(e){t.push(e.id)}),n(t)})},openWindow:function(e,t,n){chrome.windows.create({url:e,width:t,height:n,focused:!0,type:"popup"})},reloadTab:function(n,a){function e(e){var t=o.find(e,function(e){return-1!=e.url.indexOf(r)});t||n.doNotOpenNewTab?t&&(chrome.tabs.reload(t.id),n.doNotActivate||(chrome.tabs.update(t.id,{active:!0}),chrome.windows.get(t.windowId,function(e){"minimized"==e.state&&chrome.windows.update(e.id,{state:"normal"}),chrome.windows.update(e.id,{focused:!0}),a()}))):(chrome.tabs.create({active:!0,url:i}),a())}a=a||t;var i=n.localUrl?chrome.extension.getURL(n.localUrl):n.url,r=i.replace(/http[s]?/i,"").replace(/\?.*/i,"").replace(/\#.*/i,"");chrome.tabs.query({},e)},createPanel:function(e){var t=e.localUrl?chrome.extension.getURL(e.localUrl):e.url,n=e.document||document||window.document,a=e.panelWidth?e.panelWidth:368;if(!n)throw"Error. abine/window createPanel called without a document context.";var i=e.id||"abine"+Math.floor(1e8*Math.random());t=t||chrome.extension.getURL(u)+"?"+i;var r=n.createElement("iframe"),s=n.createElement("div");return s.className=e.className||"abineContentPanel",r.className="abineContentFrame",l(s,{style:c(o.extend({backgroundColor:"transparent",margin:"0",padding:"0",display:"none",opacity:"1",filter:"alpha(opacity:100)"},e.style))}),l(r,{width:a+"px",allowTransparency:"true",frameborder:0,height:e.panelHeight+"px",scrolling:"no",src:t,id:i,style:c(o.extend({position:"relative",display:"block",background:"transparent",borderWidth:"0px",left:"0px",top:"0px",visibility:"visible",opacity:1,filter:"alpha(opacity:100)",margin:"0",padding:"0",height:e.panelHeight+"px",width:a+"px"}))}),s.appendChild(r),d(n,s,r),r},autoResizePanels:function(d){var e,t=d.document||document||window.document;t.getElementsByTagName("body")[0];if(d.frameId){var n=t.getElementById(d.frameId);n&&(e=[n.parentElement])}e||(e=t.getElementsByClassName(d.className||"abineContentPanel")),o(e).each(function(e){var t=f("iframe",e)[0];t.scrolling="no",f(t).height("auto");var n=f(t).width(),a=d.documentHeight;d.extraWidth&&(n+=d.extraWidth),d.extraHeight&&(a+=d.extraHeight),f(t).width(n),f(t).height(a),e.style.width=n+"px",e.style.height=a+"px";try{var i=parseInt(e.style.left),r=i+e.offsetWidth,s=e.ownerDocument.defaultView.innerWidth,o=e.ownerDocument.documentElement.scrollLeft+s;if(o<r){var c=r-o;if(0<i-c)e.style.left=i-c+"px";else if(e.style.left="0px",s<r-i){var l=Math.round(s/(r-i)*100);(l-=1)<80&&(l=80),t.style.zoom=l+"%",t.contentDocument.body.style.zoom=l+"%"}}}catch(u){}})},removePanels:function(e){function t(e,t){if(!t){var n=f("iframe",e);if(0<n.length&&(t=n[0]),!t)return}-1!=t.id.indexOf("doNotRemove")?f(t.parentNode).hide():t.parentNode.parentNode.removeChild(t.parentNode)}var n=e.document||document||window.document;if(e.iframe)t(null,e.iframe);else{var a=n.getElementsByClassName("abineContentPanel");o(a).each(function(e){t(e)})}}}}),ABINE_DNTME.define("abine/core",["documentcloud/underscore"],function(i){var e={on:function(e,t,n){var a=this._callbacks||(this._callbacks={}),i=a[e]||(a[e]={}),r=i.tail||(i.tail=i.next={});return r.callback=t,r.context=n,i.tail=r.next={},this},off:function(e,t){var n,a,i;if(e){if(n=this._callbacks)if(t){if(a=n[e])for(;(i=a)&&(a=a.next);)if(a.callback===t){i.next=a.next,a.context=a.callback=null;break}}else n[e]={}}else this._callbacks=null;return this},trigger:function(e){var t,n,a,i,r,s=["all",e];if(!(n=this._callbacks))return this;for(;r=s.pop();)if(t=n[r])for(i="all"==r?arguments:Array.prototype.slice.call(arguments,1);t=t.next;)(a=t.callback)&&a.apply(t.context||this,i);return this},once:function(e,t,n){function a(){return i.off(e,a),t.apply(this,arguments)}var i=this;return this.on(e,a,n)},onceAny:function(){function t(){for(var e=0;e<n.length;e++)this.off.apply(this,[n[e][0],t]),this.off.apply(this,n[e])}for(var n=arguments,e=0;e<arguments.length;e++)this.on.apply(this,arguments[e]),this.on.apply(this,[arguments[e][0],t]);return this},hasListeners:function(e){var t,n;if(!(n=this._callbacks))return!1;if(!(t=n[e]))return!1;for(;t=t.next;)if(t.callback)return!0;return!1}};e.bind=e.on,e.unbind=e.off;var r=function(){},a=function(e,t,n){var a;return a=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},i.extend(a,e),r.prototype=e.prototype,a.prototype=new r,t&&i.extend(a.prototype,t),n&&i.extend(a,n),(a.prototype.constructor=a).__super__=e.prototype,a},t=function(e,t){var n=a(this,e,t);return n.extend=this.extend,n},n=function n(){this.initialize.apply(this,arguments)};return i.extend(n.prototype,e,{initialize:function s(){}}),n.extend=t,{BaseClass:n,Events:e}}),ABINE_DNTME.define("abine/backgroundEventLogger",["abine/config","storage","persistence","documentcloud/underscore"],function(e){function t(){function t(e){try{Console(e)}catch(t){}}var n=(new Date).toUTCString();return"undefined"==typeof console||"undefined"==typeof console.debug?{finest:function(e){t("[FINEST]["+n+"]: "+e)},debug:function(e){t("[DEBUG]["+n+"]: "+e)},info:function(e){t("[INFO]["+n+"]: "+e)},warn:function(e){t("[WARNING]["+n+"]: "+e)},error:function(e){t("[ERROR]["+date+"]: "+e)}}:"undefined"!=typeof console?{finest:function(e){console.debug("[FINEST]["+n+"]: "+e)},debug:function(e){console.debug("[DEBUG]["+n+"]: "+e)},info:function(e){console.info("[INFO]["+n+"]: "+e)},warn:function(e){console.warn("[WARNING]["+n+"]: "+e)},error:function(e){console.error("[ERROR]["+n+"]: "+e)}}:void 0}var n=function(){},s=t();switch(s.dumpObj=function(e){var t=typeof e;if("object"!=t||null===e)return"string"==t&&(e='"'+e+'"'),String(e);var n,a,i=[],r=e&&e.constructor==Array;for(n in e)"string"==(t=typeof(a=e[n]))?a='"'+a+'"':"object"==t&&null!==a&&(a=s.dumpObj(a)),i.push((r?"":'"'+n+'":')+String(a));return(r?"[":"{")+String(i)+(r?"]":"}")},e.logLevel){case"NONE":s.error=n;case"ERROR":s.warn=n;case"WARN":s.info=n;case"INFO":s.debug=n;case"DEBUG":s.finest=n}return s.info("Log level set to "+e.logLevel),ABINE_DNTME.log=ABINE_DNTME.log||s,s}),ABINE_DNTME.define("abine/backgroundInit",["abine/storageRouter","abine/storage/registry","abine/window","storage","abine/securityManager","abine/stubs","abine/toolbar","abine/timer","abine/ajax","abine/config","abine/pageEvents","abine/tabs","persistence","abine/mappingServer","modules","documentcloud/underscore","abine/browserSyncStorage","abine/core","abine/dntmeInit","abine/conflict_handler","abine/saveForms","abine/formSubmitDetector","abine/localStorage","abine/responseCodes","abine/licenseServer","abine/savePaymentForms"],function(t,a,n,r,s,i,o,c,l,u,d,f,h,e,p,m,g,y,b,v,_,E,k,T,w,A){function N(n){if(!L){i.start(n),E.formSubmitDetector.init(n),_.init(n),A.init(n),n.on("background:show:notification:forward",function(e,t){n.send("background:show:notification",e,t)}),n.on("background:create:panel:forward",function(e,t){n.send("background:create:panel",e,t)}),n.on("contentManager:init",function(){0}),L=!0,m.each(m.values(p),function(e){e.setMessenger&&e.setMessenger(n)}),f.tabHelper.init(n);var e=new t.StorageRouter({messenger:n,noMigrations:!0,ready:function(){r.Preference.setupUpgradeDefaults();try{M(n)}catch(e){}}});a.registerStorageEntities(e),O(n)}}function S(e,t){if(e=e.split("."),t=t.split("."),e.length>t.length)return!0;for(var n=0;n<e.length;n++){if(parseInt(e[n],10)<parseInt(t[n],10))return!1;if(parseInt(e[n],10)>parseInt(t[n],10))return!0}return!1}function I(){var e=function(){r.Preference.findBy("key","authToken",function(n){n&&n.value?r.Preference.findBy("key","lastActivity",function(t){r.Preference.findBy("key","autolock",function(e){!e||"restart"!=e.value||ABINE_DNTME._started?(ABINE_DNTME._started=!0,e&&"never"!=e.value&&Date.now()-parseFloat(t.value)>=60*parseFloat(e.value)*60*1e3&&p.licenseModule.logout(n.value,function(){h.remove(t),s.setAuthToken("","","")})):p.licenseModule.logout(n.value,function(){h.remove(t),s.setAuthToken("","","")})})}):ABINE_DNTME._started=!0})};c.setInterval(e,6e4),e()}function M(t){H.trigger("storage:initialized"),r.Preference.findBy("key","new_version",function(e){e&&(e.value==u.version||S(e.value,u.version))&&(h.remove(e),h.flush())}),v.checkForMaskme(function(){try{b.initialize(t)}catch(e){ABINE_DNTME.log.error("error during dntme initialization "+e.message+e.stack)}U||(U=!0,d.initialize(t),s.load(t),I(),p.criticalProcess.setMessenger(t),x(function(e){var t=0;e&&(t=12e4),c.setTimeout(m.bind(function(){p.mappingsModule.startDailyMappingCheck()},this),t),ABINE_DNTME.setupUninstallUrl()}))})}function D(e){e=e||q,r.Preference.batchCreateOrModify([{key:"installUserAgent",value:ABINE_DNTME.userAgent},{key:"installVersion",value:u.version},{key:"installTags",value:u.tags[0]},{key:"installDate",value:Date.now()}],function(){e()}),u.silent&&r.Preference.batchCreateOrModify([{key:"showMedals",value:"false"},{key:"showCheckoutPanelGrowl",value:"false"},{key:"suggestProtectedEmail",value:"false"},{key:"suggestProtectedPhone",value:"false"},{key:"suggestProtectedCard",value:"false"},{key:"showTrackersOnload",value:"false"},{key:"showWeeklyReports",value:"false"}],function(){e()})}function C(n){n=n||q;var e="http://";"production"==ABINE_DNTME.config.environment&&(e="https://");var t=e+ABINE_DNTME.config.webHost+"/maskme/v2/tag.php?currentTag="+u.tags[0];l.ajax({url:t,success:function(e){try{e=JSON.parse(e)}catch(t){e={}}e&&""!=e&&e.abineMaskMeTag&&""!=e.abineMaskMeTag?(u.tags.unshift(e.abineMaskMeTag),r.Preference.createOrModify({key:"dynamicTag",value:e.abineMaskMeTag},function(){n()})):n()},error:function(){n()}})}function x(i){i=i||q,r.Preference.findBy("key","freshInstall",function(e){if(e&&"false"!==e.value){u.silent||-1==u.tags[0].toUpperCase().indexOf("YT14")||(u.silent=!0);var a=!0;e.value="false",h.add(e),o.freshInstall(),D(function(){C(function(){v.checkForMergedAddon(function(t,n){v.installAuthTokenCheck(t,function(){p.licenseModule.startDailyTouch(function(){R(function(){B(function(){if(u.silent)i(a);else{var e="http://"+ABINE_DNTME.config.webHost+"/blur/postinstall?";ABINE_DNTME.maskme_installed&&(e+="maskme=1&"),t&&n&&(e+="merged=1&",r.Preference.createOrModify({key:"mergedMigrationPending",value:"true"},function(){})),ABINE_DNTME.dntme_upgrade&&(e+="upgrade=1&"),e+="webapp="+ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost,P(e+="&tour=1",function(){s.openPage(e,!0),i(a)})}})})})})})})})}else r.Preference.findBy("key","installVersion",function(e){e&&(e.value<"4.5"?r.Preference.findBy("key","showBlurGrowl",function(e){e||(r.Preference.createOrModify({key:"showBlurGrowl",value:"true"},function(){}),r.Preference.createOrModify({key:"showBlurPage",value:"true"},function(){}))}):r.Preference.findBy("key","showBlurGrowl",function(e){e||(r.Preference.createOrModify({key:"showBlurGrowl",value:"false"},function(){}),r.Preference.createOrModify({key:"showBlurPage",value:"false"},function(){}))})),r.Preference.findBy("key","dynamicTag",function(e){e&&u.tags.unshift(e.value),u.silent||-1==u.tags[0].toUpperCase().indexOf("YT14")||(u.silent=!0),p.licenseModule.startDailyTouch(function(){F(function(){R(i)})})})})})}function P(e,t){t=t||q,r.Preference.createOrModify({key:"postInstallUrl",value:e},function(){t()})}function O(e){e.on("window:createTab",function(e){e.panelData&&(ABINE_DNTME.lastPanel||(ABINE_DNTME.lastPanel={}),ABINE_DNTME.lastPanel[e.panelData.action]=e.panelData.type),n.createTab(e)})}function B(n){try{var a=[j,J,G],i=m.after(a.length,n);r.Preference.findBy("key","splitTests",function(e){if(e&&e.value){var t=JSON.parse(e.value);m.each(a,function(e){e(t,i)})}else n()})}catch(e){n()}}function R(a){try{r.Preference.findBy("key","configOverrides",function(e){if(e&&e.value){var t=JSON.parse(e.value);for(var n in t)n in ABINE_DNTME.config&&(ABINE_DNTME.config[n]=t[n],ABINE_DNTME.config.overriddenKeys[n]=!0)}a()})}catch(e){a()}}function F(e){r.Preference.createOrModify({key:"showTrackersOnload",value:"false"},function(){e()})}var L=!(ABINE_DNTME.setupUninstallUrl=function(){r.Preference.findBy("key","installAuthToken",function(e){try{var t=ABINE_DNTME.config.protocol+ABINE_DNTME.config.webHost+"/blur/uninstall?p="+btoa(JSON.stringify({b:ABINE_DNTME.config.browser,v:ABINE_DNTME.config.version,t:ABINE_DNTME.config.tags[0],e:ABINE_DNTME.config.environment,i:s.getUserId(),ia:e?e.value:null}));"undefined"==typeof browser?chrome.runtime.setUninstallURL(t):browser.runtime.setUninstallURL(t)}catch(n){console.log(n)}})}),q=function(){},U=!1,J=function(e,t){t()},j=function(e,t){if(e){var n=e.intrusive01;u.silent||null==n?t():(p.licenseModule.logSplitData({bucket_id:n,test_data:{int0:1}}),n==T.SPLIT_INTRUSIVE_NON_INTRUSIVE?r.Preference.createOrModify({key:"showTrackersOnload",value:"false"},function(){t()}):t())}else t()},G=function(e,t){if(e){var n=e.iconpanels01;u.silent||null==n?t():(p.licenseModule.logSplitData({bucket_id:n,test_data:{int0:1}}),n!=T.SPLIT_ICON_PANELS_NORMAL?r.Preference.createOrModify({key:"useIconPanelMode",value:n},function(){t()}):t())}else t()};ABINE_DNTME.bguser={shouldSendErrorReports:function(){var e=r.Preference.getSync("shouldSendErrorReports");return e&&e.isTrue()},getEmailSalt:function(){var e=r.Preference.getSync("Salt.ShieldedEmail");return e&&e.value}};var H={initialize:N};return m.extend(H,y.Events),H}),ABINE_DNTME.define("abine/badgeManager",["documentcloud/underscore"],function(){return{badges:{totalBlocked:{levels:[{name:"dntp.badges.bronze",limit:500,cssClass:"Bronze",icon:"/images/bronze-sm.png"},{name:"dntp.badges.silver",limit:5e3,cssClass:"Silver",icon:"/images/silver-sm.png"},{name:"dntp.badges.gold",limit:1e4,cssClass:"Gold",icon:"/images/gold-sm.png"},{name:"dntp.badges.platinum",cssClass:"Platinum",limit:25e3,icon:"/images/platinum-sm.png",level:1}],text:"dntp.badges.totalBlocked.text",title:"dntp.badges.totalBlocked.title",badgeText:"dntp.badges.totalBlocked.badgeText"},socialBlocked:{levels:[{name:"dntp.badges.bronze",limit:100,cssClass:"Bronze",icon:"/badge/bronze.png"},{name:"dntp.badges.silver",limit:1e3,cssClass:"Silver",icon:"/badge/silver.png"},{name:"dntp.badges.gold",limit:5e3,cssClass:"Gold",icon:"/badge/gold.png"},{name:"dntp.badges.platinum",cssClass:"Platinum",limit:15e3,icon:"/badge/platinum.png",level:1}],text:"dntp.badges.socialBlocked.text",title:"dntp.badges.socialBlocked.title",badgeText:"dntp.badges.socialBlocked.badgeText"}},getBadgeAt:function(e,t){var n={name:"None",limit:-1,icon:"/badge/nobadge.png"},a=this.badges[e];if(0<=t){var i=a.levels;if(t>=i.length)for(var r=i.length-1;r<=t;r++){var s={name:i[r].name,cssClass:i[r].cssClass,limit:i[r].limit+(0==e.indexOf("social")?1e4:25e3),icon:i[r].icon,level:i[r].level+1};i.push(s)}n=i[t]}return n.title=a.title,n.text=a.text,n.badgeText=a.badgeText,n.setting=e,n},compute:function(e){for(var t={},n="totalBlocked",a=0,i=-1;;){var r=this.getBadgeAt(n,a);if(r.limit>e)break;r.limit<e&&(i=a,t=r),a++}return{badgeIndex:i,badge:t}}}}),ABINE_DNTME.define("abine/merged-dataset",["documentcloud/underscore","abine/core","abine/localStorage","storage","abine/timer","persistence","modules","abine/securityManager","aws","abine/crypto"],function(l,e,t){var u=t.getItem("maxRecords")||1e3,n=function(e){this.client=e};return n.prototype.refreshDatasetNames=function(n,a){var i=this;this.client.refreshDatasetMetadata(function(){i.client.listDatasets(function(e,t){i.datasetNames=[n],l.each(t,function(e){e.datasetName&&-1!==e.datasetName.indexOf(n)&&e.datasetName!==n&&i.datasetNames.push(e.datasetName)}),a()})})},n.prototype.updateDatasets=function(n,a){var i=this,r=l.clone(this.datasetNames),s=!1;this.client.refreshDatasetMetadata(function(){i.client.listDatasets(function(e,t){l.async.forEachSeries(t,function(e,t){e.datasetName&&-1!==e.datasetName.indexOf(n)&&(-1===i.datasetNames.indexOf(e.datasetName)?s=!0:r=l.without(r,e.datasetName)),t()},function(){s||0<r.length?i.openOrCreateDataset(n,a):a()})})})},n.prototype.openOrCreateDataset=function(e,t){var a=this;this.refreshDatasetNames(e,function(){a.datasets=[],l.async.forEachSeries(a.datasetNames,function(e,n){a.client.openOrCreateDataset(e,function(e,t){a.datasets.push(t),n()})},function(){t()})})},n.prototype.getAllRecords=function(e){var a=[];l.async.forEachSeries(this.datasets,function(e,n){e.getAllRecords(function(e,t){a=a.concat(t),n()})},function(){e(null,a)})},n.prototype.remove=function(i,r){var s=!1,o=this;l.async.forEachSeries(this.datasets,function(n,a){s?a():n.get(i,function(e,t){void 0!==t&&(s=!0,n.remove(i,r),n!==o.datasets[0]&&o.touchDefaultDataset()),a()})},function(){s||r(null)})},n.prototype.getCorrectSyncCount=function(e){this.datasets[0].getCorrectSyncCount(e)},n.prototype.hasChanges=function(a){l.async.forEachSeries(this.datasets,function(e,n){e.hasChanges(function(e,t){t?a(null,!0):n()})},function(){a(null,!1)})},n.prototype.put=function(i,r,a,s){var o=this,c=!1;l.async.forEachSeries(this.datasets,function(n,a){c?a():n.get(i,function(e,t){void 0!==t&&(c=!0,n.put(i,r,function(){})),a()})},function(){c?s?a():o.touchDefaultDataset(a):l.async.forEachSeries(o.datasets,function(n,a){c?a():n.getAllRecords(function(e,t){t&&t.length<u&&(c=!0,n.put(i,r,function(){})),a()})},function(){var n;if(c)s?a():o.touchDefaultDataset(a);else{for(n=1;-1!==o.datasetNames.indexOf(n+"_BlurData");)n+=1;o.client.openOrCreateDataset(n+"_BlurData",function(e,t){o.datasetNames.push(n+"_BlurData"),o.datasets.push(t),t.put(i,r,function(){s?a():o.touchDefaultDataset(a,!0)})})}})})},n.prototype.touchDefaultDataset=function(n,a){var i=this;1<this.datasets.length?this.datasets[0].hasChanges(function(e,t){!t||a?i.datasets[0].put("Dummy:1",JSON.stringify({id:"1",data:Math.random(),modifiedAt:new Date,numDatasets:i.datasets.length}),function(){n&&n()}):n&&n()}):n&&n()},n.prototype.putAll=function(n,e){var a=this,t=l.keys(n);l.async.forEachSeries(t,function(e,t){a.put(e,n[e],function(){t()})},function(){a.touchDefaultDataset(e)},!0)},n.prototype.synchronize=function(i){var r=this,n=!0;l.async.forEachSeries(this.datasets,function(e,t){e.synchronize({onSuccess:function(){t()},onFailure:function(e){n=!1,i.onFailure(e)},onConflict:function(e,t,n){var s;s=[],l.each(t,function(e){var t,n,a,i;if(""===e.remoteRecord.value)s.push(e.resolveWithRemoteRecord());else if(""===e.localRecord.value)s.push(e.resolveWithLocalRecord());else if(e.remoteRecord.value===e.localRecord.value)s.push(e.resolveWithRemoteRecord());else{try{t=JSON.parse(e.localRecord.value),a=JSON.parse(e.remoteRecord.value)}catch(r){}try{n=new Date(t.modifiedAt)}catch(r){}try{i=new Date(a.modifiedAt)}catch(r){}i<n?s.push(e.resolveWithLocalRecord()):s.push(e.resolveWithRemoteRecord())}}),e.resolve(s,function(e){e||n(!0)})},onDatasetDeleted:function(e,t,n){n(!0)},onDatasetsMerged:function(e,t,n){n(!0)}})},function(){n&&(i.onSuccess(),r.datasets[0].get("Dummy:1",function(e,t){var n;if(t){try{n=JSON.parse(t)}catch(a){}n&&n.numDatasets>r.datasets.length&&r.updateDatasets("BlurData",function(){i.resync()})}}))})},n}),ABINE_DNTME.define("abine/blurstore-api",["documentcloud/underscore","abine/core","abine/localStorage","storage","abine/timer","persistence","modules","abine/securityManager","aws","abine/crypto","abine/merged-dataset","abine/pageEvents","abine/perf"],function(u,e,t,d,i,f,s,h,a,p,r){a.CognitoSyncManager.localStorage=t;var o=6e5,c=function(){};return a.CognitoSyncManager.Dataset.prototype.getCorrectSyncCount=function(a){var n=this;this.getDatasetMetadata(function(e,t){t.lastSyncCount?a(t.lastSyncCount):n.getAllRecords(function(e,t){var n=0;u.each(t,function(e){e.syncCount&&e.syncCount>n&&(n=e.syncCount)}),a(n)})})},new(e.BaseClass.extend({initialize:function(){this.tables={},this.synchronize=u.debounce(u.bind(this._synchronize,this),1e3)},connect:function(){this._pendingConnect||(this._connected=!1,this._pendingConnect=!0,s.licenseModule.retrieveSyncstoreToken(u.bind(function(e,t){if(e||"blur"!=t.manager)this._pendingConnect=!1;else{var n={AccountId:t.account_id,IdentityPoolId:t.identity_pool_id,RoleArn:t.role_arn,WebIdentityToken:t.token,RoleSessionName:"extension"};a.config.region=t.region,a.config.correctClockSkew=!0,a.config.credentials=new a.WebIdentityCredentials(n),this.datasetPollTimer&&i.clearInterval(this.datasetPollTimer),a.config.credentials.get(u.bind(function(){a.config.credentials.identityId=t.identity_id,this.client=new a.CognitoSyncManager({log:c}),this.dataset=new r(this.client),this._connected=!0,this._pendingConnect=!1,this.dataset.openOrCreateDataset("BlurData",u.bind(function(){this.synchronize(),this.datasetPollTimer=i.setInterval(u.bind(this._synchronize,this),o)},this))},this))}},this)))},connectAndLoad:function(){this._connected||(this.lastSyncCount=-1,this.connect())},disconnect:function(){this._connected&&i.clearInterval(this.datasetPollTimer),this.lastSyncCount=-1,this._connected=!1,this.client=null,this.dataset=null},addTable:function(e){this.tables[e]=1},updateAll:function(){u.each(this.tables,u.bind(function(e,t){this.load(t)},this))},load:function(a){function i(e){if(r.meta.encrypted&&!s){var t=p.decryptObject(n,e,r.meta.encryptedFields,l);l=!1,1==t?s=!0:2==t&&c.push(e)}e.masked_email&&delete e.masked_email}if(this._connected){var r=d[a],n=null;r.meta.encrypted&&(n=h.getEncryptionKey());var s=!1,o={},c=[],l=!0;this.dataset.getAllRecords(u.bind(function(e,t){u.each(t,u.bind(function(e){if(e.value&&0!=e.value.length&&0==e.key.indexOf(a+":")){var t=e.key;try{e=JSON.parse(e.value)}catch(n){}e&&e.id?o[e.id]=e:this.dataset.remove(t,function(){})}},this)),r.index(null,u.bind(function(e){u.each(e,function(e){if(!s){var t=o[e.id];if(1==e.pushed)if(t){if((e.modifiedAt!=t.modifiedAt||e.createdAt!=t.createdAt)&&(i(t),!s)){r.updateCache(e,t);for(var n in e._dirtyProperties)if(e._dirtyProperties.hasOwnProperty(n)){!0;break}e.pushed=1}delete o[e.id]}else f.remove(e);else t?(e.pushed=1,e.modifiedAt>t.modifiedAt?e.markDirty("pushed"):e.modifiedAt==t.modifiedAt&&e.createdAt==t.createdAt||(i(t),s||(r.updateCache(e,t),e.pushed=1)),delete o[e.id]):e.markDirty("pushed")}}),s||(u.each(o,function(e){i(e);var t=new d[a](e);t._dirtyProperties={},t._new=!1,t._notInLocalStorage=!0,f.add(t)}),f.flush(),0<c.length&&(u.each(c,u.bind(function(e){e.pushed=0},this)),this.save(a)))},this))},this))}},synchronizeWhenOld:function(e,t){this.dataset&&e&&!isNaN(e)&&this.lastSyncCount<e&&("push"==t&&(this._externalSync=!0),this.synchronize())},canUpdateAll:function(n){var r=this;this.dataset.getAllRecords(function(e,t){if(!!u.find(t,function(e){return e.value&&0<e.value.length}))n(!0);else{var a=!1,i=!1;u.async.forEachSeries(u.keys(r.tables),function(e,n){a?n():d[e].index(null,function(e){0<e.length?(a=!0,s.licenseModule.retrieveSyncstoreToken(function(e,t){e||"blur"!=t.manager?(r.disconnect(),h.refreshData()):i=!0,n()})):n()})},function(){n(i)})}})},_synchronize:function(e){function n(){if(a._syncCallbacks){var e=a._syncCallbacks;a._syncCallbacks=null,u.each(e,function(e){try{e()}catch(t){}})}}var a=this;if(this._connected){if(!this.syncInProgress)return this.syncInProgress=!0,this.dataset.synchronize({resync:function(){a.synchronize()},onSuccess:function(){a.syncInProgress=!1,a._reconnectAttempt=0,a.canUpdateAll(function(e){e?(a.updateAll(),n(),ABINE_DNTME.require(["abine/pageEvents","abine/pushNotifications"],function(e,t){a.dataset.getCorrectSyncCount(function(e){a.lastSyncCount&&a.lastSyncCount<e&&(ABINE_DNTME.backgroundMessenger.sendToWebapp("abine:store:sync",e),a._externalSync||t.pushSync(e),a._externalSync=!1),
a.lastSyncCount=e})})):n()})},onFailure:function(e){if(a.syncInProgress=!1,e&&("CredentialsError"===e.code||e.message&&e.message.match(/signature expired/i))){a._reconnectAttempt||(a._reconnectAttempt=0),a._reconnectAttempt++;var t=0;1<a._reconnectAttempt&&(t=5*Math.random()*60*1e3+3e5),i.setTimeout(function(){a.disconnect(),a.connect()},t)}n()}});e&&(this._syncCallbacks=this._syncCallbacks||[],this._syncCallbacks.push(e))}},save:function(n){if(this._connected){var a=d[n],i=null;a.meta.encrypted&&(i=h.getEncryptionKey());var r=!1,s=this,o={},c=[];a.index(null,function(e){function t(){s.dataset.putAll(o,function(){s.synchronize(),u.each(c,function(e){ABINE_DNTME.backgroundMessenger.sendToWebapp("update:entity",[e.name,e.obj])})})}u.each(e,function(e){if(1!==e.pushed){r=!0;var t=e.toJSON();t.pushed=1,c.push({name:n,obj:u.clone(t)}),a.meta.encrypted&&i&&p.encryptObject(i,t,a.meta.encryptedFields),o[n+":"+t.id]=JSON.stringify(t)}}),r&&(f.flush(),s.syncInProgress?s._synchronize(t):t())})}},"delete":function(e,t){var n=this;if(n._connected)try{n.dataset.remove(e+":"+t,function(){n.synchronize(),ABINE_DNTME.backgroundMessenger.sendToWebapp("delete:entity",[e,t])})}catch(a){}}}))}),ABINE_DNTME.define("abine/contextHelper",["documentcloud/underscore","abine/window","storage","abine/password","abine/config","abine/securityManager","abine/webapp"],function(l,e,u,o,t,n,c){return{onClick:function(t,e,n,a,i){if(0<=e.indexOf("abine_dntme_accountfield_"))this.fillLogin(e,n,t,i);else if(0<=e.indexOf("abine_dntme_fillcard_"))this.fillCard(e,n,t,i);else if(0<=e.indexOf("abine_dntme_address_"))this.fillAddress(e,n,t,i);else if(0<=e.indexOf("abine_dntme_phone_mask_"))this.fillDiposablePhone(e,n,t,i);else if(0<=e.indexOf("abine_dntme_phone_disclose_"))this.fillRealPhone(e,n,t,i);else switch(e){case"abine_dntme_ignore":this.fillFieldInTab(t,n,{element:i,value:null,dataType:"/ignore",origin:""});break;case"abine_dntme_email_mask":this.fillFieldInTab(t,n,{element:i,dataType:"/contact/email",origin:"disposable",generate:!0,formType:"registrationForm"});break;case"abine_dntme_email_disclose":u.ShieldedEmail.index(null,l.bind(function(e){this.fillFieldInTab(t,n,{element:i,value:e[0].email,dataType:"/contact/email",origin:"",formType:"registrationForm"})},this));break;case"abine_dntme_card_mask":this.triggerCreditCardPanelInTab(t,n,{});break;case"abine_dntme_activate_card":c.openCards();break;case"abine_dntme_password_mask":var r=o.generateRandomPassword();this.fillFieldInTab(t,n,{element:i,value:r,origin:"strong",generatedNow:!0,dataType:"/password",formType:"registrationForm"});var s={domain:a,password:r};t.send("background:save:account",s);break;case"abine_dntme_unlock":c.openLogin();break;case"abine_dntme_setup_phone":c.openPhones();break;case"abine_dntme_map_form":case"abine_dntme_autofill_form":t.send("background:contextmenu:mapform",{},n);break;case"abine_dntme_blacklisted":t.send("background:dntme:show",{tabId:n},n)}},fillLogin:function(e,a,i,r){var s=(e=e.split("accountfield_")[1]).split("_")[0],t=e.split("_")[1];u.Account.load(t,l.bind(function(e){if(e){var t=null,n=null;"email"==s?(t="/contact/email",n=e.email):"username"==s?(t="/nameperson/friendly",n=e.username):"password"==s&&(t="/password",n=e.password),t&&n&&this.fillFieldInTab(i,a,{element:r,value:n,dataType:t,origin:"",formType:"loginForm"})}},this))},fillCard:function(e,r,s,o){var c=(e=e.split("fillcard_")[1]).split("_")[0],t=e.split("_")[1];u.Address.index(null,l.bind(function(e){var i={};l.each(e,function(e){i[e.id]=e.toJSON()}),u.RealCard.load(t,l.bind(function(e){if(e){var t="/financial/creditcard/number",n=e.number;"cvc"==c?(t="/financial/creditcard/verification",n=e.cvc):"name"==c?(t="/financial/creditcard/issuedto",n=e.getFullName()):"month"==c?(t="/financial/creditcard/expiry_month",n=e.getMM()):"year"==c?(t="/financial/creditcard/expiry_year",n=e.expiry_year):"yy"==c?(t="/financial/creditcard/expiry_year2",n=e.getYY()):"mmyyyy"==c?(t="/financial/creditcard/expiry",n=e.getMMYYYY()):"mmyy"==c&&(t="/financial/creditcard/expiry2",n=e.getMMYY()),this.fillFieldInTab(s,r,{element:o,value:n,dataType:t,origin:"",formType:"checkoutForm"});var a=e.jsonWithAddress(i);this.triggerAutoFillCreditCardPanelInTab(s,r,a)}},this))},this))},fillAddress:function(e,a,i,r){var s=(e=e.split("address_")[1]).split("_")[0],t=e.split("_")[1];u.Address.load(t,l.bind(function(e){if(e){var t="/contact/postaladdress",n=e.address1;"line2"==s?(t="/contact/postaladdressAdditional",n=e.address2):"city"==s?(t="/contact/city",n=e.city):"state"==s?(t="/contact/state",n=e.state):"country"==s?(t="/contact/country",n=e.country):"zip"==s&&(t="/contact/postalcode",n=e.zip),this.fillFieldInTab(i,a,{element:r,value:n,dataType:t,origin:""})}},this))},fillPhone:function(e,t,n,a,i){switch(e){case"full":t.value=n.getPrettyNumber(),t.dataType="/contact/phone",this.fillFieldInTab(a,i,t);break;case"area":t.value=n.number.substr(0,3),t.dataType="/contact/phone/areacode",this.fillFieldInTab(a,i,t);break;case"exchange":t.value=n.number.substr(3,3),t.dataType="/contact/phone/exchange",this.fillFieldInTab(a,i,t);break;case"local":t.value=n.number.substr(6,4),t.dataType="/contact/phone/local",this.fillFieldInTab(a,i,t);break;case"last7":t.value=n.number.substr(3,7),t.dataType="/contact/phone/number",this.fillFieldInTab(a,i,t)}},fillDiposablePhone:function(e,a,i,r){var s=e.split("mask_")[1];u.DisposablePhone.index(null,l.bind(function(e){var t=e[0],n={element:r,origin:"disposable",disposableGUID:t.id};this.fillPhone(s,n,t,i,a)},this))},fillRealPhone:function(e,a,i,r){var s=e.split("disclose_")[1];u.ShieldedPhone.index(null,l.bind(function(e){var t=e[0],n={element:r,origin:""};this.fillPhone(s,n,t,i,a)},this))},fillFieldInTab:function(e,t,n){e.send("background:contextmenu:fill",n,t)},triggerCreditCardPanelInTab:function(e,t,n){e.send("background:contextmenu:maskcard",n,t)},triggerAutoFillCreditCardPanelInTab:function(e,t,n){e.send("background:contextmenu:fillcard",n,t)}}}),ABINE_DNTME.define("abine/crypto",["asmCrypto","blueimp-md5","abine/perf"],function(f,t){
/*!
    mnemonic.js : Converts between 4-byte aligned strings and a human-readable
    sequence of words. Uses 1626 common words taken from wikipedia article:
    http://en.wiktionary.org/wiki/Wiktionary:Frequency_lists/Contemporary_poetry
    Originally written in python special for Electrum (lightweight Bitcoin client).
    This version has been reimplemented in javascript and placed in public domain.

 Copyright (c) 2012 Yiorgis Gozadinos,
 Crypho AS, Harpunveien 3, 3126 Nttery, Norway

 Permission is hereby granted, free of charge, to any person
 obtaining a copy of this software and associated documentation
 files (the "Software"), to deal in the Software without
 restriction, including without limitation the rights to use,
 copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the
 Software is furnished to do so, subject to the following
 conditions:

 The above copyright notice and this permission notice shall be
 included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 OTHER DEALINGS IN THE SOFTWARE.
*/
function e(e){for(var t=[],n=w.length,a=0;a<e.length;a+=8){var i=parseInt(e.substr(a,8),16),r=i%n,s=(Math.floor(i/n)+r)%n,o=(Math.floor(Math.floor(i/n)/n)+s)%n;t=t.concat([w[r],w[s],w[o]])}return t.join(" ")}function c(e,t){return e<0?t+e:e%t}function n(e){for(var t="",n=w.length,a=e.split(" "),i=0;i<a.length;i+=3){var r=w.indexOf(a[i]),s=w.indexOf(a[i+1])%n,o=w.indexOf(a[i+2])%n;t+=("0000000"+(r+n*c(s-r,n)+n*n*c(o-s,n)).toString(16)).slice(-8)}return t}function h(e){var t=e.replace(/[\u0080-\u07ff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(192|t>>6,128|63&t)});return t=t.replace(/[\u0800-\uffff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(224|t>>12,128|t>>6&63,128|63&t)})}function l(e){var t=e.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){var t=(31&e.charCodeAt(0))<<6|63&e.charCodeAt(1);return String.fromCharCode(t)});return t=t.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){var t=(15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2);return String.fromCharCode(t)})}function d(e){for(var t=e.length,n=[],a=0;a<t;a+=2)n[n.length]=String.fromCharCode(parseInt(e.substr(a,2),16));return n.join("")}function p(e){return A.MD5(e)}function s(e){return A.SHA256(e)}function a(e){return A.SHA1(e)}function o(e,t){var n=e+t;return n in N||(N[n]=A.createKeyAndIV(e,t)),N[n]}function u(e,t){return A.aes_encrypt(e,t)}function m(e,t){return A.aes_decrypt(e,t)}function g(e,t,n){return u(o(e,n||s(e)),t)}function y(e,t,n,a){var i=o(e,n||s(e)),r=m(i,t);return a&&t!=u(i,r)?t:r}function b(e,t,n){try{return t!=y(e,t,n,!0)}catch(a){}return!1}function i(e,t,n){for(var a=t.id,i=0;i<n.length;i++){var r=t[n[i]];if(r&&0!=r.toString().indexOf("ENC_")){var s=g(e,r,a);s!=r&&(t[n[i]]="ENC_"+s)}}}function r(e,t,n,a){for(var i=0,r=t.id,s=0;s<n.length;s++){var o=t[n[s]];if(o&&0<o.length)if(0==o.indexOf("ENC_")){if(o=o.substr(4),!e)return 1;if(a){if(!b(e,o,r))return 1;a=!1}var c=y(e,o,r);if(c==o)return 1;t[n[s]]=c}else e&&(i=2)}return i}function v(){return A.random(8)}function _(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz!@#$%^&*(){}[]|\\/<>?,.;~",n="",a=0;a<e;a++){var i=Math.floor(Math.random()*t.length);n+=t.substring(i,i+1)}return n}function E(){return A.random(16)}function k(e){return s(u(o(e,e),e))}function T(e){return k(k(e))}var w=["like","just","love","know","never","want","time","out","there","make","look","eye","down","only","think","heart","back","then","into","about","more","away","still","them","take","thing","even","through","long","always","world","too","friend","tell","try","hand","thought","over","here","other","need","smile","again","much","cry","been","night","ever","little","said","end","some","those","around","mind","people","girl","leave","dream","left","turn","myself","give","nothing","really","off","before","something","find","walk","wish","good","once","place","ask","stop","keep","watch","seem","everything","wait","got","yet","made","remember","start","alone","run","hope","maybe","believe","body","hate","after","close","talk","stand","own","each","hurt","help","home","god","soul","new","many","two","inside","should","true","first","fear","mean","better","play","another","gone","change","use","wonder","someone","hair","cold","open","best","any","behind","happen","water","dark","laugh","stay","forever","name","work","show","sky","break","came","deep","door","put","black","together","upon","happy","such","great","white","matter","fill","past","please","burn","cause","enough","touch","moment","soon","voice","scream","anything","stare","sound","red","everyone","hide","kiss","truth","death","beautiful","mine","blood","broken","very","pass","next","forget","tree","wrong","air","mother","understand","lip","hit","wall","memory","sleep","free","high","realize","school","might","skin","sweet","perfect","blue","kill","breath","dance","against","fly","between","grow","strong","under","listen","bring","sometimes","speak","pull","person","become","family","begin","ground","real","small","father","sure","feet","rest","young","finally","land","across","today","different","guy","line","fire","reason","reach","second","slowly","write","eat","smell","mouth","step","learn","three","floor","promise","breathe","darkness","push","earth","guess","save","song","above","along","both","color","house","almost","sorry","anymore","brother","okay","dear","game","fade","already","apart","warm","beauty","heard","notice","question","shine","began","piece","whole","shadow","secret","street","within","finger","point","morning","whisper","child","moon","green","story","glass","kid","silence","since","soft","yourself","empty","shall","angel","answer","baby","bright","dad","path","worry","hour","drop","follow","power","war","half","flow","heaven","act","chance","fact","least","tired","children","near","quite","afraid","rise","sea","taste","window","cover","nice","trust","lot","sad","cool","force","peace","return","blind","easy","ready","roll","rose","drive","held","music","beneath","hang","mom","paint","emotion","quiet","clear","cloud","few","pretty","bird","outside","paper","picture","front","rock","simple","anyone","meant","reality","road","sense","waste","bit","leaf","thank","happiness","meet","men","smoke","truly","decide","self","age","book","form","alive","carry","escape","damn","instead","able","ice","minute","throw","catch","leg","ring","course","goodbye","lead","poem","sick","corner","desire","known","problem","remind","shoulder","suppose","toward","wave","drink","jump","woman","pretend","sister","week","human","joy","crack","grey","pray","surprise","dry","knee","less","search","bleed","caught","clean","embrace","future","king","son","sorrow","chest","hug","remain","sat","worth","blow","daddy","final","parent","tight","also","create","lonely","safe","cross","dress","evil","silent","bone","fate","perhaps","anger","class","scar","snow","tiny","tonight","continue","control","dog","edge","mirror","month","suddenly","comfort","given","loud","quickly","gaze","plan","rush","stone","town","battle","ignore","spirit","stood","stupid","yours","brown","build","dust","hey","kept","pay","phone","twist","although","ball","beyond","hidden","nose","taken","fail","float","pure","somehow","wash","wrap","angry","cheek","creature","forgotten","heat","rip","single","space","special","weak","whatever","yell","anyway","blame","job","choose","country","curse","drift","echo","figure","grew","laughter","neck","suffer","worse","yeah","disappear","foot","forward","knife","mess","somewhere","stomach","storm","beg","idea","lift","offer","breeze","field","five","often","simply","stuck","win","allow","confuse","enjoy","except","flower","seek","strength","calm","grin","gun","heavy","hill","large","ocean","shoe","sigh","straight","summer","tongue","accept","crazy","everyday","exist","grass","mistake","sent","shut","surround","table","ache","brain","destroy","heal","nature","shout","sign","stain","choice","doubt","glance","glow","mountain","queen","stranger","throat","tomorrow","city","either","fish","flame","rather","shape","spin","spread","ash","distance","finish","image","imagine","important","nobody","shatter","warmth","became","feed","flesh","funny","lust","shirt","trouble","yellow","attention","bare","bite","money","protect","amaze","appear","born","choke","completely","daughter","fresh","friendship","gentle","probably","six","deserve","expect","grab","middle","nightmare","river","thousand","weight","worst","wound","barely","bottle","cream","regret","relationship","stick","test","crush","endless","fault","itself","rule","spill","art","circle","join","kick","mask","master","passion","quick","raise","smooth","unless","wander","actually","broke","chair","deal","favorite","gift","note","number","sweat","box","chill","clothes","lady","mark","park","poor","sadness","tie","animal","belong","brush","consume","dawn","forest","innocent","pen","pride","stream","thick","clay","complete","count","draw","faith","press","silver","struggle","surface","taught","teach","wet","bless","chase","climb","enter","letter","melt","metal","movie","stretch","swing","vision","wife","beside","crash","forgot","guide","haunt","joke","knock","plant","pour","prove","reveal","steal","stuff","trip","wood","wrist","bother","bottom","crawl","crowd","fix","forgive","frown","grace","loose","lucky","party","release","surely","survive","teacher","gently","grip","speed","suicide","travel","treat","vein","written","cage","chain","conversation","date","enemy","however","interest","million","page","pink","proud","sway","themselves","winter","church","cruel","cup","demon","experience","freedom","pair","pop","purpose","respect","shoot","softly","state","strange","bar","birth","curl","dirt","excuse","lord","lovely","monster","order","pack","pants","pool","scene","seven","shame","slide","ugly","among","blade","blonde","closet","creek","deny","drug","eternity","gain","grade","handle","key","linger","pale","prepare","swallow","swim","tremble","wheel","won","cast","cigarette","claim","college","direction","dirty","gather","ghost","hundred","loss","lung","orange","present","swear","swirl","twice","wild","bitter","blanket","doctor","everywhere","flash","grown","knowledge","numb","pressure","radio","repeat","ruin","spend","unknown","buy","clock","devil","early","false","fantasy","pound","precious","refuse","sheet","teeth","welcome","add","ahead","block","bury","caress","content","depth","despite","distant","marry","purple","threw","whenever","bomb","dull","easily","grasp","hospital","innocence","normal","receive","reply","rhyme","shade","someday","sword","toe","visit","asleep","bought","center","consider","flat","hero","history","ink","insane","muscle","mystery","pocket","reflection","shove","silently","smart","soldier","spot","stress","train","type","view","whether","bus","energy","explain","holy","hunger","inch","magic","mix","noise","nowhere","prayer","presence","shock","snap","spider","study","thunder","trail","admit","agree","bag","bang","bound","butterfly","cute","exactly","explode","familiar","fold","further","pierce","reflect","scent","selfish","sharp","sink","spring","stumble","universe","weep","women","wonderful","action","ancient","attempt","avoid","birthday","branch","chocolate","core","depress","drunk","especially","focus","fruit","honest","match","palm","perfectly","pillow","pity","poison","roar","shift","slightly","thump","truck","tune","twenty","unable","wipe","wrote","coat","constant","dinner","drove","egg","eternal","flight","flood","frame","freak","gasp","glad","hollow","motion","peer","plastic","root","screen","season","sting","strike","team","unlike","victim","volume","warn","weird","attack","await","awake","built","charm","crave","despair","fought","grant","grief","horse","limit","message","ripple","sanity","scatter","serve","split","string","trick","annoy","blur","boat","brave","clearly","cling","connect","fist","forth","imagination","iron","jock","judge","lesson","milk","misery","nail","naked","ourselves","poet","possible","princess","sail","size","snake","society","stroke","torture","toss","trace","wise","bloom","bullet","cell","check","cost","darling","during","footstep","fragile","hallway","hardly","horizon","invisible","journey","midnight","mud","nod","pause","relax","shiver","sudden","value","youth","abuse","admire","blink","breast","bruise","constantly","couple","creep","curve","difference","dumb","emptiness","gotta","honor","plain","planet","recall","rub","ship","slam","soar","somebody","tightly","weather","adore","approach","bond","bread","burst","candle","coffee","cousin","crime","desert","flutter","frozen","grand","heel","hello","language","level","movement","pleasure","powerful","random","rhythm","settle","silly","slap","sort","spoken","steel","threaten","tumble","upset","aside","awkward","bee","blank","board","button","card","carefully","complain","crap","deeply","discover","drag","dread","effort","entire","fairy","giant","gotten","greet","illusion","jeans","leap","liquid","march","mend","nervous","nine","replace","rope","spine","stole","terror","accident","apple","balance","boom","childhood","collect","demand","depression","eventually","faint","glare","goal","group","honey","kitchen","laid","limb","machine","mere","mold","murder","nerve","painful","poetry","prince","rabbit","shelter","shore","shower","soothe","stair","steady","sunlight","tangle","tease","treasure","uncle","begun","bliss","canvas","cheer","claw","clutch","commit","crimson","crystal","delight","doll","existence","express","fog","football","gay","goose","guard","hatred","illuminate","mass","math","mourn","rich","rough","skip","stir","student","style","support","thorn","tough","yard","yearn","yesterday","advice","appreciate","autumn","bank","beam","bowl","capture","carve","collapse","confusion","creation","dove","feather","girlfriend","glory","government","harsh","hop","inner","loser","moonlight","neighbor","neither","peach","pig","praise","screw","shield","shimmer","sneak","stab","subject","throughout","thrown","tower","twirl","wow","army","arrive","bathroom","bump","cease","cookie","couch","courage","dim","guilt","howl","hum","husband","insult","led","lunch","mock","mostly","natural","nearly","needle","nerd","peaceful","perfection","pile","price","remove","roam","sanctuary","serious","shiny","shook","sob","stolen","tap","vain","void","warrior","wrinkle","affection","apologize","blossom","bounce","bridge","cheap","crumble","decision","descend","desperately","dig","dot","flip","frighten","heartbeat","huge","lazy","lick","odd","opinion","process","puzzle","quietly","retreat","score","sentence","separate","situation","skill","soak","square","stray","taint","task","tide","underneath","veil","whistle","anywhere","bedroom","bid","bloody","burden","careful","compare","concern","curtain","decay","defeat","describe","double","dreamer","driver","dwell","evening","flare","flicker","grandma","guitar","harm","horrible","hungry","indeed","lace","melody","monkey","nation","object","obviously","rainbow","salt","scratch","shown","shy","stage","stun","third","tickle","useless","weakness","worship","worthless","afternoon","beard","boyfriend","bubble","busy","certain","chin","concrete","desk","diamond","doom","drawn","due","felicity","freeze","frost","garden","glide","harmony","hopefully","hunt","jealous","lightning","mama","mercy","peel","physical","position","pulse","punch","quit","rant","respond","salty","sane","satisfy","savior","sheep","slept","social","sport","tuck","utter","valley","wolf","aim","alas","alter","arrow","awaken","beaten","belief","brand","ceiling","cheese","clue","confidence","connection","daily","disguise","eager","erase","essence","everytime","expression","fan","flag","flirt","foul","fur","giggle","glorious","ignorance","law","lifeless","measure","mighty","muse","north","opposite","paradise","patience","patient","pencil","petal","plate","ponder","possibly","practice","slice","spell","stock","strife","strip","suffocate","suit","tender","tool","trade","velvet","verse","waist","witch","aunt","bench","bold","cap","certainly","click","companion","creator","dart","delicate","determine","dish","dragon","drama","drum","dude","everybody","feast","forehead","former","fright","fully","gas","hook","hurl","invite","juice","manage","moral","possess","raw","rebel","royal","scale","scary","several","slight","stubborn","swell","talent","tea","terrible","thread","torment","trickle","usually","vast","violence","weave","acid","agony","ashamed","awe","belly","blend","blush","character","cheat","common","company","coward","creak","danger","deadly","defense","define","depend","desperate","destination","dew","duck","dusty","embarrass","engine","example","explore","foe","freely","frustrate","generation","glove","guilty","health","hurry","idiot","impossible","inhale","jaw","kingdom","mention","mist","moan","mumble","mutter","observe","ode","pathetic","pattern","pie","prefer","puff","rape","rare","revenge","rude","scrape","spiral","squeeze","strain","sunset","suspend","sympathy","thigh","throne","total","unseen","weapon","weary"],A={MD5:function(e){return t(e)},SHA1:function(e){return f.SHA1.hex(e)},SHA256:function(e){return f.SHA256.hex(e)},random:function(e){var t=new Uint8Array(e);return f.getRandomValues(t),f.bytes_to_hex(t)},createKeyAndIV:function(e,t){var n=e+d(t),a="",i="",r=[],s=1,o=3,c=0;r[c++]=n;for(var l=0;l<o;l++){0==l?i=n:(a=d(i),i=a+=n);for(var u=0;u<s;u++)i=p(i);r[c++]=i}return{key:f.hex_to_bytes(r[1]+r[2]),iv:f.hex_to_bytes(r[3]),salt:t}},aes_encrypt:function(e,t){var n=e.key,a=e.iv,i=16,r=t;try{var s=f.string_to_bytes(h(t)),o=i-(s.length+1)%i,c=new Uint8Array(s.length+o+1);c.set(s);var l=0;c[s.length+l++]=10;for(var u=0;u<o;u++)c[s.length+l++]=o;return f.bytes_to_base64(f.AES_CBC.encrypt(c,n,null,a))}catch(d){return r}},aes_decrypt:function(e,t){var n=e.key,a=e.iv,i=t;try{var r=f.AES_CBC.decrypt(atob(t),n,null,a),s=r.length;return r=r.slice(0,s-r[s-1]-1),l(f.bytes_to_string(r))}catch(o){return i}}},N={};return{md5:p,sha256:s,sha1:a,salt:v,createKeyAndIV:o,encrypt:u,decrypt:m,encryptKey:g,decryptKey:y,verifyKey:b,encryptObject:i,decryptObject:r,randomString:_,generateKey:E,encode_mnemonic:e,decode_mnemonic:n,getServerPassword:T}}),ABINE_DNTME.define("abine/perf",[],function(){var t=null,e=function(){};return e.stop=function(e){t&&t.stop(e)},e.increment=function(e){t&&t.increment(e)},e}),ABINE_DNTME.define("abine/dntmeInit",["documentcloud/underscore","abine/dnt/api","abine/localStorage","abine/toolbar","storage","abine/timer","persistence","abine/dntmeUpgrade","abine/badgeManager","modules","abine/securityManager","abine/cobranding"],function(e,s,c,l,u,n,d,t,a,f,i,r){function o(){ABINE_DNTME.dnt_api.updateRules(r.get("rules.update.url"),function(e,t){u.Preference.findBy("key","lastRulesCheck",function(e){e||(e=new u.Preference({key:"lastRulesCheck"}),d.add(e)),e.value=Math.floor(P().valueOf()),d.flush()}),"updated"==e?c.setItem("dnt-rules",t):h()})}function h(e){if(e)var t=6e4;else t=18e5+36e5*Math.random();E&&n.clearTimeout(E),E=n.setTimeout(p,t)}function p(){u.Preference.findBy("key","lastRulesCheck",function(e){e&&e.value?new Date(parseInt(e.value)).valueOf()<(new Date).getTime()-T?o():h():o()})}function m(e,t,n){if(e){if("trackerMap"in e)for(var a in t||(t={}),"trackerSettings"in t||(t.trackerSettings={}),e.trackerMap)for(var i in a in t.trackerSettings||(t.trackerSettings[a]={}),e.trackerMap[a])t.trackerSettings[a][i]!=e.trackerMap[a][i]&&(t.trackerSettings[a][i]=!!e.trackerMap[a][i]);if("settings"in e){if("dntp.showmedals"in e.settings&&u.Preference.createOrModify({key:"showMedals",value:e.settings["dntp.showmedals"]?"true":"false"}),"dntp.useglobalallow"in e.settings&&(t.useSuggestions=e.settings["dntp.useglobalallow"]),"defaultBlocked"in e.settings&&(t.defaultBlocked=e.settings.defaultBlocked),"origin"in e.settings&&e.settings.origin&&""!=e.settings.origin&&(u.Preference.createOrModify({key:"dynamicTag",value:e.settings.origin}),ABINE_DNTME.config.tags.unshift(e.settings.origin)),"install.date"in e.settings&&u.Preference.createOrModify({key:"installDate",value:e.settings["install.date"]}),"original.version"in e.settings&&u.Preference.createOrModify({key:"installVersion",value:e.settings["original.version"]}),"disabled.sites"in e.settings&&e.settings["disabled.sites"]){var r=JSON.parse(e.settings["disabled.sites"]);for(var s in"disabledSites"in t||(t.disabledSites={}),r)s in t.trackerSettings&&delete t.trackerSettings[s],s in t.disabledSites||(t.disabledSites[s]=1,u.Blacklist.findBy("domain",s,function(e){e||(e=new u.Blacklist({domain:s}),d.add(e)),e.tracker=!0}))}if("blocked.sites"in e.settings&&e.settings["blocked.sites"]){var o=JSON.parse(e.settings["blocked.sites"]);for(var s in"blockedSites"in t||(t.blockedSites={}),o)s in t.trackerSettings&&delete t.trackerSettings[s],s in t.blockedSites||(t.blockedSites[s]=1,u.Blacklist.findBy("domain",s,function(e){e&&(e.tracker=!1)}))}}"totals"in e&&(e.totals.total&&(A=e.totals.total),e.totals.facebook&&(N+=e.totals.facebook),e.totals.twitter&&(N+=e.totals.twitter),e.totals.google&&(N+=e.totals.google),e.totals.linkedin&&(N+=e.totals.linkedin)),"dailyTotals"in e&&(S=e.dailyTotals),"badTrackers"in e&&(I=e.badTrackers),C=!0,v(),c.setItem("dnt-settings",JSON.stringify(t)),d.flush()}n(t)}function g(e,t,n,a,i,r,s){if(a&&n&&S){var o=new Date,c=b(o)+"",l=o.getFullYear();A++,x++,t in w&&N++;var u={};if(l in S?(u=S[l])[c]=c in u?u[c]+1:A:(u[c]=A,S[l]=u),s){"totals"in I||(I.totals={}),t in I.totals?I.totals[t]++:I.totals[t]=1,"daily"in I||(I.daily={});var d=t+"."+l;d in I.daily||(I.daily[d]={}),c in I.daily[d]?I.daily[d][c]++:I.daily[d][c]=1}O(),C=!0,B()}}function y(e,t,n,a,i,r,s){var o={tabId:e,disabled:t,total:n,blocked:a,suggested:i,host:r,reloadRequired:s};k.send("background:dntme:tracker-count-changed",o,e),u.Preference.findBy("key","showMedals",function(n){u.DntStats.index(null,function(e){var t;n&&"true"!=n.value||(e&&e.length&&(t=e[0]),t.hasOwnProperty("viewedBadge")&&!t.viewedBadge&&(o.isBadge=!0,o.iconPath=M.icon,t.earnedOn||(t.earnedOn=Date.now(),d.flush())));o.isBadge?l.updateIcon(o):f.panelsModule.getToolbarPanel(o,function(e){l.updateIcon(e)})})})}function b(e){e=e||new Date;var t=new Date(e.getFullYear(),0,0);return Math.floor((e-t)/864e5)}function v(){C&&(C=!1,u.DntStats.index(null,function(e){(e=e[0]).totalAllTimeTrackers=A,e.totalAllTimeSocialTrackers=N,e.dailyTrackerCounts=JSON.stringify(S),e.badTrackers=JSON.stringify(I),e.currentBadge=JSON.stringify(M),e.currentBadgeIndex=D,d.flush()}))}function _(a){var n=c.getItem("dnt-settings"),i=c.getItem("dnt-rules");if(n)try{n=JSON.parse(n)}catch(r){ABINE_DNTME.log.error("Corrupted settings file")}if(i)try{i=JSON.parse(i)}catch(r){ABINE_DNTME.log.error("Corrupted rules file")}u.DntStats.index(null,function(e){var t=!1;!e||e&&!e.length?(e=new u.DntStats({totalAllTimeTrackers:0,totalAllTimeSocialTrackers:0,dailyTrackerCounts:"{}",badTrackers:"{}",viewedBadge:!0,currentBadge:"{}",currentBadgeIndex:-1}),d.add(e),t=!0):e=e[0],e.badTrackers&&""!=e.badTrackers||(e.badTrackers="{}",t=!0),N=e.totalAllTimeSocialTrackers||0,A=e.totalAllTimeTrackers,S=JSON.parse(e.dailyTrackerCounts),I=JSON.parse(e.badTrackers),M=JSON.parse(e.currentBadge),D=e.currentBadgeIndex,t&&d.flush()}),ABINE_DNTME.tracker_blocker_disabled||t.getOldData(function(e){function t(e){var n=new s(e,i);(ABINE_DNTME.dnt_api=n).forceSaveStats=function(){v()},n.getAllTimeTotalTrackers=function(){return A},n.addListener("config-changed",function(e){c.setItem("dnt-settings",JSON.stringify(e))}),n.addListener("update-count",y),n.addListener("tracker-found",g),a.on("contentManager:init",function(e,t){n.triggerUpdateIcon(t),-1==e.url.indexOf("dntmeTour=")&&-1==e.url.indexOf("dntmeFullTour=")||ABINE_DNTME.require(["abine/tour"],function(e){e.show(t)})}),a.on("toolbar:clicked",function(e){var t=e.tabId;f.panelsModule.doToolbarPanelAction(t)||a.send("background:dntme:show",{tabId:t,page:"dashboard"},t),f.licenseModule.logAction({user_action:"clicked icon"})}),h(!0)}e&&"trackerMap"in e&&(ABINE_DNTME.dntme_upgrade=!0);try{m(e,n,t)}catch(r){ABINE_DNTME.log.error("*** error during upgrade from 2.0\n"+r+"\n"+r.stack),t(n)}})}"undefined"!=typeof ABINE_DNT&&(ABINE_DNT.browser=ABINE_DNTME.config.browser.toLowerCase());var E,k,T=864e5,w={"Facebook Connect":1,"Google +1":1,"Twitter Badge":1,LinkedIn:1},A=0,N=0,S=null,I=null,M=null,D=-1,C=!1,x=0,P=function(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},O=e.debounce(function(){var e=a.compute(A);if(-1!=e.badgeIndex&&e.badgeIndex!=D){var t=e.badgeIndex-D;0<t&&(u.Preference.createOrIncrementByInteger({key:"cardsEarned",value:t},function(){}),i.hasPassword()&&f.licenseModule.incrementMedalsEarned(t,function(){})),D=e.badgeIndex,M=e.badge,u.DntStats.index(null,function(e){(e=e[0]).viewedBadge=!1,e.earnedOn=Date.now(),e.currentBadge=JSON.stringify(M),e.currentBadgeIndex=D,d.flush()})}},3e3),B=e.debounce(v,5e3);return{initialize:function(e){k=e,ABINE_DNTME.dnt_api||_(k),i.on("background:securityManager:unlocked",function(){u.Preference.findBy("key","handledFirstAuth",function(e){e||u.Preference.createOrModify({key:"handledFirstAuth",value:!0},function(){u.Preference.findBy("key","cardsEarned",function(e){var t=!0;e&&(t=!1),f.licenseModule.incrementMedalsEarnedWithCurrentMedals(t,function(){})})})})})},getTotalBlockedInThisInstance:function(){return x},updateRules:o}}),ABINE_DNTME.define("abine/emailServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,a,i){var r=n.protocol+n.emailServerHost,s=r+"/api/v3/disposables",o=r+"/api/v4/disposables",c=r+"/api/v4/disposables/domains",l=r+"/api/v4/feedback";return i.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new a.server},readDisposables:function(e,a){this.server.makeRequest({server:"email",action:"readDisposables",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:s,type:"GET"})},generateDisposable:function(e,a){this.server.makeRequest({server:"email",action:"generateDisposable",defaults:{domain:n.disposableDomain},required:["domain","label"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:o,type:"POST"})},getDomains:function(a){this.server.makeRequest({server:"email",action:"readEmailDomains",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},url:c,type:"GET"})},sendDomainFeedback:function(e,a){this.server.makeRequest({server:"email",action:"sendDomainFeedback",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:l,type:"POST"})}})}),ABINE_DNTME.define("abine/eventLogger",["abine/config"],function(e){function t(){function t(e,t){return(t=Array.prototype.slice.call(t)).unshift(ABINE_DNTME.context+" ["+e+"]["+new Date+"]:"),t}function n(e){try{Console(e)}catch(t){}}return"undefined"==typeof console||"undefined"==typeof console.debug||ABINE_DNTME.IE_BG?{finest:function(e){n(ABINE_DNTME.context+" [FINEST]["+new Date+"]: "+e)},debug:function(e){n(ABINE_DNTME.context+" [DEBUG]["+new Date+"]: "+e)},info:function(e){n(ABINE_DNTME.context+" [INFO]["+new Date+"]: "+e)},warn:function(e){n(ABINE_DNTME.context+" [WARNING]["+new Date+"]: "+e)},error:function(e){n(ABINE_DNTME.context+" [ERROR]["+new Date+"]: "+e)}}:"undefined"!=typeof console?{finest:function(e){console.debug.apply(console,t("FINEST",arguments))},debug:function(e){console.debug.apply(console,t("DEBUG",arguments))},info:function(e){console.info.apply(console,t("INFO",arguments))},warn:function(e){console.warn.apply(console,t("WARN",arguments))},error:function(e){console.error.apply(console,t("ERROR",arguments))}}:void 0}var n=function(){},s=t();switch(s.dumpObj=function(e){var t=typeof e;if("object"!=t||null===e)return"string"==t&&(e='"'+e+'"'),String(e);var n,a,i=[],r=e&&e.constructor==Array;for(n in e)"string"==(t=typeof(a=e[n]))?a='"'+a+'"':"object"==t&&null!==a&&(a=s.dumpObj(a)),i.push((r?"":'"'+n+'":')+String(a));return(r?"[":"{")+String(i)+(r?"]":"}")},e.logLevel){case"NONE":s.error=n;case"ERROR":s.warn=n;case"WARN":s.info=n;case"INFO":s.debug=n;case"DEBUG":s.finest=n}return s.stackTrace=function(e){e=e||"";try{does.not=exist}catch(n){var t=(n.stack+"").split("\n");3<t.length&&(t.shift(),t.shift(),t.shift()),e+="\n"+t.join("\n")}this.debug(e)},ABINE_DNTME.log=ABINE_DNTME.log||s,s}),ABINE_DNTME.define("abine/formSubmitDetector",["documentcloud/underscore","abine/core","abine/eventLogger"],function(e,t){return{formSubmitDetector:new(t.BaseClass.extend({init:function(e){var n=this;e.on("contentManager:formSubmit",function(e,t){n.trigger("background:formSubmit",{formData:e,tabId:t})}),e.on("contentManager:formFieldChanged",function(e,t){n.trigger("background:formFieldChanged",{formData:e.formData,fieldData:e.fieldData,tabId:t})}),e.on("contentManager:formFieldChanged:processMapping",function(e,t){n.trigger("background:formFieldChanged:processMapping",{formData:e.formData,fieldData:e.fieldData,checkoutButtons:e.checkoutButtons,tabId:t})}),e.on("contentManager:formPaymentFieldChanged",function(e,t){n.trigger("background:formPaymentFieldChanged",{formData:e.formData,fieldData:e.fieldData,tabId:t})}),e.on("panel:fill",function(e,t){n.trigger("background:formFieldChanged",{formData:e.formData,fieldData:e.fieldData,tabId:t}),e.formData.number&&n.trigger("background:formPaymentFieldChanged",{formData:e.formData,fieldData:e.fieldData,tabId:t})})}}))}}),ABINE_DNTME.define("abine/licenseServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core","abine/responseCodes"],function(e,t,n,a,i){var r=n.protocol+n.licenseServerHost,s=r+"/api/v2/users",o=r+"/api/v2/sessions",c=r+"/api/v2/touches",l=r+"/api/v2/billing_info",u=r+"/api/v2/feedback_email",d=r+"/api/v2/panel_data",f=r+"/api/v3/signatures",h=r+"/api/v3/subscriptions",p=r+"/api/v3/stripe_subscriptions",m=r+"/api/v3/medals",g=r+"/api/v2/log_action",y=r+"/api/v2/log_split_data",b=r+"/api/v2/log_password_fill_data",v=r+"/api/v3/checkout",_=r+"/api/v3/push/sync",E=r+"/api/v3/company/accounts",k=r+"/api/v3/syncstore",T=r+"/api/v2/devices",w=r+"/api/v3/mfa/request",A=r+"/api/v3/mfa/token",N=r+"/api/v3/mfa/generic_key";return i.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new a.server},logAction:function(e,a){this.server.makeRequest({server:"license",action:"logAction",defaults:{},required:["user_action"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:g,type:"POST"})},logSplitData:function(e,a){this.server.makeRequest({server:"license",action:"logSplitData",defaults:{},required:["bucket_id"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:y,type:"POST"})},logPasswordFillData:function(e,a){this.server.makeRequest({server:"license",action:"logPasswordFillData",defaults:{},required:["choice","domain"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:b,type:"POST"})},sendPanelActivity:function(e,a){this.server.makeRequest({server:"license",action:"sendPanelActivity",defaults:{},required:["panel_data"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:d,type:"POST"})},login:function(e,a){this.server.makeRequest({server:"license",action:"login",defaults:{},required:["user_login","application"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:o,type:"POST"})},logout:function(e,a){this.server.makeRequest({server:"license",action:"logout",defaults:{},required:["auth_token"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:o+"/"+e.auth_token,type:"DELETE"})},register:function(e,a){this.server.makeRequest({server:"license",action:"register",defaults:{},required:["user","application"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:s,type:"POST"})},passwordCardAuth:function(e,a){this.server.makeRequest({server:"license",action:"passwordCardAuth",defaults:{},success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:A,type:"GET"})},getGenericBiometricKey:function(e,a){this.server.makeRequest({server:"license",action:"getGenericBiometricKey",defaults:{},success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:N,type:"GET"})},createBiometricAuthRequest:function(e,a){this.server.makeRequest({server:"license",action:"createBiometricAuthRequest",defaults:{},success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:w,type:"POST"})},getBiometricAuthResponse:function(e,a){this.server.makeRequest({server:"license",action:"getBiometricAuthResponse",defaults:{},success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:w,type:"GET"})},signature:function(e,a){this.server.makeRequest({server:"license",action:"signature",defaults:{},required:[],success:function(e){
a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:f,type:"GET"})},subscribed:function(e,a){this.server.makeRequest({server:"license",action:"subscribed",defaults:{},required:["recurly_token"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:h,type:"POST"})},stripe_subscribe:function(e,a){this.server.makeRequest({server:"license",action:"stripe_subscribed",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:p,type:"POST"})},refreshEntitlements:function(e,a){this.server.makeRequest({server:"license",action:"refreshEntitlements",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:s,type:"GET"})},makeDailyTouch:function(e,a){this.server.makeRequest({server:"license",action:"makeDailyTouch",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:c,type:"POST"})},pushSync:function(e){this.server.makeRequest({server:"license",action:"sync",defaults:{},required:[],success:function(){},error:function(){},data:e,url:_,type:"POST"})},sendFeedbackEmail:function(e,a){this.server.makeRequest({server:"license",action:"sendFeedbackEmail",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:u,type:"POST"})},billingInfo:function(e,a){this.server.makeRequest({server:"license",action:"billingInfo",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:l,type:"GET"})},retrieveMedalsEarned:function(e,a){this.server.makeRequest({server:"license",action:"retrieveMedalsEarned",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:m,type:"GET"})},incrementMedalsEarned:function(e,a){this.server.makeRequest({server:"license",action:"incrementMedalsEarned",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:m,type:"PUT"})},logCheckout:function(e,a){this.server.makeRequest({server:"license",action:"logCheckout",skip_auth_token:!0,defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:v+"/"+e.method,type:"PUT"})},retrieveSyncstoreToken:function(e,a){this.server.makeRequest({server:"license",action:"retrieveSyncstoreToken",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:k,type:"GET"})},retrieveDevices:function(e,a){this.server.makeRequest({server:"license",action:"retrieveDevices",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:T,type:"GET"})},getCompanyAccounts:function(e,a){this.server.makeRequest({server:"license",action:"getCompanyAccounts",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:E,type:"GET"})}})}),ABINE_DNTME.define("abine/lruCache",[],function(){return function(i){var r={},s=0,o=null,c=null;this.add=function(e,t){var n={id:e,data:t,previous:null,next:o};if(r[e]=n,o&&(o.previous=n),o=n,s===i){var a=c;(c=c.previous).next=null,delete r[a.id],delete a}else 0===s&&(c=n),s++},this.size=function(){return s},this.fetch=function(e){var t=r[e];if(t){if(1<s){var n=t.previous,a=t.next;c==t?c=n:o!=t&&((n.next=a).previous=n),t.previous=null,(t.next=o).previous=t,o=t}return t.data}return null},this.migrate=function(e,t){for(var n in r)-1!=n.indexOf(e)&&(t=n.replace(e,t),console.log("******** migrating ",n,t),r[t]=r[n],r[t].id=t,delete r[n])}}}),ABINE_DNTME.define("abine/mappingServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,a,i){var r=n.protocol+n.mappingServerHost,s=r+"/api/v2/dntmappings",o=r+"/api/v2/mappings/manifest",c="https://rules.abine.com/mappings/"+("production"==ABINE_DNTME.config.environment?"production":"test")+"/dntme/"+ABINE_DNTME.config.browser.toLowerCase()+"/mappings.json",l="https://rules.abine.com/mappings/"+("production"==ABINE_DNTME.config.environment?"production":"test")+"/version.txt",u=r+"/api/v3/field_data",d=r+"/api/v3/tracker_data",f=r+"/api/v3/page_data",h=r+"/api/v2/mappers",p=r+"/api/v2/mappings",m=r+"/api/v2/formblob",g=r+"/api/v2/autofill_feedback",y=r+"/api/v2/panels",b=r+"/api/v3/tracker_allow",v=function(){};return i.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new a.server},sendPanelActivity:function(e,a){a=a||v,this.server.makeRequest({server:"mapping",action:"getMappingManifest",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:o,type:"POST"})},pushMapping:function(e,a){this.server.makeRequest({server:"mapping",action:"pushMapping",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:s,type:"POST"})},getMappingVersion:function(a){this.server.makeRequest({server:"mapping",action:"getMappingVersion",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},url:l,raw:!0,skip_auth_token:!0,skip_ca:!0,type:"GET"})},getMappings:function(a){this.server.makeRequest({server:"mapping",action:"getMappingManifest",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},url:c,raw:!0,skip_auth_token:!0,skip_ca:!0,type:"GET"})},getFormMappings:function(e,a){this.server.makeRequest({server:"mapping",action:"getFormMappings",defaults:{},required:["signatures"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:c,type:"POST"})},getMapperDetails:function(e,a){this.server.makeRequest({server:"mapping",action:"getMapperDetails",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:h,type:"GET"})},getOneFormMappings:function(e,a){this.server.makeRequest({server:"mapping",action:"getFormMappings",defaults:{},required:["id"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:p+"/"+e.id,type:"GET"})},sendAutofillFeedback:function(e,a){this.server.makeRequest({server:"mapping",action:"sendAutofillFeedback",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:g,type:"POST"})},sendFormBlob:function(e,a){this.server.makeRequest({server:"mapping",action:"sendFormBlob",defaults:{},required:["form_id","html"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:m,type:"POST"})},getPanels:function(e,a){this.server.makeRequest({server:"mapping",action:"getPanels",defaults:{},required:["browser","tag","user_state"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:y,type:"GET"})},saveTrackerData:function(e,a){a=a||v,this.server.makeRequest({server:"mapping",action:"saveTrackerData",skip_auth_token:!0,defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:d,type:"POST"})},savePageData:function(e,a){a=a||v,this.server.makeRequest({server:"mapping",action:"savePageData",skip_auth_token:!0,defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:f,type:"POST"})},sendTrackerAllow:function(e,a){a=a||v,this.server.makeRequest({server:"mapping",action:"sendTrackerAllow",skip_auth_token:!0,defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:b,type:"POST"})},saveFieldData:function(e,a){a=a||v,this.server.makeRequest({server:"mapping",action:"saveFieldData",skip_auth_token:!0,defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:u,type:"POST"})}})}),ABINE_DNTME.define("abine/memoryStore",["documentcloud/underscore","abine/core","abine/lruCache"],function(e,t,n){var a=new n(1e3);return{set:function(e,t){a.add(e,t)},get:function(e,t){t(a.fetch(e))},migrate:function(e,t){a.migrate("."+e+".","."+t+".")}}}),ABINE_DNTME.define("abine/pageEvents",["documentcloud/underscore","abine/core","abine/securityManager","abine/config","storage","abine/timer","persistence","modules","abine/window","abine/dntmeUpgrade","abine/url","abine/localStorage","abine/webapp"],function(r,e,f,t,s,n,o,a,i,c,l,u,d){function h(e){return e||(e=""),e=e.replace(/&lt;|&gt;|[\s\<\>]+/g,"")}var p=null,m=null;try{"undefined"!=typeof window&&(m=[],window.onerror=function(e,t,n,a,i){i=i?i.stack:"",m.push([e,t,n,a,i]),20<m.length&&m.shift()})}catch(y){}var g=function(){};return p="development"==t.environment?/.*/i:/^(.+\.)?abine\.com$/i,new(e.BaseClass.extend({initialize:function(){},processAction:function(e,t){if(t=t||g,-1!=e.host.indexOf(ABINE_DNTME.config.licenseServerHost.replace(/:[0-9]+/,"")))switch(e.action){case"blurstore:setup:complete":this.refreshData(e.params,t),d.reload()}else if(-1!=e.host.indexOf(ABINE_DNTME.config.mappingServerHost.replace(/:[0-9]+/,"")))switch(e.action){case"get:mapping:review:mode":this.getReviewMode(t);break;case"start:mapping:review:mode":this.switchToReviewMode(!0,t);break;case"end:mapping:review:mode":this.switchToReviewMode(!1,t);break;case"set:mapper:mode":this.switchToMapperMode(e.params,t);break;case"exit:mapper:mode":this.clearMapperSettings(t);break;case"set:autofill:mode":this.switchToAutofillMode(e.params,t);break;case"updateFormRules":u.setItem("form-rules",e.params),a.mappingsModule.setFormRules(JSON.parse(e.params)),t();break;case"getVersion":t({version:ABINE_DNTME.config.version,tag:ABINE_DNTME.config.tags[0]})}else if(-1!=e.host.indexOf(ABINE_DNTME.config.webAppHost.replace(/:[0-9]+/,""))){if("importAccounts"==e.action&&(ABINE_DNTME.maskme_installed=!1),ABINE_DNTME.maskme_installed&&!e.action.match(/canAutoImport|exportFromMaskme/i))return void t();switch(e.action){case"refreshTag":this.refreshTag(t);break;case"setAuthToken":this.setAuthToken(e.params,t);break;case"retrieveAuthToken":e.secure?this.retrieveAuthToken(e.params,t):t(null);break;case"retrieveWebsocketId":this.retrieveWebsocketId(t);break;case"emitPushEvent":this.emitPushEvent(e.params),t();break;case"email:created":this.emailCreated(e.params,t);break;case"email:deleted":this.emailDeleted(e.params,t);break;case"refreshData":this.refreshData(e.params,t);break;case"retrieveDntStats":this.retrieveDntStats(e.params,t);break;case"retrieveDntData":this.retrieveDntData(e.params,t);break;case"retrieveInstallAuthToken":this.retrieveInstallAuthToken(e.params,t);break;case"reloadCompanyAccounts":this.reloadCompanyAccounts(e.params,t);break;case"migrationComplete":this.migrationComplete(e.params,t);break;case"dntNewFeaturePageVisited":this.newFeaturePageVisited(e.params,t);break;case"importAccounts":this.importAccounts(e.params,t);break;case"retrieveEntities":e.secure?this.retrieveEntities(e.params,t):t(null);break;case"updateEntity":e.secure?this.updateEntity(e.params,t):t(null);break;case"deleteEntity":e.secure?this.deleteEntity(e.params,t):t(null);break;case"resetEntity":e.secure?this.resetEntity(e.params,t):t(null);break;case"loginAccount":e.secure?this.loginAccount(e.params,t):t(null);break;case"getBrowserLoginCount":e.secure?this.getBrowserLoginCount(e.params,t):t(null);break;case"getBrowserLogins":e.secure?this.getBrowserLogins(e.params,t):t(null);break;case"userDeleted":e.secure?this.userDeleted(e.params,t):t(null);break;case"canAutoImport":t(ABINE_DNTME.maskme_installed&&ABINE_DNTME.maskme_can_export);break;case"exportFromMaskme":e.secure?c.exportFromMaskme(t):t(null);break;case"blurstore:setup:complete":this.refreshData(e.params,t),d.reload();break;case"disableBlurGrowl":this.disableBlurGrowl(e.params,t);break;case"checkBlurGrowl":this.checkBlurGrowl(e.params,t);break;case"abineStoreSync":this.abineStoreSync(e.params,t);break;case"webappActive":this.webappActive(e.params,t);break;case"languageChanged":this.changeLanguage(e.params,t);break;case"checkExtensionActivity":this.checkExtensionActivity(e.params,t);break;case"sendAutolockPref":this.sendAutolockPref(e.params,t);break;case"disconnectPushNotification":this.disconnectPushNotification(),t();break;case"getVersion":t({version:ABINE_DNTME.config.version,tag:ABINE_DNTME.config.tags[0]});break;case"getExtensionErrors":t(m);break;default:e.action&&0==e.action.indexOf("retrieveEntities")&&e.secure?this.retrieveEntities(e.params,t):t()}}else if(e.host.match(p)){switch(e.action){case"getVersion":t({version:ABINE_DNTME.config.version,tag:ABINE_DNTME.config.tags[0]});break;case"updateFormRules":u.setItem("form-rules",e.params),a.mappingsModule.setFormRules(JSON.parse(e.params)),t();break;case"updateRules":ABINE_DNTME.dnt_api.setupRules(e.params),t();break;case"getDailyTotals":this.getDailyTotalsByYear(e.params[0],t);break;case"getBadTrackerTotals":this.getBadTrackerTotals(t)}t()}else t()},refreshTag:function(t){s.Preference.findBy("key","userTag",function(e){e&&e.value&&!f.isLocked()?t(e.value):t(ABINE_DNTME.config.tags[0])})},setAuthToken:function(e,t){e.device_id&&u.setItem("device_id",e.device_id),f.setAuthToken(e.auth_token,e.key,e.companyKey),t({})},retrieveAuthToken:function(e,t){var n=f.getAuthToken();t(n&&""!=n?{auth_token:n,key:f.getEncryptionKey()||"",companyKey:f.getCompanyEncryptionKey()||"",user_id:f.getUserId(),device_id:u.getItem("device_id")}:null)},retrieveWebsocketId:function(t){ABINE_DNTME.require(["abine/pushNotifications"],function(e){t(e.getId())})},emitPushEvent:function(t){ABINE_DNTME.require(["abine/pushNotifications"],function(e){e.emit(t.event,t.payload)})},disableBlurGrowl:function(e,t){s.Preference.createOrModify({key:"showBlurGrowl",value:"false"},function(){t({})}),s.Preference.createOrModify({key:"showBlurPage",value:"false"},function(){t({})}),s.Preference.createOrModify({key:"blurGrowlTab",value:"false"},function(){t({})})},checkBlurGrowl:function(e,t){s.Preference.findBy("key","showBlurPage",function(e){!e||e.isFalse()?t(null):t(!0),s.Preference.createOrModify({key:"showBlurPage",value:"false"},function(){})})},checkExtensionActivity:function(e,t){f.isLocked()?t(null):s.Preference.findBy("key","lastActivity",function(e){e&&e.value?t({activeTime:e.value}):t(null)})},webappActive:function(e,t){s.Preference.createOrModify({key:"lastActivity",value:Date.now()},function(){}),t(null)},changeLanguage:function(e,t){"en-US"==e.lang&&(e.lang="en"),s.Preference.createOrModify({key:"dnt_language",value:e.lang},function(){t(null)})},sendAutolockPref:function(e,t){s.Preference.createOrModify({key:"autolock",value:e},function(){t({})})},abineStoreSync:function(t,e){ABINE_DNTME.require(["abine/blurstore-api"],function(e){e.synchronizeWhenOld(t)}),e(null)},importAccounts:function(t,a){var i=[];try{t.id&&t.key&&f.__setUserIdAndKey(t.id,t.key),s.Account.clearCache(function(){s.Account.index(null,function(e){var n={};r.each(e,function(e){n[e.id]=!0,i.push(e.toJSON())}),r.each(t.accounts,function(e){if(!(e.id in n)){e.domain=l.getTLD(e.domain);var t=new s.Account(e);o.add(t),i.push(t.toJSON())}}),s.Account.saveToLocalStorage(function(){t.id&&t.key&&f.__setUserIdAndKey(null,null),a(i)})})})}catch(y){}},retrieveEntities:function(e,t){var n=[];s[e]?f.afterRefresh(function(){try{return s[e].decryptionFailed?void t("decryption failed"):void s[e].index(null,function(e){r.each(e,function(e){n.push(e.toJSON())}),t(n)})}catch(y){t(n)}}):t(n)},updateEntity:function(t,n){if(s[t.name]){var a=t.entity;if(a.id)return void s[t.name].findBy("id",a.id,function(e){e?r.extend(e,a):(e=new s[t.name](a),o.add(e)),o.flush(),n()})}n()},deleteEntity:function(e,t){if(s[e.name]){var n=e.id;s[e.name].findBy("id",n,function(e){e&&(o.remove(e),o.flush()),t()})}else t()},resetEntity:function(e,t){var n=s[e.name];n?n.clearCache(function(){e.user_id?u.removeItem(e.name+"."+e.user_id):u.removeItem(e.name),t()}):t()},emailCreated:function(e){var t=new s.DisposableEmail(e);t.createdAt=e.created_at,o.add(t)},emailDeleted:function(e){s.DisposableEmail.findBy("guid",e.guid,function(e){e&&(o.remove(e),o.flush())})},refreshData:function(){o.reset(),f.refreshData()},userDeleted:function(e,t){s.Preference.findBy("key","oldEmail",function(e){e&&(o.remove(e),s.Preference.createOrModify({key:"loginNotLock",value:"true"},function(){o.flush(),t&&t({})}))})},loginAccount:function(e,t){var n=e.id||e,a=e.login_url;s.Account.findBy("id",n,function(t){s.CompanyAccount.findBy("id",n,function(e){!t&&e&&(t=e),s.LoginUrl.loginUrlForSite({params:[t.domain]},function(e){e||(e=a),e&&(e=e.href),e||(e=t.login_url),!e&&t.page_host&&(e="http://"+t.page_host),!e&&t.domain&&(e="http://"+t.domain),e&&f.openPage(e)})})}),t()},getBrowserLoginCount:function(e,t){"Firefox"!=ABINE_DNTME.config.browser?t(-1):ABINE_DNTME.require(["abine/firefox_import"],function(e){t(e.getLoginCount())})},getBrowserLogins:function(e,t){"Firefox"!=ABINE_DNTME.config.browser?t(null):ABINE_DNTME.require(["abine/firefox_import"],function(e){t(e.getLogins())})},migrationComplete:function(){s.Preference.findBy("key","mergedMigrationPending",function(e){e&&(o.remove(e),o.flush())})},retrieveDntStats:function(e,t){ABINE_DNTME.dnt_api.forceSaveStats(),s.DntStats.index(null,function(e){0<e.length?t(e[0].toJSON()):t(null)})},retrieveInstallAuthToken:function(e,t){s.Preference.findBy("key","installAuthToken",function(e){e&&""!=e.value?t({installAuthToken:e.value}):t(null)})},reloadCompanyAccounts:function(e,t){s.CompanyAccount.clearCache(),s.CompanyAccount.fetchFromServer(),t(null)},getDailyTotalsByYear:function(a,i){s.DntStats.index(null,function(e){if(0<e.length){var t=e[0],n=JSON.parse(t.dailyTrackerCounts);if(a in n)return n[a].hasBadTrackers=!0,void i(n[a])}i({})})},getBadTrackerTotals:function(d){s.DntStats.index(null,function(e){if(0<e.length){var t=e[0],n=JSON.parse(t.badTrackers);if(!n.totals)return void d({});var a=(new Date).getFullYear(),i=n.totals,r={},s=[a,a-1];for(var o in i)for(var c=0;c<s.length;c++){var l=o+"."+s[c];n.daily&&l in n.daily&&(r[o]={},r[o][s[c]]=n.daily[l])}var u={};f.getLink({},function(e){for(var t in i)u[t]=e+"&type=badTracker."+t;d({totals:i,daily:r,links:u})})}else d({})})},retrieveDntData:function(e,t){c.getMaskmeData(t)},disconnectPushNotification:function(){ABINE_DNTME.require(["abine/pushNotifications"],function(e){e.disconnect()})},newFeaturePageVisited:function(e,t){s.Preference.createOrModify({key:"new_feature_explored",value:(new Date).toString()},function(){t()})},getReviewMode:function(t){s.Preference.findBy("key","mapping:reviewer",function(e){t(e?{review:!0,email:e.value}:{review:!1})})},clearMapperSettings:function(e){s.Preference.batchRemoveBy([{by:"key",value:"mapping:reviewer"},{by:"key",value:"mapping:mapper"},{by:"key",value:"mapping:batch"},{by:"key",value:"mapping:form:id"},{by:"key",value:"autofill:mapper"},{by:"key",value:"autofill:batch"},{by:"key",value:"autofill:form:id"}],e)},switchToMapperMode:function(e,t){this.clearMapperSettings(function(){s.Preference.batchCreateOrModify([{key:"mapping:mapper",value:h(e.mapper)},{key:"mapping:batch",value:h(e.batch)},{key:"mapping:form:id",value:e.id}],function(){t(e.mapper)})})},switchToAutofillMode:function(e,t){this.clearMapperSettings(function(){s.Preference.batchCreateOrModify([{key:"autofill:mapper",value:h(e.mapper)},{key:"autofill:batch",value:h(e.batch)},{key:"autofill:form:id",value:e.id}],function(){a.mappingsModule.forceMappingUpdate(!0,r.bind(function(){t(e.mapper)},this))})})},switchToReviewMode:function(e,t){e?a.mappingsModule.getMapperDetails(r.bind(function(e){e&&e.is_reviewer?this.clearMapperSettings(function(){s.Preference.createOrModify({key:"mapping:reviewer",value:e.name},function(){t(e.name)})}):t()},this)):this.clearMapperSettings(function(){t("")})}}))({})}),ABINE_DNTME.define("abine/paymentsServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,a,i){var r=n.protocol+n.paymentsServerHost,s=r+"/api/v3/cards",o=r+"/api/v3/cardcredit/client",c=r+"/api/v3/cardfee",l=r+"/api/v3/verify_card_request";return i.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new a.server},getCards:function(e,a){this.server.makeRequest({server:"payment",action:"getCards",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:s,type:"GET"})},createCard:function(e,a){this.server.makeRequest({server:"payments",action:"createCard",defaults:{},required:["request_id","amount","domain","card_use"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:s,type:"POST"})},getCard:function(e,a){this.server.makeRequest({server:"payments",action:"getCard",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:{},url:s+"/"+e,type:"GET"})},updateCard:function(e,a){this.server.makeRequest({server:"payments",action:"updateCard",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:s+"/"+e.card_id,type:"PUT"})},retrieveCardCredit:function(e,a){this.server.makeRequest({server:"payments",action:"retrieveCardCredit",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:o,type:"GET"})},retrieveCardFee:function(e,a){this.server.makeRequest({server:"payments",action:"retrieveCardFee",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:c,type:"GET"})},verifyCardRequest:function(e,a){this.server.makeRequest({server:"payments",action:"verifyCardRequest",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:l,type:"GET"})}})}),ABINE_DNTME.define("abine/phoneServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,a,i){var r=n.protocol+n.phoneServerHost+"/api/v3/shieldedphones";return i.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new a.server},getPhone:function(e,a){this.server.makeRequest({server:"phone",action:"getPhone",defaults:{},required:[],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:r,type:"GET"})},logDisposableFilled:function(e,a){this.server.makeRequest({server:"phone",action:"restorePhone",defaults:{},required:["filled"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:{filled:!0},url:r+"/"+e,type:"PUT"})},restorePhone:function(e,a){this.server.makeRequest({server:"phone",action:"restorePhone",defaults:{},required:["id"],success:function(e){a.call(this,null,e)},error:function(e,t,n){a.call(this,{status:e,errorCode:t,responseJSON:n})},data:e,url:r+"/"+e.id,type:"PUT"})}})}),ABINE_DNTME.define("abine/password",[],function(){function r(e,t){return void 0===t&&(t=e,e=0),Math.floor(Math.random()*(t-e)+e)}function i(e,t,n){for(var a=1;a<=n;a++){var i=r(0,e.length);e=[e.slice(0,i),t[r(t.length)],e.slice(i)].join("")}return e}var s=12,o=1,c=2,l=4,u=8,d="0123456789",f="`~!@#$%^&*()_-+={}|[]\\:\";'<>?,/",h=".-_",p="ABCDEFGHJKLMNOPQRSTUVWXYZ",m=p.toLowerCase();return{generateRandomPassword:function(e,t,n){e=e||m,(!t||t<1)&&(t=s);var a="";return(n=n||o|c|l)&o&&(a=i(a,p,r(2,3))),n&l&&(a=i(a,f,r(1,3))),n&u&&(a=i(a,h,1)),n&c&&(a=i(a,d,r(1,3))),a.length<t&&(a=i(a,e,t-a.length)),a},generateSpecialCharsPassword:function(){return this.generateRandomPassword(null,null,o|c|u)},generateNoSpecialCharsPassword:function(){return this.generateRandomPassword(null,null,o|c)},generateNoDigitsPassword:function(){return this.generateRandomPassword(null,null,o)},generateNewOptionsPassword:function(e,t,n){var a=o;return t&&(a|=c),n&&(a|=l),this.generateRandomPassword(null,e,a)}}}),ABINE_DNTME.define("abine/responseCodes",[],function(){return{UNKNOWN_ERROR:"unknown error",SUCCESS:"successful",ERROR:"error",SERVICE_UNAVAILABLE_ERROR:"service unavailable error",SCHEDULED_DOWNTIME:"scheduled downtime",MISSING_PARAMETERS:"missing parameters",UNAUTHORIZED:"unauthorized bad token",NO_ACCESS_FOR_FEATURE:"no access to requested feature",INVALID_PASSWORD:"invalid password",BIOMETRIC_AUTH_FAILED:"biometric auth failed",ACCOUNT_ALREADY_EXISTS:"account already exists for that email",SAVE_NEW_USER_ERROR:"error saving new user",FAILED_CREATING_TARGET_EMAIL:"failed to create target email",FAILED_TO_UPDATE_USER:"error updating user",NO_ACCOUNT_FOUND_FOR_EMAIL:"no account found for email",ACCOUNT_MARKED_FOR_DELETION:"account has been marked for deletion",ACCOUNT_HAS_BEEN_LOCKED:"account has been locked",ACCOUNT_HAS_BEEN_BANNED:"account has been banned",WRONG_PASSWORD:"wrong password",INVALID_EMAIL_ADDRESS:"invalid email address",NO_RECURLY_ACCOUNT_FOUND:"no recurly account found",MFA_CODE_REQUIRED:"mfa code required",DOWNGRADE_SCHEMA_NOT_ALLOWED:"downgrade of schema_version is not allowed",SAVE_CLIENT_DATA_ERROR:"errors saving client data",DESTROY_CLIENT_DATA_ERROR:"errors destroying client data",NO_CLIENT_DATA_FOUND:"no client data found",USER_EXISTS_FOR_CLIENT_DATA_DELETION:"cannot destroy client data when user exists",UPGRADE_REQUIRED:"upgrade required",PHONE_NOT_FOUND:"phone not found",NO_DISPOSABLE_PHONE:"no disposable phone",FAILED_TO_SAVE_PHONE:"failed to save phone",PHONE_ALREADY_VALIDATED:"phone already validated",NO_NUMBERS_AVAILABLE:"no numbers available",FAILED_TO_SEND_VERIFICATION_CODE:"failed to send verification code",WRONG_VERIFICATION_CODE:"wrong verification code",OLD_PHONE_NOT_FOUND:"old phone not found",COUNTRY_NOT_SUPPORTED:"country not supported",COUNTRY_CHANGE_NOT_SUPPORTED:"country change not supported",ERROR_CREATING_DISPOSABLE:"error creating disposable",MISSING_USER_PARAMS_ERROR_CODE:"missing user params",NO_BILLING_ACCOUNT_FOR_USER_ERROR_CODE:"no billing account for user",REQUEST_ALREADY_EXISTS_ERROR_CODE:"request already exists",NO_CARDS_AVAILABLE_ERROR_CODE:"no cards available",REQUESTED_AMOUNT_OVER_LIMIT_ERROR_CODE:"requested amount over limit",REQUESTED_AMOUNT_BELOW_MINIMUM_ERROR_CODE:"requested amount below minimum",REQUESTED_AMOUNT_INVALID_ERROR_CODE:"requested amount invalid",BILLING_FAILED_ERROR_CODE:"billing failed",BILLING_DECLINED_ERROR_CODE:"billing declined",BILLING_COMPANY_FAILED_ERROR_CODE:"billing company failed",NO_CARD_FOUND_ERROR_CODE:"no card found",NO_BILLING_TRANSACTION_FOUND_ERROR_CODE:"no billing transaction found",FRAUD_SOFT_LIMIT_REACHED:"fraud soft limit",REFUND_FAILED_ERROR_CODE:"refund failed",PROVIDER_CANCEL_FAILED_ERROR_CODE:"provider cancel failed",PROVIDER_READ_FAILED_ERROR_CODE:"provider read failed",PROVIDER_CARD_CREATION_FAILED_ERROR_CODE:"provider card creation failed",FRAUD_HARD_LIMIT_REACHED:"fraud hard limit reached",FRAUD_GLOBAL_BAN:"card creation disabled",CARD_ALREADY_DEACTIVATED_ERROR_CODE:"card already deactivated",FRAUD_VERIFIED_SOFT_LIMIT_REACHED:"fraud verified soft limit",FRAUD_PLATFORM_UNAVAILABLE:"fraud verification unavailable",FRAUD_HIGH_RISK_COUNTRY_ERROR_CODE:"high risk country ban",BILLING_IN_NON_US_ERROR_CODE:"billing in non us",GREY_LISTED_ERROR_CODE:"grey listed user",GLOBAL_SOFT_LIMIT_REACHED:"global soft limit",DUPLICATE_CARD_ERROR_CODE:"duplicate card used ban",REJECTED_DOMAIN_ERROR_CODE:"domains known to not accept masked cards",BANNED_DOMAIN_ERROR_CODE:"banned domain",SPLIT_INTRUSIVE_NON_INTRUSIVE:"7",SPLIT_INTRUSIVE_CONTROL:"8",SPLIT_INTRUSIVE_ALWAYS_REG:"9",SPLIT_INTRUSIVE_GOT_IT_REG:"10",SPLIT_INTRUSIVE_COMPLETE_SETUP_BUTTON:"11",SPLIT_WALLET_OFF:"12",SPLIT_WALLET_ON:"13",SPLIT_ICON_PANELS_CLICK_ICON_FOR_PANEL:"32",SPLIT_ICON_PANELS_SHOW_ICON_WITH_NORMAL_PANELS:"33",SPLIT_ICON_PANELS_NORMAL:"34"}}),ABINE_DNTME.define("abine/saveForms",["documentcloud/underscore","abine/formSubmitDetector","abine/core","storage","persistence","abine/url","abine/securityManager","abine/timer","abine/feedbackLoop"],function(s,e,t,c,r,n,l,u){function o(e,n){if(e.formSignature==n.formSignature)return!0;var a=0,i=0;return s.each(e.fields,function(e,t){t in n.fields?a++:i++}),2<=a&&i<a||1==a&&i<=a}function a(e,t){if(v[t]){if(v[t].timesLoaded=v[t].timesLoaded?v[t].timesLoaded+1:1,4<v[t].timesLoaded||"MaskMe"==v[t].origin&&"loginForm"==v[t].type)return void d(t,"tab account has already been loaded >4 times or origin was autofill");i({tabId:t,formData:v[t],currentDomain:e.domain},!0)}}function d(e,t){t=t||"",delete v[e]}function i(i,a){var r=i.tabId,s=i.currentDomain;if("MaskMe"!=(i=i.formData).origin||"loginForm"!=i.type){var o=v[r];if(o?(i.metrics=o.metrics,i.accountId=i.accountId||o.accountId):o={},o||h(i)){"loginForm"==o.type&&"loginForm"==i.type||"registrationForm"==o.type&&"registrationForm"==i.type?o.domain==i.domain&&(i=p(o,i),(h(o=i)||m(i))&&(a=!0)):i.generated_password&&i.password&&0<i.password.length?a=!0:(h(i)||m(i))&&(a=!0);var e=i.domain;c.Blacklist.findBy("domain",e,function(e){var n=!!e&&e.save_account;c.Preference.findBy("key","rememberAccounts",function(e){if(o.saveRequired||e&&!e.isFalse()&&!n)if(o.saveRequired){if(b(i),d(r,"form submit saveRequired was true - autosaved"),!i.username&&!i.email&&i.generated_password&&i.password&&0<i.password.length){var t={type:"password_with_no_login",account:i,neverFade:!0,panelWidth:420,locked:l.isLocked()};_[r]=t}}else if(a)if(h(i)||m(i))y(i,function(e){var t=function(e,t){return e.email&&0<e.email.length&&t.email&&0<t.email.length&&e.email!=t.email};if(!e||function(e,t){return e.username&&0<e.username.length&&t.username&&0<t.username.length&&e.username!=t.username}(e,i)||t(e,i))c.Preference.findBy("key","promptWhenSavingAccounts",function(e){if(l.isLocked()||e&&e.isTrue()){var t={type:"login",account:i,neverFade:!0,panelWidth:420,locked:l.isLocked()};_[r]=t}else b(i),d(r,"formSubmit promptWhenSaving is off - autosaved")});else if(e.password!=i.password)if(e.password&&0<e.password.length){var n={type:"change_password",account:i,neverFade:!0,panelWidth:420,locked:l.isLocked()};_[r]=n}else b(i);if(_[r]){n=_[r];u.clearTimeout(E[r]);var a=u.setTimeout(function(){if(r in E)f(r);else for(r in _)return void w.messenger.send("background:saveForm:notification",n,r)},4e3);E[r]=a}}),d(r,"form submit created save notification already");else if(!i.username&&!i.email&&i.generated_password&&i.password&&0<i.password.length){t={type:"password_with_no_login",account:i,neverFade:!0,panelWidth:420,locked:l.isLocked()};_[r]=t}else o.domain!=s&&d(r,"domain has changed on tab")})})}}else k[r]=i}function f(e){u.clearTimeout(E[e]),delete E[e];var t=_[e];t&&w.messenger.send("background:saveForm:notification",t,e)}function h(e){var t=e.email&&0<e.email.length,n=e.password&&0<e.password.length,a=e.username&&0<e.username.length;return n&&(t||a)||n&&e.generated_password}function p(e,t){return t.username=t.username||e.username,t.email=t.email||e.email,t.password=t.password||e.password,t}function m(e){return"changePasswordForm"==e.type&&e.password&&0<e.password.length&&e.oldpassword&&0<e.oldpassword.length}function g(e){var t=v[e.tabId]||{};if(t.saveInProgress)u.setTimeout(function(){g(e)},100);else if(e.formData.email&&"mapping-update@abine.com"==e.formData.email)ABINE_DNTME.require(["modules"],function(e){e.mappingsModule.forceMappingUpdate(function(){w.messenger.send("background:dntme:show")})});else{
t&&t.id!=e.formData.id&&t.saveRequired&&h(t)&&(b(t),d(e.tabId,"processFieldSubmit tabaccount and form data id is different and saveRequired and account is complete - autosaved"),t={});var n=!1,a=e.fieldData.origin,i=e.fieldData.dataType&&e.fieldData.dataType.match(/phone/);(t.saveRequired||a&&a.match(/disposable|primary|strong/i)&&!i)&&(n=!0);var r=t.metrics||{},s=t.accountId;("loginForm"==t.type&&"loginForm"==e.formData.type||"registrationForm"==t.type&&"registrationForm"==e.formData.type)&&t.domain==e.formData.domain&&(e.formData=p(t,e.formData)),t=e.formData,(s||e.fieldData.accountId)&&(t.accountId=e.fieldData.accountId||s),t.saveRequired=n,t.metrics=r,v[e.tabId]=t,n&&h(t)&&(b(t),d(e.tabId,"processFieldSubmit saverequired and account complete"))}}function y(n,a){var t=n.accountId||n.id;c.Account.findBy("id",t,function(e){e?a(e):c.CompanyAccount.findBy("id",t,function(e){if(e)a(e);else{var t=function(e){return n.domain==e.domain&&(n.email&&0<n.email.length&&(e.email==n.email||e.username==n.email)||n.username&&0<n.username.length&&(e.username==n.username||e.email==n.username)||n.oldpassword&&0<n.oldpassword.length&&e.password==n.oldpassword)};c.Account.listCached(t,function(e){0==e.length?c.CompanyAccount.listCached(t,function(e){0==e.length?a(null):a(e[0])}):a(e[0])})}})})}function b(i){(i.email||i.username||i.password)&&c.Blacklist.findBy("domain",i.domain,function(e){var n=!!e&&e.save_account;c.Preference.findBy("key","rememberAccounts",function(e){function t(e){e.domain=i.domain,e.page_host=i.page_host,e.form_host=i.form_host,e.protocol=i.protocol,"changePasswordForm"==i.type||(i.email&&0<i.email.length&&(e.email=i.email),i.username&&0<i.username.length&&(e.username=i.username),i.login_url&&0<i.login_url.length&&(e.login_url=i.login_url),e.times_used=e.times_used||0),i.password&&0<i.password.length&&(e.password=i.password),e.pushed=0,e.modifiedAt=new Date,e.userModifiedAt=e.modifiedAt,e.beforeSave(),r.flush(),r.removeIndex(e),r.addIndex(e);var t=i.metrics||{};for(var n in t)c.PanelActivity[n]({payload:{panelId:7000005,revert:!0}});i.metrics={};var a=i.email&&(i.generated_email||-1!=i.email.indexOf(ABINE_DNTME.config.disposableDomain));for(var n in i.generated_password&&a?i.metrics.addMasked=!0:i.generated_password?i.metrics.addClosed=!0:a?i.metrics.addImpression=!0:i.metrics.addDisclosed=!0,i.metrics)c.PanelActivity[n]({payload:{panelId:7000005}});delete i.saveInProgress}!e||e.isFalse()||n||(i.saveInProgress=!0,y(i,function(e){e||((e=new c.Account({id:i.id})).createdAt=new Date,e.email=e.password=e.username=e.login_url="",r.add(e)),t(e)}))})})}var v={},_={},E={},k={},T=function(e){"Safari"==ABINE_DNTME.config.browser&&e.match(/^ABPS-[0-9]+-[0-9]+$/)&&(e=e.replace(/-[0-9]+$/,"").replace("ABPS","ABCS")),u.clearTimeout(E[e]),delete _[e],delete E[e]},w=new(t.BaseClass.extend({init:function(e){this.messenger=e,this.messenger.on("contentScript:init",function(t,n){t.previous&&[v,_,E,k].forEach(function(e){e[t.previous]&&(e[n]=e[t.previous],delete e[t.previous])})}),this.messenger.on("contentManager:init",a),this.messenger.on("contentManager:reinit",a),this.messenger.on("contentManager:formsInitialized",function(e,t){var n=_[t];if(n){var a=n.account,i=e.hasLogin;"loginForm"!=a.type?f(t):"password_with_no_login"!=n.type?(i?a.timesLoaded=a.timesLoaded?a.timesLoaded-1:null:s.each(e.forms,function(e){!i&&"loginForm"==e.type&&e.visible&&o(e,a)&&e.id!=a.id&&(a.timesLoaded=a.timesLoaded?a.timesLoaded-1:null,i=!0)}),i?T(t):f(t)):f(t)}else if(k[t]){i=!1;if(s.each(e.forms,function(e){!i&&"loginForm"==e.type&&e.visible&&o(e,k[t])&&e.id!=k[t].id&&(i=!0)}),i){var r={type:"failed_login",account:k[t],neverFade:!0,panelWidth:420,locked:l.isLocked()};w.messenger.send("background:saveForm:notification",r,t)}}delete k[t]}),this.messenger.on("background:notification:clear",function(e,t){T(t)}),this.messenger.on("background:save:account",function(e,t){T(t),e.pageUrl&&e.pageUrl.match(/^http[s]?:\/\//i)&&(e.login_url=e.pageUrl),b(e),e.alwaysSaveAccounts&&c.Preference.createOrModify({key:"promptWhenSavingAccounts",value:e.alwaysSaveAccounts?"false":"true"})}),this.messenger.on("background:save:or:update:account",function(i,r){y(i,function(e){if(!e)return T(r),i.pageUrl&&i.pageUrl.match(/^http[s]?:\/\//i)&&(i.login_url=i.pageUrl),void b(i);if(!e.isCompanyAccount){var t,n=i;if(e.password!=n.password&&(e.password&&0<e.password.length?t="change_password":b(n)),t){var a={type:t,account:n,neverFade:!0,panelWidth:420,locked:l.isLocked()};w.messenger.send("background:saveForm:notification",a,r)}}})})}}));return e.formSubmitDetector.on("background:formSubmit",i),e.formSubmitDetector.on("background:formFieldChanged",g),w}),ABINE_DNTME.define("abine/savePaymentForms",["documentcloud/underscore","abine/formSubmitDetector","abine/core","storage","persistence","abine/url","abine/securityManager","abine/timer"],function(s,e,t,o,r,n,c,l){function i(e){for(var t=0,n=!1,a=e.length-1;0<=a;){var i=parseInt(e.charAt(a));n&&9<(i*=2)&&(i-=9),t+=i,a--,n=!n}return t%10==0}function u(e,n){if(e.formSignature==n.formSignature)return!0;var a=0,i=0;return s.each(e.fields,function(e,t){t in n.fields?a++:i++}),3<=a&&i<a}function a(e,t){var n=v[t];n&&y(n,function(e){e&&"DisposableCards"==e._type&&(n.card=e,E[t]=n),h({tabId:t,formData:n},!0)})}function d(e,t){var n={msg:"",targetUrl:ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost+"/#/cards",targetId:"",model:{maskedCard:e.card.toJSON(),declined:{title:"Masked Card Declined?"}},height:260,type:"card",neverFade:!0,locked:c.isLocked()};w.messenger.send("background:show:notification",n,t)}function f(e,t){t=t||"",delete v[e]}function h(a,n){var i=a.tabId;a=a.formData||a;var r=v[i];if(r?(a.metrics=r.metrics,a.cardId=a.cardId||r.cardId,s.each(["expiry_month","expiry_year","number","cvc","issuedto"],function(e){v[i][e]=a[e]||v[i][e]})):(r={},v[i]=a),!r.card_type&&r.number&&(r.card_type=o.RealCard.detectCardType(r.number)),!r.styles&&r.card_type&&(r.brand="generic",r.styles=o.RealCard.getCardStyles(r.card_type,r.brand)),r||m(a)){var e=a.domain;o.Blacklist.findBy("domain",e,function(e){var t=!!e&&e.save_card;o.Preference.findBy("key","rememberCards",function(e){(r.saveRequired||e&&!e.isFalse()&&!t)&&(r.saveRequired?(b(a),f(i,"form submit saveRequired was true - autosaved")):n&&(m(a)?(y(a,function(e){if(e||o.Preference.findBy("key","promptWhenSavingCards",function(e){if(c.isLocked()||e&&e.isTrue()){var t={type:"save_card",card:a,neverFade:!0,panelWidth:420,locked:c.isLocked()};_[i]=t}else b(a),f(i,"formSubmit promptWhenSaving is off - autosaved")}),_[i]){var t=_[i];l.clearTimeout(k[i]);var n=l.setTimeout(function(){if(i in _)p(i);else for(i in _)return void w.messenger.send("background:saveForm:notification",t,i)},4e3);k[i]=n}}),f(i,"form submit created save notification already")):f(i,"card not complete")))})})}}function p(e){l.clearTimeout(k[e]),delete k[e];var t=_[e];t&&w.messenger.send("background:saveForm:notification",t,e)}function m(e){var t=e.number&&0<e.number.length&&i(e.number),n=e.expiry_month&&0<e.expiry_month.length,a=e.expiry_year&&0<e.expiry_year.length;return t&&n&&a}function g(t){var n=v[t.tabId]||{};if(n.saveInProgress)l.setTimeout(function(){g(t)},100);else{n&&n.id!=t.formData.id&&n.saveRequired&&m(n)&&(b(n),f(t.tabId,"processFieldSubmit tabcard and form data id is different and saveRequired and card is complete - autosaved"),n={});var a=!1;n.saveRequired&&(a=!0);var e=n.metrics||{},i=n.cardId;n=t.formData,(i||t.fieldData.cardId)&&(n.cardId=t.fieldData.cardId||i),n.saveRequired=a,n.metrics=e,(v[t.tabId]=n).card_type=o.RealCard.detectCardType(n.number),n.brand="generic",n.styles=o.RealCard.getCardStyles(n.card_type,n.brand),o.RealCard.detectCardBrand(n.number,function(e){n.brand=e,n.styles=o.RealCard.getCardStyles(n.card_type,n.brand),a&&m(n)&&(b(n),f(t.tabId,"processFieldSubmit saverequired and card complete"))})}}function y(n,a){var t=n.cardId||n.id;o.RealCard.findBy("id",t,function(e){e?a(e):o.DisposableCard.findBy("id",t,function(e){if(e)a(e);else{var t=function(e){return n.number==e.number};o.RealCard.listCached(t,function(e){0==e.length?o.DisposableCard.listCached(t,function(e){0==e.length?a(null):a(e[0])}):a(e[0])})}})})}function b(i){o.Blacklist.findBy("domain",i.domain,function(e){var n=!!e&&e.save_card;o.Preference.findBy("key","rememberCards",function(e){function t(e){if(e.domain=i.domain,i.number&&0<i.number.length&&(e.number=i.number),i.cvc&&0<i.cvc.length&&(e.cvc=i.cvc),i.expiry_month&&0<i.expiry_month.length&&(e.expiry_month=i.expiry_month),i.expiry_year&&0<i.expiry_year.length&&(e.expiry_year=i.expiry_year),i.issuedto&&0<i.issuedto.length){var t=i.issuedto.split(" ");e.first_name=t[0],2<=t.length&&(e.last_name=t[1])}e.detectCardType(),e.label=e.type.substr(0,1).toUpperCase()+e.type.replace(/[^a-z]+/g," ").substr(1)+" "+e.number.substr(-4),e.pushed=0,e.modifiedAt=new Date,r.flush();var n=i.metrics||{};for(var a in n)o.PanelActivity[a]({payload:{panelId:8000091,revert:!0}});for(var a in i.metrics={},i.metrics.addImpression=!0,i.metrics)o.PanelActivity[a]({payload:{panelId:8000091}});delete i.saveInProgress}!e||e.isFalse()||n||(i.saveInProgress=!0,y(i,function(e){e||((e=new o.RealCard({id:i.id})).createdAt=new Date,e.number=e.first_name=e.last_name=e.expiry_month=e.expiry_year=e.cvc="",r.add(e)),t(e)}))})})}var v={},_={},E={},k={},T=function(e){"Safari"==ABINE_DNTME.config.browser&&e.match(/^ABPS-[0-9]+-[0-9]+$/)&&(e=e.replace(/-[0-9]+$/,"").replace("ABPS","ABCS")),l.clearTimeout(k[e]),delete _[e],delete k[e]},w=new(t.BaseClass.extend({init:function(e){this.messenger=e,this.messenger.on("contentScript:init",function(t,n){t.previous&&[v,_,k,E].forEach(function(e){e[t.previous]&&(e[n]=e[t.previous],delete e[t.previous])})}),this.messenger.on("contentManager:init",a),this.messenger.on("contentManager:reinit",a),this.messenger.on("contentManager:formsInitialized",function(e,t){if(E[t]){var n=E[t],a=!1;return s.each(e.forms,function(e){!a&&u(e,n)&&(a=!0)}),a&&d(n,t),void delete E[t]}var i=_[t];if(i){n=i.card,a=!1;s.each(e.forms,function(e){!a&&u(e,n)&&(a=!0)}),a?(l.clearTimeout(k[t]),T(t),f(t,"form submit failed")):p(t)}}),this.messenger.on("background:notification:clear",function(e,t){T(t)}),this.messenger.on("background:save:card",function(e,t){T(t),b(e),"alwaysSaveCards"in e&&o.Preference.createOrModify({key:"promptWhenSavingCards",value:e.alwaysSaveCards?"false":"true"})}),this.messenger.on("background:save:or:update:card",function(t,n){y(t,function(e){e||(T(n),b(t))})})}}));return e.formSubmitDetector.on("background:formSubmit",h),e.formSubmitDetector.on("background:formPaymentFieldChanged",g),w}),ABINE_DNTME.define("abine/feedbackLoop",["documentcloud/underscore","abine/formSubmitDetector","abine/core","storage","persistence","abine/url","abine/securityManager"],function(l,e,t,u,n,a,d){function o(e,t,n){if(n&&(e[t]||(e[t]=[]),0<(n=(n+"").toLowerCase().replace(/\s/gi,"")).length)){var a="(^"+n+"$)";-1==e[t].indexOf(a)&&e[t].push(a)}}function i(e,t){10==t.length&&(o(e,"/contact/phone/areacode",t.substr(0,3)),o(e,"/contact/phone/exchange",t.substr(3,3)),o(e,"/contact/phone/local",t.substr(6,4)))}function r(e,t){16==t.length&&(o(e,"/financial/creditcard/number/part1",t.substr(0,4)),o(e,"/financial/creditcard/number/part2",t.substr(4,4)),o(e,"/financial/creditcard/number/part3",t.substr(8,4)),o(e,"/financial/creditcard/number/part4",t.substr(12,4)))}function s(e,t){2==t.length&&A[t]&&o(e,"/contact/state",A[t])}function c(e,t){2==t.length&&w[t]&&o(e,"/contact/country",w[t])}function f(i,e,r){var s=/createdAt|label|modifiedAt|pushed|address_id|brand|auth_token|is_validated|pushVersion|rails_id/gi;e.forEach(function(e){for(var t in e._data)if(!t.match(s)){var n=_[r+"-"+t],a=e._data[t];o(i,n,a),E[n]&&a&&E[n](i,a)}})}function h(a,e){!b||e?(b={},u.Address.index(null,function(e){f(b,e,"address"),u.RealCard.index(null,function(e){f(b,e,"card"),u.ShieldedPhone.index(null,function(e){f(b,e,"phone");var t=[];for(var n in b)t.push(b[n].join("|")),b[n]=new RegExp(b[n].join("|"));v=new RegExp(t.join("|")),a()})})})):a()}function p(e){if(!e)return null;var t=null;if(0<(e=e.toLowerCase().replace(/\s/gi,"")).length&&e.match(v))for(var n in b)if(e.match(b[n])){t=n;break}return t}function m(e,t){return e?t&&0==t.indexOf("/password")?"**********":e.replace(/[a-z]/gi,"a").replace(/[0-9]/g,"d").replace(/[^aAd@]/g,"x").substr(0,50):e}function g(e,t){var n=m(e.value,e.dataType),a=p(e.value);return{className:e.className,dataType:e.dataType,detectedType:e.detectedType,mappedType:e.mappedType,fieldType:e.fieldType,fieldId:e.id,label:e.label,maxlength:e.maxlength,name:e.name,position:e.position,signature:e.signature,size:e.size,hidden:e.hidden,rule_locale:e.matchedLocale,maskedValue:n,matchedDataType:a,formId:t.id}}function y(c){c.formData.type&&c.formData.type.match(/checkout|login|regist|change|address/)&&u.Preference.findBy("key","shouldSendErrorReports",l.bind(function(e){e&&!e.isTrue()||h(function(){var e=c.fieldData.value,n=!1;if(e&&e.length<=50){var a=[],i=!1,r=null,t=c.formData,s=c.checkoutButtons,o={domain:t.domain,formSignature:t.formSignature,formHost:t.form_host,formId:t.id,fieldCount:t.allFields.length,pageHost:t.page_host,formType:t.type,language:t.language,registered:null!=d.getUserId(),premium:d.isPremium(),local_mapping:t.local_mapping,mappedFormType:t.mappedFormType,detected_locales:t.detectedLocales,formless_depth:t.formlessDepth,tag_name:t.tagName,pageUrl:null,amex:s.amex,amazon:s.amazon,master:s.master,visa:s.visa,paypal:s.paypal,chase:s.chase};l.each(c.formData.allFields,function(e){e.dataType&&e.dataType.match(k)&&(n=!0);var t=g(e,c.formData);a.push(t),t.matchedDataType&&(i=!0),r||e.signature!=c.fieldData.signature||((r=t).fillType=c.fieldData.blurFilled?1:2)}),!i&&n||u.FieldData.createLocal({payload:r,allFields:a,form:o},function(){})}})},this))}var b=null,v=null,_={"address-address1":"/contact/postaladdress","address-address2":"/contact/postaladdressAdditional","address-city":"/contact/city","address-country":"/contact/country","address-state":"/contact/state","address-zip":"/contact/postalcode","card-cvc":"/financial/creditcard/verification","card-expiry_month":"/financial/creditcard/expirymonth","card-expiry_year":"/financial/creditcard/expiryyear","card-first_name":"/financial/creditcard/issuedto/first","card-last_name":"/financial/creditcard/issuedto/last","card-number":"/financial/creditcard/number","card-type":"/financial/creditcard/type","phone-country_code":"/contact/phone/countrycode","phone-number":"/contact/phone"},E={"/financial/creditcard/number":r,"/contact/phone":i,"/contact/state":s,"/contact/country":c},k=/search|subject|message/i;d.on("background:securityManager:locked",function(){v=b=null});var T=l.debounce(function(){h(function(){},!0)});d.on("entity:changed:RealCard",T),d.on("entity:changed:Address",T),e.formSubmitDetector.on("background:formFieldChanged:processMapping",y);var w={AF:"Afghanistan",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AC:"Ascension Island",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",BQ:"British Antarctic Territory",IO:"British Indian Ocean Territory",VG:"British Virgin Islands",BN:"Brunei",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",IC:"Canary Islands",CT:"Canton and Enderbury Islands",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",EA:"Ceuta and Melilla",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CP:"Clipperton Island",CC:"Cocos [Keeling] Islands",CO:"Colombia",KM:"Comoros",CD:"Congo [DRC]",CK:"Cook Islands",CR:"Costa Rica",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DG:"Diego Garcia",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",NQ:"Dronning Maud Land",TL:"East Timor",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands [Islas Malvinas]",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",FQ:"French Southern and Antarctic Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Islands",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JT:"Johnston Island",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Laos",LV:"Latvia",LS:"Lesotho",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macau",MK:"Macedonia [FYROM]",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",FX:"Metropolitan France",MX:"Mexico",FM:"Micronesia",MI:"Midway Islands",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NT:"Neutral Zone",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",VD:"North Vietnam",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",QO:"Outlying Oceania",PC:"Pacific Islands Trust Territory",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territories",PA:"Panama",PZ:"Panama Canal Zone",PY:"Paraguay",YD:"People's Democratic Republic of Yemen",PE:"Peru",PH:"Philippines",PN:"Pitcairn Islands",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RO:"Romania",RU:"Russia",RW:"Rwanda",RE:"R&eacute;union",BL:"Saint Barth&eacute;lemy",SH:"Saint Helena",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",CS:"Serbia and Montenegro",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",KR:"South Korea",ES:"Spain",LK:"Sri Lanka",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",ST:"S&atilde;o Tom&eacute; and Pr&iacute;ncipe",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TA:"Tristan da Cunha",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UM:"U.S. Minor Outlying Islands",PU:"U.S. Miscellaneous Pacific Islands",VI:"U.S. Virgin Islands",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VA:"Vatican City",VE:"Venezuela",VN:"Vietnam",WK:"Wake Island",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",AX:"&Aring;land Islands"},A={AK:"Alaska",AL:"Alabama",AP:"Armed Forces Pacific",AR:"Arkansas",AS:"American Samoa",AZ:"Arizona",CA:"California",CO:"Colorado",CT:"Connecticut",DC:"District of Columbia",DE:"Delaware",FL:"Florida",FM:"Federated States of Micronesia",GA:"Georgia",GU:"Guam",HI:"Hawaii",IA:"Iowa",ID:"Idaho",IL:"Illinois",IN:"Indiana",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",MA:"Massachusetts",MD:"Maryland",ME:"Maine",MH:"Marshall Islands",MI:"Michigan",MN:"Minnesota",MO:"Missouri",MP:"Northern Mariana Islands",MS:"Mississippi",MT:"Montana",NC:"North Carolina",ND:"North Dakota",NE:"Nebraska",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NV:"Nevada",NY:"New York",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",PR:"Puerto Rico",PW:"Palau",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VA:"Virginia",VI:"Virgin Islands",VT:"Vermont",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"};return{}}),ABINE_DNTME.define("abine/securityManager",["documentcloud/underscore","abine/core","storage","persistence","abine/timer","abine/config","abine/window","abine/localStorage","abine/crypto"],function(l,e,u,d,t,n,i,a,r){function s(e,t){t=t||v,ABINE_DNTME.require(["abine/memoryStore"],function(e){e.set("login-panel-ignored",0),e.set("login-panel-closed",null)}),_.refreshData(function(){_.messenger.broadcastToAllTabs("background:securityManager:unlocked",{}),_.trigger("background:securityManager:unlocked",e),t(null,e)})}var o=!0,c=!1,f=null,h=null,p=!1,m=null,g=null,y=null,b=null,v=function(){},_=new(e.BaseClass.extend({initialize:function(){},load:function(e){e&&(this.messenger=e,this.messenger.on("biometric:auth",l.bind(this.biometricCardAuth,this)),this.messenger.on("password:auth",l.bind(this.passwordCardAuth,this)));var a=function(){p=!0;var e=function(){_.trigger("background:securityManager:initialized")};o||s(),e()},i=this;u.Preference.findBy("key","authToken",function(n){u.Preference.findBy("key","key",function(t){u.Preference.findBy("key","ckey",function(e){n&&""!=n.value?(o=!(c=!0),f=n.value,i.setEncryptionKey(t?t.value:null,e?e.value:null,a)):(c=!(o=!0),h=f=null,i.setEncryptionKey(null,a))})})})},getUserId:function(){return y},setUserId:function(e){y=e},getCompanyEncryptionKey:function(){return g},getAuthToken:function(){return f},getEncryptionKey:function(){return m},isPremium:function(){return"premium"==h},setEncryptionKey:function(e,t,n){function a(){u.Account.clearCache(function(){u.Address.clearCache(function(){u.Note.clearCache(function(){u.AccountHistory.clearCache(function(){u.RealCard.clearCache(function(){u.CompanyAccount.clearCache(function(){u.EmailDomain.clearCache(function(){n()})})})})})})})}if(n=n||v,e&&""!=e&&"undefined"!=e){if(m!=e||g!=t)return m=e,g=t,void u.Preference.createOrModify({key:"key",value:e},function(){u.Preference.createOrModify({key:"ckey",value:t},function(){a()})})}else if(null!=m)return g=m=b=null,void a();n()},__setUserIdAndKey:function(e,t){y=e,m=t&&""!=t&&"undefined"!=t?t:null},getAuthToken:function(){return f},setAuthToken:function(t,n,a,i){i=i||v;var r=t&&0<t.length;u.Preference.createOrModify({key:"lastActivity",value:Date.now()},l.bind(function(){u.Preference.findBy("key","authToken",l.bind(function(e){e&&e.value==t&&t==f?this.setEncryptionKey(n,a,function(){r&&_.refreshData(i)}):(d.reset(),this.setEncryptionKey(n,a,l.bind(function(){u.Preference.findBy("key","hasRegistered",l.bind(function(e){u.Preference.batchCreateOrModify([{key:"authToken",value:t},{key:"key",value:n},{key:"ckey",value:a},{key:"oldHasRegistered",value:e?e.value:"false"},{key:"hasRegistered",value:r?"true":"false"}],l.bind(function(){t&&""!=t?(ABINE_DNTME._started=!0,c=!(o=!1),f=t,s(null,i)):(u.Preference.removeByKey("altEmail1"),u.Preference.removeByKey("altEmail2"),u.Preference.createOrModify({key:"userTag",value:""}),u.Preference.findBy("key","dynamicTag",function(e){e&&e.value&&ABINE_DNTME.config.updateTag(e.value)}),o=!0,f=y=null,ABINE_DNTME.require(["abine/memoryStore"],function(e){e.set("biometricKeyToken",null)}),ABINE_DNTME.require(["abine/blurstore-api"],function(e){e.disconnect()}),ABINE_DNTME.require(["abine/pushNotifications"],function(e){e.disconnect()}),u.Preference.retainDefaults(l.bind(function(){this.messenger.broadcastToAllTabs("broadcast:preference:reload",{}),this.messenger.broadcastToAllTabs("background:securityManager:locked",{}),_.trigger("background:securityManager:locked"),i()},this)))},this))},this))},this)))},this))},this))},login:function(){i.reloadTab({url:ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost})},logout:function(){this.setAuthToken(null,null)},openPage:function(e,t,n){if(!0===t){var a="";e.match(/[&\?]$/)||(a="&"),a+="v="+ABINE_DNTME.config.version,e+=a+="&tag="+ABINE_DNTME.config.tags[0]}else t&&(ABINE_DNTME.lastPanel||(ABINE_DNTME.lastPanel={}),ABINE_DNTME.lastPanel[t.action]=t.id);0!==e.indexOf("http")&&(e.match(/^\//)||(e="/"+e),e=ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost+e),i.createTab({url:e,doNotActivate:1==n,doNotOpenNewTab:1==n})},passwordCardAuth:function(t,n){var a=this;ABINE_DNTME.require(["modules"],function(e){e.licenseModule.passwordCardAuth(t,function(e){a.messenger.send(t.responseId,e,n)})})},biometricCardAuth:function(t,n){var a=this;ABINE_DNTME.require(["abine/pushNotifications"],function(e){e.biometricAuthCancel(),e.requestBiometricAuth(t.type||"card",t.key,t.domain,t.amount,t.number,t.account,function(e){a.messenger.send(t.responseId,e,n)})})},openPostInstall:function(){u.Preference.findBy("key","postInstallUrl",l.bind(function(e){e&&e.value&&this.openPage(e.value)},this))},openWindow:function(e,t,n){i.openWindow(e,t,n)},openLink:function(e){this.getLink(e,function(e){i.createTab({url:e})})},getLink:function(i,r){i.lang="en",i.v=ABINE_DNTME.config.version,u.Preference.batchFindBy([{by:"key",value:"installVersion"},{by:"key",value:"installDate"}],function(e){if(e.installVersion&&(i.ov=e.installVersion.value),e.installDate){var t=new Date(parseInt(e.installDate.value));i.cohort=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}i.o=ABINE_DNTME.config.tags[0];var n="";for(var a in i)n+=""==n?"?":"&",n+=encodeURIComponent(a)+"="+encodeURIComponent(i[a]);r("http://donottrackplus.com/link.php"+n)})},isLocked:function(){return o},hasPassword:function(){return c},isInitialized:function(){return p},isMaskmeInstalled:function(){return ABINE_DNTME.maskme_installed},refreshRules:function(){ABINE_DNTME.require(["abine/dntmeInit"],function(e){e.updateRules()})},afterRefresh:function(e){this._refreshInProgress?this._refreshCallbacks.push(e):e()},getBillingManager:function(){return b},getAnonymousId:function(){var e=a.getItem("anonymousId");return e||(e=r.sha1(d.createUUID()),a.setItem("anonymousId",e)),e},refreshData:function(e,t){function c(){function e(){l.each(n._refreshCallbacks,function(e){try{e()}catch(t){}}),delete n._refreshCallbacks,delete n._refreshInProgress}g&&""!=g?(u.Preference.createOrModify({key:"hasCompanyKey",value:"true"}),u.EmailDomain.fetchFromServer(function(){u.CompanyAccount.fetchFromServer(e)})):(u.Preference.createOrModify({key:"hasCompanyKey",value:"false"}),u.EmailDomain.fetchFromServer(function(){e()})),u.Preference.findBy("key","hasEnabledPayments",function(e){e&&"true"==e.value&&u.DisposableCard.getAllCards({})})}if(ABINE_DNTME.require(["abine/pushNotifications"],function(e){e.connect()}),e&&!0!==e&&(t=e,e=!1),t=t||v,this._refreshInProgress)this._refreshCallbacks.push(t);else{this._refreshCallbacks=[t],this._refreshInProgress=!0;var n=this;ABINE_DNTME.require(["modules","abine/modules/mappings","abine/modules/panels"],function(s){function t(a){u.Preference.batchFindBy([{by:"key",value:"oldHasRegistered"},{by:"key",value:"hasRegistered"},{by:"key",value:"hasEnabledPayments"},{by:"key",value:"entitledToPhone"}],l.bind(function(e){var t="unregistered",n=!1;e.oldHasRegistered&&(d.remove(e.oldHasRegistered),e.hasRegistered=e.oldHasRegistered),e.hasRegistered&&e.hasRegistered.isTrue()&&(e.entitledToPhone&&e.entitledToPhone.isTrue()?(t="premium",e.hasEnabledPayments&&e.hasEnabledPayments.isTrue()&&(n=!0)):t="registered"),a(t,n)},this))}function o(){}t(l.bind(function(i,r){u.Preference.retainDefaults(function(){s.licenseModule.refreshEntitlements(function(e,a){u.ShieldedEmail.cached=!0,_.setUserId(null),e?(o(),c()):(_.setUserId(a.user.id),ABINE_DNTME.setupUninstallUrl(),u.Preference.findBy("key","dynamicTag",function(){u.Preference.createOrModify({key:"userTag",value:a.user.tag||""}),a.user.tag&&ABINE_DNTME.config.updateTag(a.user.tag)}),u.Preference.createOrModify({key:"has_mobile",value:a.user.first_phone_use_date||a.user.first_tablet_use_date?"true":"false"}),u.Preference.createOrModify({key:"sync_store_manager",value:a.user.sync_store_manager}),u.Preference.createOrModify({key:"masked_card_auth",value:a.user.masked_card_auth?a.user.masked_card_auth:"none"}),u.Preference.createOrModify({key:"biometric_type",value:a.user.biometric_type?a.user.biometric_type:""}),a.user.company&&a.user.company.has_cards?u.Preference.createOrModify({key:"hasCompanyCards",value:"true"}):u.Preference.removeByKey("hasCompanyCards"),b=a.user.billing_manager,u.clearAllCache(a.user.sync_store_manager,l.bind(function(){t(l.bind(function(e,t){h=e;var n=[];"unregistered"==i&&"unregistered"!=e&&n.push("open_registration_page"),"premium"!=i&&"premium"==e&&(n.push("open_plans_page"),n.push("open_snowman_page")),!r&&t&&n.push("open_activate_cards_page"),l.async.forEach(n,function(e,t){s.panelsModule.panelConversionCheck(e,t)},o),u.ShieldedEmail.findBy("email",a.user.email,function(e){e&&d.remove(e),u.Preference.createOrModify({key:"oldEmail",value:a.user.email}),a.user.alternate_email1?u.Preference.createOrModify({key:"altEmail1",value:a.user.alternate_email1}):u.Preference.removeByKey("altEmail1"),a.user.alternate_email2?u.Preference.createOrModify({key:"altEmail2",value:a.user.alternate_email2}):u.Preference.removeByKey("altEmail2"),e=new u.ShieldedEmail({email:a.user.email,first_name:a.user.first_name,last_name:a.user.last_name}),d.add(e),u.Preference.findBy("key","loginNotLock",function(e){e&&d.remove(e),u.DisposableEmail.indexFromServer(null,function(){u.Preference.findBy("key","entitledToPhone",function(e){e&&!e.isFalse()?s.phoneModule.getPhone(null,function(e,t){if(u.ShieldedPhone.cached=!0,!e&&t.shielded_phone){var a=t.shielded_phone;u.ShieldedPhone.findBy("number",a.number,function(t){if(t&&d.remove(t),t=new u.ShieldedPhone({country_code:a.country_code,number:a.number,is_validated:a.is_validated?"true":"false",rails_id:a.id}),d.add(t),0<a.disposable_phones.length){var n=a.disposable_phones[0];u.DisposablePhone.findBy("number",n.number,function(e){e&&d.remove(e),e=new u.DisposablePhone({country_code:n.country_code,number:n.number,released:n.released,rails_id:n.id,shielded_phone_id:t.id}),d.add(e),c()})}else c()})}else c()}):c()})})})})},this))},this)))})})},this))})}}}));return _}),ABINE_DNTME.define("abine/server",["documentcloud/underscore","abine/ajax","abine/config","storage","abine/core","abine/responseCodes","abine/window","persistence","abine/timer","abine/securityManager","abine/localStorage"],function(a,t,i,e,n,c,r,s,o,l,u){function d(){for(var e=[],t="0123456789ABCDEF",n=0;n<32;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[12]="4",e[16]=t.substr(3&e[16]|8,1),e.join("")}var f=function(){},h=function(i,r){i.skip_auth_token?r.call(this,i):e.Preference.findBy("key","authToken",function(a){e.Preference.findBy("key","installAuthToken",function(e){var t=!a||a.isEmpty()?null:a.value,n=!e||e.isEmpty()?null:e.value;t&&(i.data.auth_token=t),n&&(i.data.install_auth_token=n),r.call(this,i)})})},p=function(e){if(!e.skip_ca){var t=e.data,n=i.version;ABINE_DNTME.dntme_upgrade&&!ABINE_DNTME.merged_data_available&&(n="dnt2-"+n),t.client_application.version=n,t.client_application.environment=i.environment,t.client_application.tag=i.tags[0],t.client_application.browser=i.browser,t.client_application.build_num=i.buildNum,t.client_application.user_agent=ABINE_DNTME.userAgent,t.client_application.product="DNT3",t.client_application.device="Extension";var a=u.getItem("device_id");a||(a=d(),u.setItem("device_id",""+a)),t.client_application.device_id=a}},m=n.BaseClass.extend({makeRequest:function(r){r.defaults=r.defaults||{},r.required=r.required||[],r.data=a.defaults(r.data||{},r.defaults),r.type=r.type||"POST",r.dataType=r.dataType||"json";var s=r.success||f,o=r.error||f;if(r.data.client_application||(r.data.client_application={}),r.success=a.bind(function(e,t,n){var a=n.status;if(r.raw)var i=e;else i=e.data;r.raw||"scheduled downtime"!=e.error_code?s(i,a):o(a,c.SCHEDULED_DOWNTIME,{error_code:c.SCHEDULED_DOWNTIME})},this),r.error=a.bind(function(e){var t=e.status,n={error_code:c.UNKNOWN_ERROR};try{n=JSON.parse(e.responseText)}catch(i){}var a=n.error_code;500==t?a=c.UNKNOWN_ERROR:503==t&&(a=c.SERVICE_UNAVAILABLE_ERROR),a==c.UNAUTHORIZED&&l.setAuthToken("","",""),o(t,a,n)},this),!this.hasRequiredParams(r.required,r.data))return ABINE_DNTME.log.error("[ERROR HANDLER]#["+r.server+"]#["+r.action+"]# client missing required parameters"),void o(422,c.MISSING_PARAMETERS,{});h(r,function(e){p(e),t.ajax(e)})},hasRequiredParams:function(e,t){var n=!0;return a.each(e,a.bind(function(e){a.has(t,e)&&!this.isEmpty(t[e])||(n=!1)},this)),n},isEmpty:function(e){return null===e||e===undefined||e===NaN||""===e}}),g=m.extend({makeRequest:function(e){if(!e.url)throw"server calls must have a url";e.data=e.data||{},e.type=e.type||"POST",e.dataType=e.dataType||"json";var r=e.success||f,s=e.error||f;e.success=function(e,t,n
){var a=n.status,i=e.data;r(i,a,this)},e.error=function(e){var t=e.status,n={error_code:c.UNKNOWN_ERROR};try{n=JSON.parse(e.responseText)}catch(i){}var a=n.error_code;500==t&&(a=c.UNKNOWN_ERROR),s(t,a,n)},e.data.client_application||(e.data.client_application={}),this.lastRequest=e,this.tokenSet=!1;var t=this;h(e,function(e){p(e),t.tokenSet=!0,t.waitingRequest&&(t.waitingRequest(),delete t.waitingRequest)}),this.trigger("request:made")},respondWithSuccess:function(e,t,n){this.tokenSet?(this.lastRequest.success.call(this.lastRequest,e,t,n),delete this.lastRequest):this.waitingRequest=a.bind(this.respondWithSuccess,this,e,t,n)},respondWithError:function(e,t,n){this.tokenSet?(this.lastRequest.error=!0,this.lastRequest.error.call(this.lastRequest,e,t,n),delete this.lastRequest):this.waitingRequest=a.bind(this.respondWithError,this,e,t,n)}});return{server:m,mock:g}}),ABINE_DNTME.define("abine/storageMixins",["documentcloud/underscore","persistence","abine/localStorage","abine/crypto","abine/securityManager"],function(h,p,u,d,f){function m(e){ABINE_DNTME.require(["abine/pageEvents"],function(){ABINE_DNTME.backgroundMessenger.sendToWebapp("entity:changed",e)}),"Address"==e?f.trigger("entity:changed:"+e):"RealCard"==e&&(f.trigger("entity:changed:"+e),ABINE_DNTME.backgroundMessenger.broadcastToAllTabs("entity:changed:"+e))}var e={index:function(a,i){var r=this;if(r.meta.cached&&r.cached){var e=p.getCachedEntities(r);r.respondWithEntities(e,a,i)}else if(r.cachingQueryInProgress)r.waitingCallbacks.push({req:a,cb:i});else{r.cachingQueryInProgress=!0,r.waitingCallbacks=[];try{if(r.meta.localStorage)try{r.loadFromLocalStorage()}catch(s){}this.all().list(null,function(e){r.meta.cached&&(r.cached=!0);var t=r.waitingCallbacks;delete r.cachingQueryInProgress,delete r.waitingCallbacks;try{r.respondWithEntities(e,a,i)}catch(s){ABINE_DNTME.log.error(s)}for(var n=0;n<t.length;n++)try{e=p.getCachedEntities(r),r.respondWithEntities(e,t[n].req,t[n].cb)}catch(s){ABINE_DNTME.log.error(s)}m(r.meta.name)})}catch(s){var t=r.waitingCallbacks;delete r.cachingQueryInProgress,delete r.waitingCallbacks;for(var n=0;n<t.length;n++)try{r.respondWithEntities([],t[n].req,t[n].cb)}catch(s){ABINE_DNTME.log.error(s)}}}},isCached:function(){return this.meta.cached&&this.cached},show:function(t,n){var e=t.params[0];this.load(e,function(e){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})},create:function(e,t){var n=this;delete e.payload._type,e.payload.createdAt=new Date,e.payload.modifiedAt=new Date;var a=new n(e.payload);p.forceAdd(a),p.flush(null,function(){t?t.call(this,a):e.returnEntities&&e.returnEntities(a)})},update:function(t,n){var e=t.params[0];t.payload.modifiedAt=new Date,this.load(e,function(e){h.extend(e,t.payload),p.flush(null,function(){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})})},destroy:function(t,n){var e=t.params[0];this.load(e,function(e){p.remove(e),p.flush(null,function(){n?n.call():t.returnStatus&&t.returnStatus("ok")})})},respondWithEntities:function(e,t,n){n?n.call(this,e):t&&t.returnEntities&&t.returnEntities(e)},respondWithJSON:function(e,t,n){n?n.call(null,e):t.returnJSON&&t.returnJSON(e)},clearCache:function(t){if(this.decryptionFailed=!1,this.cached)try{this.index(null,h.bind(function(e){h.each(e,function(e){p.clearFromEntityCache(e)}),this.cached=!1,this.decryptionFailed=!1,t&&t()},this))}catch(e){}else t&&t()},listCached:function(n,a,i,r){if(!this.meta.cached)throw"listCached cannot be used with entities that do not have caching enabled.";"function"==typeof n?(i=n,r=a,n=null):r||(r=i,i=null),this.index(null,function(e){var t=[];h.each(e,function(e){n&&e[n]!=a||i&&!i(e)||t.push(e)}),r&&r(t)})},listByIndex:function(e,t){var n=this;if(!n.meta.indexed)throw"listByIndexed cannot be used with entities that do not have indexing enabled.";n.meta.cached&&n.cached?t(p.getEntitiesByIndex(n,e)):this.index(null,function(){t(p.getEntitiesByIndex(n,e))})},initCache:function(e){this.meta.cached&&!this.cached?this.index(null,function(){e()}):e()},useLocalStorage:function(){this.meta.localStorage=!0},useEncryption:function(e){this.meta.encrypted=!0,this.meta.encryptedFields=e||[]},useSyncStorage:function(){this.useLocalStorage(),this.meta.syncStorage=!0,this.meta.keepId=!0,ABINE_DNTME.require(["abine/blurstore-api"],h.bind(function(e){e.addTable(this.meta.name)},this))},loadFromLocalStorage:function(){var n=this,e=!1,t=null,a=n.meta.name,i=u.getItem(a),r=f.getUserId();r&&n.meta.encrypted&&(t=f.getEncryptionKey(),a+="."+r,i&&(u.getItem(a)||u.setItem(a,i),u.removeItem(n.meta.name)),i=u.getItem(a)),n.decryptionFailed=!1;var s=null;if(i&&""!=i){if(-1!=i.indexOf("ENC_")){if(i=i.substr(4),!t)throw n.decryptionFailed=!0,"encryption key not present for decrypting "+a;var o=d.decryptKey(t,i,null,!0);if(o==i)throw n.decryptionFailed=!0,"decryption error for "+this.meta.name;i=o}else t&&(e=!0);try{s=JSON.parse(i)}catch(c){}}else s=this._defaults;s&&h.each(s,function(e){var t=new n(e);p.forceAdd(t),t._dirtyProperties={},t._new=!1}),this.meta.syncStorage&&ABINE_DNTME.require(["abine/blurstore-api"],h.bind(function(e){e.load(n.meta.name)},this)),e&&n.saveToLocalStorage()},saveToLocalStorage:function(o){var c=this,e=f.getUserId(),l=c.meta.name;e&&c.meta.encrypted&&(l+="."+e),this.index(null,function(e){var t=[];h.each(e,function(e){e._new=!1,e=e.toJSON(),c.meta.keepId||delete e.id,t.push(e)});var n=u.getItem(l),a=JSON.stringify(t),i=!1,r=f.getEncryptionKey();if(c.meta.encrypted)if(r){var s=d.encryptKey(r,a);s!=a&&(a="ENC_"+s)}else n&&-1!=n.indexOf("ENC_")&&(i=!0);i||u.setItem(l,a),m(c.meta.name),this.meta.syncStorage?ABINE_DNTME.require(["abine/blurstore-api"],h.bind(function(e){e.save(c.meta.name,r),o&&o()},this)):o&&o()})},updateCache:function(e,t){p.removeIndex(e),h.extend(e,t),p.addIndex(e)},removeFromSyncStore:function(e,t){t=t||function(){};var n=h.after(e.length,t);ABINE_DNTME.require(["abine/blurstore-api"],h.bind(function(t){h.each(e,function(e){t["delete"](e.name,e.id),n()})},this))}};return p.flushHooks.push(function(e,t,n){var a=p.trackedObjects,i=[],r=[],s={};for(var o in a)if(a.hasOwnProperty(o)){if(p.objectsToRemove.hasOwnProperty(o))continue;var c=a[o];if((d=p.define(c._type)).meta.name in s){c._notInLocalStorage&&delete c._notInLocalStorage,c._dirtyProperties={};continue}var l=!1;if(d.meta.localStorage){if(c._notInLocalStorage)l=!0,delete c._notInLocalStorage;else{for(var u in c._dirtyProperties)if(c._dirtyProperties.hasOwnProperty(u)){l=!0;break}c._dirtyProperties={}}l&&(s[d.meta.name]=!0,i.push(d))}}for(var o in p.objectsToRemove)if(p.objectsToRemove.hasOwnProperty(o)){var d;c=p.objectsToRemove[o];(d=p.define(c._type)).meta.syncStorage&&r.push({name:d.meta.name,id:o}),d.meta.localStorage&&(d.meta.name in s||(s[d.meta.name]=!0,i.push(d))),delete p.objectsToRemove[o];try{delete a[o]}catch(f){}}n(),h.each(i,function(e){e.saveToLocalStorage()}),0<r.length&&d.removeFromSyncStore(r)}),{DefaultActions:e}}),ABINE_DNTME.define("abine/storageRouter",["documentcloud/underscore","persistence","abine/core","abine/fixtures","abine/backgroundMessenger"],function(u,n,e,a,i){var r={dbName:"idme_data",dbDescription:"Storage for the dntme extension",dbSizeInBytes:5242880},s=/:([\w\d]+)/g,o=/\*([\w\d]+)/g,c=/[-[\]{}()+?.,\\^$|#\s]/g,l=e.BaseClass.extend({initialize:function(e){var t=this,n=(e=e||{}).ready||function(){};this.routes=[],this.storage={},u.defaults(e,r),this.messenger=e.messenger||new i.BackgroundMessenger,l.initialized?(t.startListener(),n.call()):(e.ready=function(){t.startListener(),n.call()},l.initializeWebSQLStorage(e))},initializeMemoryStorage:function(e){n.store.memory.config(n),e.call(this)},startListener:function(){this.messenger.on("all",this.messageHandler,this)},registerEntity:function(e,n){this.storage[n]=e,u(e.routes).each(function(e,t){if(!e||!t)throw"Bad routes on entity "+n;if(u.isRegExp(t)||(t=t.replace(c,"\\$&").replace(s,"([^/]*)").replace(o,"(.*?)"),t=new RegExp("^"+t+"$","i")),!t)throw"Bad route for "+e;this.routes.push([t,n,e])},this)},messageHandler:function(e,t,n){var a=e.split(":")[0];if(u(["create","read","update","delete","search"]).include(a)){var i=e.replace(/\:/g,"/");i=i.replace(/\/\//g,":");var r=u(this.routes).find(function(e){return i.match(e[0])}),s=this.storage[r[1]],o=r[2],c=r[0].exec(i).slice(1),l=new d({entityName:r[1],route:e,payload:t,sender:n,params:c,messenger:this.messenger});return s[o].call(s,l),l}},send:function(){return this.messageHandler.apply(this,arguments)}});l.initializeWebSQLStorage=function(e){var t=e.ready||function(){};l.initialized?t():(n.store.memory.config(n,e.dbName,e.dbDescription,e.dbSizeInBytes),l.initialized=!0,e.fixtures?a.createFixtures(function(){t()}):t())};var d=e.BaseClass.extend({initialize:function(e){e=e||{},this.route=e.route,this.params=e.params,this.entityName=e.entityName,this.sender=e.sender||"background",this.messenger=e.messenger,this.payload=e.payload},getReturnRoute:function(){var e=this.route.split(":");return e[0]="response",e.join(":")},getReturnErrorRoute:function(){var e=this.route.split(":");return e[0]="error",e.join(":")},returnErrObj:function(e){return e=e||{},this.messenger.send(this.getReturnErrorRoute(this.route),e,this.sender),!0},returnError:function(e,t){var n={error:!0,message:e=e||"Server error",status:t=t||500};return this.messenger.send(this.getReturnErrorRoute(this.route),n,this.sender),!0},returnStatus:function(e){var t={status:e};return this.messenger.send(this.getReturnRoute(this.route),t,this.sender),!0},returnEntities:function(e){var t;e&&0!=e.length?u.isArray(e)&&1==e.length?t=e[0].toJSON():u.isArray(e)&&1<e.length?t=u(e).map(function(e){return e.toJSON()}):u.isObject(e)&&(t=e.toJSON()):t=[],this.messenger.send(this.getReturnRoute(this.route),t,this.sender)},returnJSON:function(e){this.messenger.send(this.getReturnRoute(this.route),e,this.sender)}});return{StorageRouter:l,StorageRequest:d}}),ABINE_DNTME.define("abine/pushNotifications",["documentcloud/underscore","abine/core","storage","abine/timer","abine/securityManager","abine/ajax","modules","abine/crypto"],function(t,e,a,u,i,n,d,f){function r(){var e=function(){var e=ABINE_DNTME.Socket;e||(e=io),this.socket=e.connect(ABINE_DNTME.config.pushNotificationUrl,{query:"authToken="+i.getAuthToken()+"&env="+ABINE_DNTME.config.environment,multiplex:!1,reconnection:!0,reconnectionDelay:1e4,reconnectionDelayMax:6e4,reconnectionAttempts:5,transports:m}),this.socket.myId=b,this.socket.on("connect",function(){g=0}),this.socket.on("connect_error",function(e){if("websocket error"==e.message){m=null,u.setTimeout(r,3e3);try{s()}catch(t){}}}),this.socket.on("error",t.bind(this.error,this)),this.socket.on("reconnect_failed",t.bind(function(){s.call(this),o.call(this)},this)),this.socket.on("logout",t.bind(this.logout,this)),this.socket.on("sync",t.bind(this.sync,this)),this.socket.on("mfaChanged",t.bind(this.mfaChanged,this)),this.socket.on("storeChanged",t.bind(this.storeChanged,this)),this.socket.on("biometricAuthResponse",t.bind(this.biometricAuthResponse,this)),this.socket.on("notify",t.bind(this.notify,this)),this.socket.on("growl",t.bind(this.growl,this))};p?(p=!1,u.setTimeout(t.bind(e,this),0)):n.ajax({url:ABINE_DNTME.config.pushNotificationUrl+"/ping",xhrFields:{withCredentials:!0},success:t.bind(e,this),error:t.bind(o,this)})}function s(){if(this.socket){try{this.socket.disconnect()}catch(e){}this.socket.off("connect"),this.socket.off("connect_error"),this.socket.off("error"),this.socket.off("reconnect_failed"),this.socket.off("logout"),this.socket.off("sync"),this.socket.off("mfaChanged"),this.socket.off("storeChanged"),this.socket.off("biometricAuthResponse"),this.socket.off("notify"),this.socket.off("growl"),this.socket=null}}function o(){6<g++&&(g=4);var e=Math.pow(2,g)*y+Math.round(Math.random()*y);u.clearTimeout(l),l=u.setTimeout(t.bind(r,this),e)}function c(e,t){ABINE_DNTME.backgroundMessenger.sendToWebapp(e,t)}var l,h=null,p=!0,m=["websocket"],g=0,y=1e3,b=Math.floor(1e7*Math.random());return new(e.BaseClass.extend({connect:function(){this.socket?this.socket.connect():r.call(this)},disconnect:function(){this.socket&&s.call(this)},error:function(e){g=0,"not authorized"==e&&i.logout()},logout:function(){i.logout(),c("websocket:push",{event:"logout",payload:null})},sync:function(t){ABINE_DNTME.require(["abine/blurstore-api"],function(e){e.synchronizeWhenOld(t)}),c("websocket:push",{event:"sync",payload:t})},mfaChanged:function(){i.refreshData(),c("websocket:push",{event:"mfaChanged",payload:null})},storeChanged:function(e){i.refreshData(),c("websocket:push",{event:"storeChanged",payload:e})},pushSync:function(e){d.licenseModule.pushSync(e),this.socket&&this.socket.emit("broadcast",{event:"sync",payload:e})},emit:function(e,t){this.socket&&this.socket.emit("broadcast",{event:e,payload:t})},biometricAuthResponse:function(e){if(h){if(h(e),e&&(e.ack||e.error&&e.error.match(/locked/i)))return;h=null}else c("websocket:push",{event:"biometricAuthResponse",payload:e})},biometricAuthCancel:function(){h=null},requestBiometricAuth:function(e,t,n,a,i,r,s){var o=this;if(u.clearTimeout(this.biometricTimer),h)try{h({success:!1})}catch(l){}h=s;var c={event:"biometricAuth",payload:{type:e,biometricKey:t,amount:a,number:i,account:r,sender:b,domain:n,domain_hash:f.sha1("abine"+n).toString()}};d.licenseModule.createBiometricAuthRequest(c,function(e){function n(t){d.licenseModule.getBiometricAuthResponse(null,function(e){e.status?(o.biometricAuthResponse({success:"success"==e.status,token:e.token,error:e.status}),e.status&&e.status.match(/locked/i)&&(o.biometricTimer=u.setTimeout(function(){n(t-1)},5e3))):0<t?o.biometricTimer=u.setTimeout(function(){n(t-1)},5e3):o.biometricAuthResponse({success:!1,error:"No response from mobile device"})})}e.success?(o.biometricAuthResponse({ack:!0}),n(20)):o.biometricAuthResponse(e)})},growl:function(n){if("string"==typeof n)try{n=JSON.parse(n)}catch(e){}n.name&&n.name.match(/card-declined/)&&a.DisposableCard.findOrFetchCard(n.guid,function(e){if(e&&"dnt-panel"==e.source&&e.active){var t={msg:"",targetUrl:ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost+"/#/cards",targetId:"",model:{maskedCard:e.toJSON(),declined:n},height:260,type:"card",neverFade:!0,locked:i.isLocked()};i.messenger.broadcastToAllTabs("background:show:notification:"+e.domain,t)}}),c("websocket:push",{event:"growl",payload:data})},notify:function(e){if("expiration_warning"==(e=JSON.parse(e))){var t={type:"expire_warning",neverFade:!0,panelWidth:320,locked:i.isLocked()};i.messenger.send("background:show:notification",t)}else if("expiration_notification"==e){t={type:"expire_notify",neverFade:!0,panelWidth:320,locked:i.isLocked()};i.messenger.send("background:show:notification",t)}c("websocket:push",{event:"notify",payload:e})},getId:function(){return b}}))}),ABINE_DNTME.define("abine/stubs",["documentcloud/underscore","abine/core"],function(){function e(e){(r=e).on("contentManager:proxy:connect",function(e,t){r.send("background:stub:response:"+e.id,t,t)}),e.on("contentManager:proxy:call",function(a,i){ABINE_DNTME.require([a.require],function(e){var t=a.callId,n=e[a.method].apply(e,a.params);r.send("background:stub:response:"+t,n,i)})}),e.on("contentManager:proxy:callAsync",function(a,i){ABINE_DNTME.require([a.require],function(e){var n=a.callId,t=function(e,t){r.send("background:stub:response:"+n,{err:e,data:t},i)};a.params=a.params||[],a.params.push(t),e[a.method].apply(e,a.params)})})}function t(){r&&(r.off("contentManager:proxy:connect"),r.off("contentManager:proxy:call"),r.off("contentManager:proxy:callAsync"),r=null)}var r;return{start:e,stop:t}}),ABINE_DNTME.define("abine/webapp",["documentcloud/underscore","abine/core","storage","abine/securityManager","abine/window"],function(e,t,s,i,n){function o(t,n,a){s.Preference.findBy("key","mergedMigrationPending",function(e){e&&e.isTrue()?i.openPage("/#/migrate"):i.openPage(t,n,a)})}function a(e){o("/#/client/home",e)}function r(){o("/#/client/dashboard/guide")}function c(e){o("/#/client/dashboard",!1,e)}function l(){o("/#/client/emails")}function u(e){o(e?"/#/client/accounts/"+e+"/1":"/#/client/accounts")}function d(){o("/#/client/wallet")}function f(){o("/#/client/masking")}function h(e){o("/#/client/help"+(e=e||""))}function p(){o("/#/forgot")}function m(e,t){var n="/#/help/faq/"+(e=e||"");(t=t||"")&&(n=n+"/"+t),o(n)}function g(){o("/#/client/emailsin30")}function y(){ABINE_DNTME.maskme_installed?i.openLink({type:"dntReport"}):o("/#/client/stats")}function b(){o("/#/client/understandingTracking")}function v(){s.Preference.findBy("key","cardsEarned",function(e){o(e?"/#/client/cashforcards/signup/"+e.value:"/#/client/cashforcards/signup")})}function _(){s.Preference.findBy("key","cardsEarned",function(e){o(e?"/#/client/cashforcards/faq/"+e.value:"/#/client/cashforcards/faq")})}function E(){s.Preference.findBy("key","authToken",function(e){e&&e.value&&0<e.value.length?c():y()})}function k(){s.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"entitledToPhone"}],function(e){var t=e.authToken&&""!=e.authToken.value,n=e.entitledToPhone;t?!n||n.isFalse()?o("/#/client/premium"):s.ShieldedPhone.index(null,function(e){e&&0<e.length&&!e[0].isValidated()?o("/#/client/verifyPhone"):o("/#/client/phones")}):o("/#/client/premium")})}function T(a,i,r){a=a?"/link/"+a:"",i=i||"",s.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"entitledToPhone"}],function(e){var t=e.authToken&&""!=e.authToken.value,n=e.entitledToPhone;t?!n||n.isFalse()?o("/#"+a+"/client/premium/"+i,r):o("/#/client/settings"):o("/#"+a+"/client/premium/"+i,r)})}function w(e,t){o("/?pk_campaign="+e+"#"+t)}function A(){o("/#/client/featureAdded")}function N(a,i){a=a||"",s.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"entitledToPhone"}],function(e){var t=e.authToken&&""!=e.authToken.value,n=e.entitledToPhone;t?!n||n.isFalse()?o("/#/client/holiday/"+a,i):o("/#/client/settings"):o("/#/client/holiday/"+a,i)})}function S(i){s.ShieldedCard.index(null,function(a){s.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"entitledToPayments"},{by:"key",value:"hasEnabledPayments"}],function(e){var t=e.authToken&&""!=e.authToken.value,n=e.entitledToPayments;t?!n||n.isFalse()?o("/#/client/premium",i):0<a.length?o("/#/client/cards",i):o("/#/client/premium/setup/dashboard",i):o("/#/client/premium",i)})})}function I(){o("/#/client/settings")}function M(e){o("/#/client/login/"+(e=e||""))}function D(){o("/#/dnt2upgrade")}function C(e){o("/#/client/setupPassword/"+(e=e||""))}function x(){I()}function P(){o("/#/client/weeklyReport")}function O(){o("/#/mobilePrivacy")}function B(){n.reloadTab({doNotActivate:!0,doNotOpenNewTab:!0,url:ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost})}return{reload:B,openHome:a,openDashboard:c,openWallet:d,openMasking:f,openEmails:l,openStats:y,openUnderstandingTracking:b,openCards:S,openPhones:k,openLogin:M,openNewFeatureAdded:A,openSnowman:N,openPremium:T,openBlacklist:x,openSettings:I,openPasswordSetup:C,openPiwikCampaign:w,openHelp:h,openForgotPassword:p,openFAQ:m,openDashboardOrStats:E,openDnt2UpgradePage:D,openMaskedEmailsIn30:g,openPage:o,openWeeklyReport:P,openDntAnywhere:O,openCashForCardsFaq:_,openCashForCardsSignup:v,openTour:r,openAccounts:u}}),ABINE_DNTME.define("blueimp-md5",function(){return function(e){var t,n=[];for(n[(e.length>>2)-1]=undefined,t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<8*e.length;t+=8)n[t>>5]|=e.charCodeAt(t/8)<<t%32;return MD5(n,e.length)}}),
/*
 * JavaScript MD5 1.0.1
 * https://github.com/blueimp/JavaScript-MD5
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 *
 * Based on
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 */
function(e){"use strict";function d(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function s(e,t){return e<<t|e>>>32-t}function o(e,t,n,a,i,r){return d(s(d(d(t,e),d(a,r)),i),n)}function f(e,t,n,a,i,r,s){return o(t&n|~t&a,e,t,i,r,s)}function h(e,t,n,a,i,r,s){return o(t&a|n&~a,e,t,i,r,s)}function p(e,t,n,a,i,r,s){return o(t^n^a,e,t,i,r,s)}function m(e,t,n,a,i,r,s){return o(n^(t|~a),e,t,i,r,s)}function n(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var n,a,i,r,s,o=1732584193,c=-271733879,l=-1732584194,u=271733878;for(n=0;n<e.length;n+=16)c=m(c=m(c=m(c=m(c=p(c=p(c=p(c=p(c=h(c=h(c=h(c=h(c=f(c=f(c=f(c=f(i=c,l=f(r=l,u=f(s=u,o=f(a=o,c,l,u,e[n],7,-680876936),c,l,e[n+1],12,-389564586),o,c,e[n+2],17,606105819),u,o,e[n+3],22,-1044525330),l=f(l,u=f(u,o=f(o,c,l,u,e[n+4],7,-176418897),c,l,e[n+5],12,1200080426),o,c,e[n+6],17,-1473231341),u,o,e[n+7],22,-45705983),l=f(l,u=f(u,o=f(o,c,l,u,e[n+8],7,1770035416),c,l,e[n+9],12,-1958414417),o,c,e[n+10],17,-42063),u,o,e[n+11],22,-1990404162),l=f(l,u=f(u,o=f(o,c,l,u,e[n+12],7,1804603682),c,l,e[n+13],12,-40341101),o,c,e[n+14],17,-1502002290),u,o,e[n+15],22,1236535329),l=h(l,u=h(u,o=h(o,c,l,u,e[n+1],5,-165796510),c,l,e[n+6],9,-1069501632),o,c,e[n+11],14,643717713),u,o,e[n],20,-373897302),l=h(l,u=h(u,o=h(o,c,l,u,e[n+5],5,-701558691),c,l,e[n+10],9,38016083),o,c,e[n+15],14,-660478335),u,o,e[n+4],20,-405537848),l=h(l,u=h(u,o=h(o,c,l,u,e[n+9],5,568446438),c,l,e[n+14],9,-1019803690),o,c,e[n+3],14,-187363961),u,o,e[n+8],20,1163531501),l=h(l,u=h(u,o=h(o,c,l,u,e[n+13],5,-1444681467),c,l,e[n+2],9,-51403784),o,c,e[n+7],14,1735328473),u,o,e[n+12],20,-1926607734),l=p(l,u=p(u,o=p(o,c,l,u,e[n+5],4,-378558),c,l,e[n+8],11,-2022574463),o,c,e[n+11],16,1839030562),u,o,e[n+14],23,-35309556),l=p(l,u=p(u,o=p(o,c,l,u,e[n+1],4,-1530992060),c,l,e[n+4],11,1272893353),o,c,e[n+7],16,-155497632),u,o,e[n+10],23,-1094730640),l=p(l,u=p(u,o=p(o,c,l,u,e[n+13],4,681279174),c,l,e[n],11,-358537222),o,c,e[n+3],16,-722521979),u,o,e[n+6],23,76029189),l=p(l,u=p(u,o=p(o,c,l,u,e[n+9],4,-640364487),c,l,e[n+12],11,-421815835),o,c,e[n+15],16,530742520),u,o,e[n+2],23,-995338651),l=m(l,u=m(u,o=m(o,c,l,u,e[n],6,-198630844),c,l,e[n+7],10,1126891415),o,c,e[n+14],15,-1416354905),u,o,e[n+5],21,-57434055),l=m(l,u=m(u,o=m(o,c,l,u,e[n+12],6,1700485571),c,l,e[n+3],10,-1894986606),o,c,e[n+10],15,-1051523),u,o,e[n+1],21,-2054922799),l=m(l,u=m(u,o=m(o,c,l,u,e[n+8],6,1873313359),c,l,e[n+15],10,-30611744),o,c,e[n+6],15,-1560198380),u,o,e[n+13],21,1309151649),l=m(l,u=m(u,o=m(o,c,l,u,e[n+4],6,-145523070),c,l,e[n+11],10,-1120210379),o,c,e[n+2],15,718787259),u,o,e[n+9],21,-343485551),o=d(o,a),c=d(c,i),l=d(l,r),u=d(u,s);return[o,c,l,u]}function a(e){var t,n="";for(t=0;t<32*e.length;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function i(e){var t,n,a="0123456789abcdef",i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+=a.charAt(t>>>4&15)+a.charAt(15&t);return i}e.MD5=function(e,t){return i(a(n(e,8*t)))}}(this),ABINE_DNTME.define("asmCrypto",function(){var ea,ta;
/*! asmCrypto, (c) 2013 Artem S Vybornov, opensource.org/licenses/MIT */return function(e,f){function b(){var e=Error.apply(this,arguments);this.message=e.message,this.stack=e.stack}function p(){var e=Error.apply(this,arguments);this.message=e.message,this.stack=e.stack}function v(){var e=Error.apply(this,arguments);this.message=e.message,this.stack=e.stack}function y(e,t){t=!!t;for(var n=e.length,a=new Uint8Array(t?4*n:n),i=0,r=0;i<n;i++){var s=e.charCodeAt(i);if(t&&55296<=s&&s<=56319){if(++i>=n)throw new Error("Malformed string, low surrogate expected at position "+i);s=(55296^s)<<10|65536|56320^e.charCodeAt(i)}else if(!t&&s>>>8)throw new Error("Wide characters are not allowed.");!t||s<=127?a[r++]=s:(s<=2047?a[r++]=192|s>>6:(s<=65535?a[r++]=224|s>>12:(a[r++]=240|s>>18,a[r++]=128|s>>12&63),a[r++]=128|s>>6&63),a[r++]=128|63&s)}return a.subarray(0,r)}function t(e){var t=e.length;1&t&&(e="0"+e,t++);for(var n=new Uint8Array(t>>1),a=0;a<t;a+=2)n[a>>1]=parseInt(e.substr(a,2),16);return n}function n(e){return y(atob(e))}function a(e,t){t=!!t;for(var n=e.length,a=new Array(n),i=0,r=0;i<n;i++){var s=e[i];if(!t||s<128)a[r++]=s;else if(192<=s&&s<224&&i+1<n)a[r++]=(31&s)<<6|63&e[++i];else if(224<=s&&s<240&&i+2<n)a[r++]=(15&s)<<12|(63&e[++i])<<6|63&e[++i];else{if(!(240<=s&&s<248&&i+3<n))throw new Error("Malformed UTF8 character at byte offset "+i);var o=(7&s)<<18|(63&e[++i])<<12|(63&e[++i])<<6|63&e[++i];o<=65535?a[r++]=o:(o^=65536,a[r++]=55296|o>>10,a[r++]=56320|1023&o)}}var c="",l=16384;for(i=0;i<r;i+=l)c+=String.fromCharCode.apply(String,a.slice(i,i+l<=r?i+l:r));return c}function i(e){for(var t="",n=0;n<e.length;n++){var a=(255&e[n]).toString(16);a.length<2&&(t+="0"),t+=a}return t}function r(e){return btoa(a(e))}function h(e){return e-=1,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,1+(e|=e>>>16)}function _(e){return"number"==typeof e}function E(e){return"string"==typeof e}function k(e){return e instanceof ArrayBuffer}function m(e){return e instanceof Uint8Array}function o(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function s(e,t){var n=t.heap,a=n?n.byteLength:t.heapSize||65536;if(4095&a||a<=0)throw new Error("heap size must be a positive integer and a multiple of 4096");return n||new e(new ArrayBuffer(a))}function g(e,t,n,a,i){var r=e.length-t,s=r<i?r:i;return e.set(n.subarray(a,a+s),t),s}function c(e){e=e||{},this.heap=s(Uint8Array,e).subarray(Xt.HEAP_DATA),this.asm=e.asm||Xt(f,null,this.heap.buffer),this.mode=null,this.key=null,this.reset(e)}function l(e){if(void 0!==e){if(k(e)||m(e))e=new Uint8Array(e);else{if(!E(e))throw new TypeError("unexpected key type");e=y(e)}var t=e.length;if(16!==t&&24!==t&&32!==t)throw new p("illegal key size");var n=new DataView(e.buffer,e.byteOffset,e.byteLength);this.asm.set_key(t>>2,n.getUint32(0),n.getUint32(4),n.getUint32(8),n.getUint32(12),16<t?n.getUint32(16):0,16<t?n.getUint32(20):0,24<t?n.getUint32(24):0,24<t?n.getUint32(28):0),this.key=e}else if(!this.key)throw new Error("key is required")}function d(e){if(void 0!==e){if(k(e)||m(e))e=new Uint8Array(e);else{if(!E(e))throw new TypeError("unexpected iv type");e=y(e)}if(16!==e.length)throw new p("illegal iv size");var t=new DataView(e.buffer,e.byteOffset,e.byteLength);this.iv=e,this.asm.set_iv(t.getUint32(0),t.getUint32(4),t.getUint32(8),t.getUint32(12))}else this.iv=null,this.asm.set_iv(0,0,0,0)}function u(e){this.padding=void 0===e||!!e}function T(e){return e=e||{},this.result=null,this.pos=0,this.len=0,l.call(this,e.key),this.hasOwnProperty("iv")&&d.call(this,e.iv),this.hasOwnProperty("padding")&&u.call(this,e.padding),this}function w(e){if(E(e)&&(e=y(e)),k(e)&&(e=new Uint8Array(e)),!m(e))throw new TypeError("data isn't of expected type");for(var t=this.asm,n=this.heap,a=Xt.ENC[this.mode],i=Xt.HEAP_DATA,r=this.pos,s=this.len,o=0,c=e.length||0,l=0,u=0,d=new Uint8Array(s+c&-16);0<c;)s+=u=g(n,r+s,e,o,c),o+=u,c-=u,(u=t.cipher(a,i+r,s))&&d.set(n.subarray(r,r+u),l),l+=u,u<s?(r+=u,s-=u):s=r=0;return this.result=d,this.pos=r,this.len=s,this}function A(e){var t=null,n=0;void 0!==e&&(n=(t=w.call(this,e).result).length);var a=this.asm,i=this.heap,r=Xt.ENC[this.mode],s=Xt.HEAP_DATA,o=this.pos,c=this.len,l=16-c%16,u=c;if(this.hasOwnProperty("padding")){if(this.padding){for(var d=0;d<l;++d)i[o+c+d]=l;u=c+=l}else if(c%16)throw new p("data length must be a multiple of the block size")}else c+=l;var f=new Uint8Array(n+u);return n&&f.set(t),c&&a.cipher(r,s+o,c),u&&f.set(i.subarray(o,o+u),n),this.result=f,this.pos=0,this.len=0,this}function N(e){if(E(e)&&(e=y(e)),k(e)&&(e=new Uint8Array(e)),!m(e))throw new TypeError("data isn't of expected type");var t=this.asm,n=this.heap,a=Xt.DEC[this.mode],i=Xt.HEAP_DATA,r=this.pos,s=this.len,o=0,c=e.length||0,l=0,u=s+c&-16,d=0,f=0;this.hasOwnProperty("padding")&&this.padding&&(u-=d=s+c-u||16);for(var h=new Uint8Array(u);0<c;)s+=f=g(n,r+s,e,o,c),o+=f,c-=f,(f=t.cipher(a,i+r,s-(c?0:d)))&&h.set(n.subarray(r,r+f),l),l+=f,f<s?(r+=f,s-=f):s=r=0;return this.result=h,this.pos=r,this.len=s,this}function S(e){var t=null,n=0;void 0!==e&&(n=(t=N.call(this,e).result).length);var a=this.asm,i=this.heap,r=Xt.DEC[this.mode],s=Xt.HEAP_DATA,o=this.pos,c=this.len,l=c;if(0<c){if(c%16){if(this.hasOwnProperty("padding"))throw new p("data length must be a multiple of the block size");c+=16-c%16}if(a.cipher(r,s+o,c),this.hasOwnProperty("padding")&&this.padding){var u=i[o+l-1];if(u<1||16<u||l<u)throw new v("bad padding");for(var d=0,f=u;1<f;f--)d|=u^i[o+l-f];if(d)throw new v("bad padding");l-=u}}var h=new Uint8Array(n+l);return 0<n&&h.set(t),0<l&&h.set(i.subarray(o,o+l),n),this.result=h,this.pos=0,this.len=0,this}function I(e){this.padding=!0,this.iv=null,c.call(this,e),this.mode="CBC"}function M(e){I.call(this,e)}function D(e){I.call(this,e)}function C(e){this.nonce=null,this.counter=0,this.counterSize=0,c.call(this,e),this.mode="CTR"}function x(e){C.call(this,e)}function P(e,t,n){if(void 0!==n){if(n<8||48<n)throw new p("illegal counter size");this.counterSize=n;var a=Math.pow(2,n)-1;this.asm.set_mask(0,0,a/4294967296|0,0|a)}else this.counterSize=n=48,this.asm.set_mask(0,0,65535,4294967295);if(void 0===e)throw new Error("nonce is required");if(k(e)||m(e))e=new Uint8Array(e);else{if(!E(e))throw new TypeError("unexpected nonce type");e=y(e)}var i=e.length;if(!i||16<i)throw new p("illegal nonce size");this.nonce=e;var r=new DataView(new ArrayBuffer(16));if(new Uint8Array(r.buffer).set(e),this.asm.set_nonce(r.getUint32(0),r.getUint32(4),r.getUint32(8),r.getUint32(12)),void 0!==t){if(!_(t))throw new TypeError("unexpected counter type");if(t<0||t>=Math.pow(2,n))throw new p("illegal counter value");this.counter=t,this.asm.set_counter(0,0,t/4294967296|0,0|t)}else this.counter=t=0}function O(e){return e=e||{},T.call(this,e),P.call(this,e.nonce,e.counter,e.counterSize),this}function B(e){for(var t=this.heap,n=this.asm,a=0,i=e.length||0,r=0;0<i;){for(a+=r=g(t,0,e,a,i),i-=r;15&r;)t[r++]=0;n.mac(Xt.MAC.GCM,Xt.HEAP_DATA,r)}}function R(e){this.nonce=null,this.adata=null,this.iv=null,this.counter=1,this.tagSize=16,c.call(this,e),this.mode="GCM"}function F(e){R.call(this,e)}function L(e){R.call(this,e)}function q(e){e=e||{},T.call(this,e);var t=this.asm,n=this.heap;t.gcm_init();var a=e.tagSize;if(void 0!==a){if(!_(a))throw new TypeError("tagSize must be a number");if(a<4||16<a)throw new p("illegal tagSize value");this.tagSize=a}else this.tagSize=16;var i=e.nonce;if(void 0===i)throw new Error("nonce is required");if(m(i)||k(i))i=new Uint8Array(i);else{if(!E(i))throw new TypeError("unexpected nonce type");i=y(i)}var r=(this.nonce=i).length||0,s=new Uint8Array(16);12!==r?(B.call(this,i),n[0]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=0,n[11]=r>>>29,n[12]=r>>>21&255,n[13]=r>>>13&255,n[14]=r>>>5&255,n[15]=r<<3&255,t.mac(Xt.MAC.GCM,Xt.HEAP_DATA,16),t.get_iv(Xt.HEAP_DATA),t.set_iv(),s.set(n.subarray(0,16))):(s.set(i),s[15]=1);var o=new DataView(s.buffer);this.gamma0=o.getUint32(12),t.set_nonce(o.getUint32(0),o.getUint32(4),o.getUint32(8),0),t.set_mask(0,0,0,4294967295);var c=e.adata;if(null!=c){if(m(c)||k(c))c=new Uint8Array(c);else{if(!E(c))throw new TypeError("unexpected adata type");c=y(c)}if(c.length>en)throw new p("illegal adata length");c.length?(this.adata=c,B.call(this,c)):this.adata=null}else this.adata=null;var l=e.counter;if(void 0!==l){if(!_(l))throw new TypeError("counter must be a number");if(l<1||4294967295<l)throw new RangeError("counter must be a positive 32-bit integer");this.counter=l,t.set_counter(0,0,0,this.gamma0+l|0)}else this.counter=1,t.set_counter(0,0,0,this.gamma0+1|0);var u=e.iv;if(void 0!==u){if(!_(l))throw new TypeError("counter must be a number");this.iv=u,d.call(this,u)}return this}function U(e){if(E(e)&&(e=y(e)),k(e)&&(e=new Uint8Array(e)),!m(e))throw new TypeError("data isn't of expected type");var t=0,n=e.length||0,a=this.asm,i=this.heap,r=this.counter,s=this.pos,o=this.len,c=0,l=o+n&-16,u=0;if(en<(r-1<<4)+o+n)throw new RangeError("counter overflow");for(var d=new Uint8Array(l);0<n;)o+=u=g(i,s+o,e,t,n),t+=u,n-=u,u=a.cipher(Xt.ENC.CTR,Xt.HEAP_DATA+s,o),(u=a.mac(Xt.MAC.GCM,Xt.HEAP_DATA+s,u))&&d.set(i.subarray(s,s+u),c),r+=u>>>4,c+=u,u<o?(s+=u,o-=u):o=s=0;return this.result=d,this.counter=r,this.pos=s,this.len=o,this}function J(){var e=this.asm,t=this.heap,n=this.counter,a=this.tagSize,i=this.adata,r=this.pos,s=this.len,o=new Uint8Array(s+a);e.cipher(Xt.ENC.CTR,Xt.HEAP_DATA+r,s+15&-16),s&&o.set(t.subarray(r,r+s));for(var c=s;15&c;c++)t[r+c]=0;e.mac(Xt.MAC.GCM,Xt.HEAP_DATA+r,c);var l=null!==i?i.length:0,u=(n-1<<4)+s;return t[0]=t[1]=t[2]=0,t[3]=l>>>29,t[4]=l>>>21,t[5]=l>>>13&255,t[6]=l>>>5&255,t[7]=l<<3&255,t[8]=t[9]=t[10]=0,t[11]=u>>>29,t[12]=u>>>21&255,t[13]=u>>>13&255,t[14]=u>>>5&255,t[15]=u<<3&255,e.mac(Xt.MAC.GCM,Xt.HEAP_DATA,16),e.get_iv(Xt.HEAP_DATA),e.set_counter(0,0,0,this.gamma0),e.cipher(Xt.ENC.CTR,Xt.HEAP_DATA,16),o.set(t.subarray(0,a),s),this.result=o,this.counter=1,this.pos=0,this.len=0,this}function j(e){var t=U.call(this,e).result,n=J.call(this).result,a=new Uint8Array(t.length+n.length);return t.length&&a.set(t),n.length&&a.set(n,t.length),this.result=a,this}function G(e){if(E(e)&&(e=y(e)),k(e)&&(e=new Uint8Array(e)),!m(e))throw new TypeError("data isn't of expected type");var t=0,n=e.length||0,a=this.asm,i=this.heap,r=this.counter,s=this.tagSize,o=this.pos,c=this.len,l=0,u=s<c+n?c+n-s&-16:0,d=c+n-u,f=0;if(en<(r-1<<4)+c+n)throw new RangeError("counter overflow");for(var h=new Uint8Array(u);d<n;)c+=f=g(i,o+c,e,t,n-d),t+=f,n-=f,f=a.mac(Xt.MAC.GCM,Xt.HEAP_DATA+o,f),(f=a.cipher(Xt.DEC.CTR,Xt.HEAP_DATA+o,f))&&h.set(i.subarray(o,o+f),l),r+=f>>>4,l+=f,c=o=0;return 0<n&&(c+=g(i,0,e,t,n)),this.result=h,this.counter=r,this.pos=o,this.len=c,this}function H(){var e=this.asm,t=this.heap,n=this.tagSize,a=this.adata,i=this.counter,r=this.pos,s=this.len,o=s-n;if(s<n)throw new b("authentication tag not found");for(var c=new Uint8Array(o),l=new Uint8Array(t.subarray(r+o,r+s)),u=o;15&u;u++)t[r+u]=0;e.mac(Xt.MAC.GCM,Xt.HEAP_DATA+r,u),e.cipher(Xt.DEC.CTR,Xt.HEAP_DATA+r,u),o&&c.set(t.subarray(r,r+o));var d=null!==a?a.length:0,f=(i-1<<4)+s-n;t[0]=t[1]=t[2]=0,t[3]=d>>>29,t[4]=d>>>21,t[5]=d>>>13&255,t[6]=d>>>5&255,t[7]=d<<3&255,t[8]=t[9]=t[10]=0,t[11]=f>>>29,t[12]=f>>>21&255,t[13]=f>>>13&255,t[14]=f>>>5&255,t[15]=f<<3&255,e.mac(Xt.MAC.GCM,Xt.HEAP_DATA,16),e.get_iv(Xt.HEAP_DATA),e.set_counter(0,0,0,this.gamma0),e.cipher(Xt.ENC.CTR,Xt.HEAP_DATA,16);var h=0;for(u=0;u<n;++u)h|=l[u]^t[u];if(h)throw new v("data integrity check failed");return this.result=c,this.counter=1,this.pos=0,this.len=0,this}function z(e){var t=G.call(this,e).result,n=H.call(this).result,a=new Uint8Array(t.length+n.length);return t.length&&a.set(t),n.length&&a.set(n,t.length),this.result=a,this}function W(e,t,n,a){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new I({heap:rn,asm:sn,key:t,padding:n,iv:a}).encrypt(e).result}function V(e,t,n,a){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new I({heap:rn,asm:sn,key:t,padding:n,iv:a}).decrypt(e).result}function X(e,t,n,a,i){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");if(void 0===n)throw new SyntaxError("nonce required");return new R({heap:rn,asm:sn,key:t,nonce:n,adata:a,tagSize:i}).encrypt(e).result}function K(e,t,n,a,i){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");if(void 0===n)throw new SyntaxError("nonce required");return new R({heap:rn,asm:sn,key:t,nonce:n,adata:a,tagSize:i}).decrypt(e).result}function Z(){return this.result=null,this.pos=0,this.len=0,this.asm.reset(),this}function Q(e){if(null!==this.result)throw new b("state must be reset before processing new data");if(E(e)&&(e=y(e)),k(e)&&(e=new Uint8Array(e)),!m(e))throw new TypeError("data isn't of expected type");for(var t=this.asm,n=this.heap,a=this.pos,i=this.len,r=0,s=e.length,o=0;0<s;)i+=o=g(n,a+i,e,r,s),r+=o,s-=o,a+=o=t.process(a,i),(i-=o)||(a=0);return this.pos=a,this.len=i,this}function Y(){if(null!==this.result)throw new b("state must be reset before processing new data");return this.asm.finish(this.pos,this.len,0),this.result=new Uint8Array(this.HASH_SIZE),this.result.set(this.heap.subarray(0,this.HASH_SIZE)),this.pos=0,this.len=0,this}function $(e,t,n){"use asm";var Pe=0,Oe=0,Be=0,Re=0,Fe=0,g=0,y=0;var b=0,v=0,_=0,E=0,k=0,T=0,w=0,A=0,N=0,S=0;var m=new e.Uint8Array(n);function I(e,t,n,a,i,r,s,o,c,l,u,d,f,h,p,m){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;r=r|0;s=s|0;o=o|0;c=c|0;l=l|0;u=u|0;d=d|0;f=f|0;h=h|0;p=p|0;m=m|0;var g=0,y=0,b=0,v=0,_=0,E=0,k=0,T=0,w=0,A=0,N=0,S=0,I=0,M=0,D=0,C=0,x=0,P=0,O=0,B=0,R=0,F=0,L=0,q=0,U=0,J=0,j=0,G=0,H=0,z=0,W=0,V=0,X=0,K=0,Z=0,Q=0,Y=0,$=0,ee=0,te=0,ne=0,ae=0,ie=0,re=0,se=0,oe=0,ce=0,le=0,ue=0,de=0,fe=0,he=0,pe=0,me=0,ge=0,ye=0,be=0,ve=0,_e=0,Ee=0,ke=0,Te=0,we=0,Ae=0,Ne=0,Se=0,Ie=0,Me=0,De=0,Ce=0,xe=0;g=Pe;y=Oe;b=Be;v=Re;_=Fe;k=e+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=t+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=n+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=a+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=i+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=r+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=s+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=o+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=c+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=l+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=u+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=d+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=f+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=h+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=p+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;k=m+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=h^c^n^e;T=E<<1|E>>>31;k=T+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=p^l^a^t;w=E<<1|E>>>31;k=w+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=m^u^i^n;A=E<<1|E>>>31;k=A+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=T^d^r^a;N=E<<1|E>>>31;k=N+(g<<5|g>>>27)+_+(y&b|~y&v)+1518500249|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=w^f^s^i;S=E<<1|E>>>31;k=S+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=A^h^o^r;I=E<<1|E>>>31;k=I+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=N^p^c^s;M=E<<1|E>>>31;k=M+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=S^m^l^o;D=E<<1|E>>>31;k=D+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=I^T^u^c;C=E<<1|E>>>31;k=C+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=M^w^d^l;x=E<<1|E>>>31;k=x+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=D^A^f^u;P=E<<1|E>>>31;k=P+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=C^N^h^d;O=E<<1|E>>>31;k=O+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=x^S^p^f;B=E<<1|E>>>31;k=B+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=P^I^m^h;R=E<<1|E>>>31;k=R+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=O^M^T^p;F=E<<1|E>>>31;k=F+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=B^D^w^m;L=E<<1|E>>>31;k=L+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=R^C^A^T;q=E<<1|E>>>31;k=q+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=F^x^N^w;U=E<<1|E>>>31;k=U+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=L^P^S^A;J=E<<1|E>>>31;k=J+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=q^O^I^N;j=E<<1|E>>>31;k=j+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=U^B^M^S;G=E<<1|E>>>31;k=G+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=J^R^D^I;H=E<<1|E>>>31;k=H+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=j^F^C^M;z=E<<1|E>>>31;k=z+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=G^L^x^D;W=E<<1|E>>>31;k=W+(g<<5|g>>>27)+_+(y^b^v)+1859775393|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=H^q^P^C;V=E<<1|E>>>31;k=V+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=z^U^O^x;X=E<<1|E>>>31;k=X+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=W^J^B^P;K=E<<1|E>>>31;k=K+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=V^j^R^O;Z=E<<1|E>>>31;k=Z+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=X^G^F^B;Q=E<<1|E>>>31;k=Q+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=K^H^L^R;Y=E<<1|E>>>31;k=Y+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=Z^z^q^F;$=E<<1|E>>>31;k=$+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=Q^W^U^L;ee=E<<1|E>>>31;k=ee+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=Y^V^J^q;te=E<<1|E>>>31;k=te+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=$^X^j^U;ne=E<<1|E>>>31;k=ne+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=ee^K^G^J;ae=E<<1|E>>>31;k=ae+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=te^Z^H^j;ie=E<<1|E>>>31;k=ie+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=ne^Q^z^G;re=E<<1|E>>>31;k=re+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=ae^Y^W^H;se=E<<1|E>>>31;k=se+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=ie^$^V^z;oe=E<<1|E>>>31;k=oe+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=re^ee^X^W;ce=E<<1|E>>>31;k=ce+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=se^te^K^V;le=E<<1|E>>>31;k=le+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=oe^ne^Z^X;ue=E<<1|E>>>31;k=ue+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=ce^ae^Q^K;de=E<<1|E>>>31;k=de+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=le^ie^Y^Z;fe=E<<1|E>>>31;k=fe+(g<<5|g>>>27)+_+(y&b|y&v|b&v)-1894007588|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=ue^re^$^Q;he=E<<1|E>>>31;k=he+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=de^se^ee^Y;pe=E<<1|E>>>31;k=pe+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=fe^oe^te^$;me=E<<1|E>>>31;k=me+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=he^ce^ne^ee;ge=E<<1|E>>>31;k=ge+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=pe^le^ae^te;ye=E<<1|E>>>31;k=ye+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=me^ue^ie^ne;be=E<<1|E>>>31;k=be+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=ge^de^re^ae;ve=E<<1|E>>>31;k=ve+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=ye^fe^se^ie;_e=E<<1|E>>>31;k=_e+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=be^he^oe^re;Ee=E<<1|E>>>31;k=Ee+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=ve^pe^ce^se;ke=E<<1|E>>>31;k=ke+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=_e^me^le^oe;Te=E<<1|E>>>31;k=Te+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=Ee^ge^ue^ce;we=E<<1|E>>>31;k=we+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=ke^ye^de^le;Ae=E<<1|E>>>31;k=Ae+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=Te^be^fe^ue;Ne=E<<1|E>>>31;k=Ne+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=we^ve^he^de;Se=E<<1|E>>>31;k=Se+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=Ae^_e^pe^fe;Ie=E<<1|E>>>31;k=Ie+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=Ne^Ee^me^he;Me=E<<1|E>>>31;k=Me+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=Se^ke^ge^pe;De=E<<1|E>>>31;k=De+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=Ie^Te^ye^me;Ce=E<<1|E>>>31;k=Ce+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;E=Me^we^be^ge;xe=E<<1|E>>>31;k=xe+(g<<5|g>>>27)+_+(y^b^v)-899497514|0;_=v;v=b;b=y<<30|y>>>2;y=g;g=k;Pe=Pe+g|0;Oe=Oe+y|0;Be=Be+b|0;Re=Re+v|0;Fe=Fe+_|0}function r(e){e=e|0;I(m[e|0]<<24|m[e|1]<<16|m[e|2]<<8|m[e|3],m[e|4]<<24|m[e|5]<<16|m[e|6]<<8|m[e|7],m[e|8]<<24|m[e|9]<<16|m[e|10]<<8|m[e|11],m[e|12]<<24|m[e|13]<<16|m[e|14]<<8|m[e|15],m[e|16]<<24|m[e|17]<<16|m[e|18]<<8|m[e|19],m[e|20]<<24|m[e|21]<<16|m[e|22]<<8|m[e|23],m[e|24]<<24|m[e|25]<<16|m[e|26]<<8|m[e|27],m[e|28]<<24|m[e|29]<<16|m[e|30]<<8|m[e|31],m[e|32]<<24|m[e|33]<<16|m[e|34]<<8|m[e|35],m[e|36]<<24|m[e|37]<<16|m[e|38]<<8|m[e|39],m[e|40]<<24|m[e|41]<<16|m[e|42]<<8|m[e|43],m[e|44]<<24|m[e|45]<<16|m[e|46]<<8|m[e|47],m[e|48]<<24|m[e|49]<<16|m[e|50]<<8|m[e|51],m[e|52]<<24|m[e|53]<<16|m[e|54]<<8|m[e|55],m[e|56]<<24|m[e|57]<<16|m[e|58]<<8|m[e|59],m[e|60]<<24|m[e|61]<<16|m[e|62]<<8|m[e|63])}function M(e){e=e|0;m[e|0]=Pe>>>24;m[e|1]=Pe>>>16&255;m[e|2]=Pe>>>8&255;m[e|3]=Pe&255;m[e|4]=Oe>>>24;m[e|5]=Oe>>>16&255;m[e|6]=Oe>>>8&255;m[e|7]=Oe&255;m[e|8]=Be>>>24;m[e|9]=Be>>>16&255;m[e|10]=Be>>>8&255;m[e|11]=Be&255;m[e|12]=Re>>>24;m[e|13]=Re>>>16&255;m[e|14]=Re>>>8&255;m[e|15]=Re&255;m[e|16]=Fe>>>24;m[e|17]=Fe>>>16&255;m[e|18]=Fe>>>8&255;m[e|19]=Fe&255}function D(){Pe=1732584193;Oe=4023233417;Be=2562383102;Re=271733878;Fe=3285377520;g=y=0}function a(e,t,n,a,i,r,s){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;r=r|0;s=s|0;Pe=e;Oe=t;Be=n;Re=a;Fe=i;g=r;y=s}function s(e,t){e=e|0;t=t|0;var n=0;if(e&63)return-1;while((t|0)>=64){r(e);e=e+64|0;t=t-64|0;n=n+64|0}g=g+n|0;if(g>>>0<n>>>0)y=y+1|0;return n|0}function l(e,t,n){e=e|0;t=t|0;n=n|0;var a=0,i=0;if(e&63)return-1;if(~n)if(n&31)return-1;if((t|0)>=64){a=s(e,t)|0;if((a|0)==-1)return-1;e=e+a|0;t=t-a|0}a=a+t|0;g=g+t|0;if(g>>>0<t>>>0)y=y+1|0;m[e|t]=128;if((t|0)>=56){for(i=t+1|0;(i|0)<64;i=i+1|0)m[e|i]=0;r(e);t=0;m[e|0]=0}for(i=t+1|0;(i|0)<59;i=i+1|0)m[e|i]=0;m[e|56]=y>>>21&255;m[e|57]=y>>>13&255;m[e|58]=y>>>5&255;m[e|59]=y<<3&255|g>>>29;m[e|60]=g>>>21&255;m[e|61]=g>>>13&255;m[e|62]=g>>>5&255;m[e|63]=g<<3&255;r(e);if(~n)M(n);return a|0}function C(){Pe=b;Oe=v;Be=_;Re=E;Fe=k;g=64;y=0}function x(){Pe=T;Oe=w;Be=A;Re=N;Fe=S;g=64;y=0}function i(e,t,n,a,i,r,s,o,c,l,u,d,f,h,p,m){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;r=r|0;s=s|0;o=o|0;c=c|0;l=l|0;u=u|0;d=d|0;f=f|0;h=h|0;p=p|0;m=m|0;D();I(e^1549556828,t^1549556828,n^1549556828,a^1549556828,i^1549556828,r^1549556828,s^1549556828,o^1549556828,c^1549556828,l^1549556828,u^1549556828,d^1549556828,f^1549556828,h^1549556828,p^1549556828,m^1549556828);T=Pe;w=Oe;A=Be;N=Re;S=Fe;D();I(e^909522486,t^909522486,n^909522486,a^909522486,i^909522486,r^909522486,s^909522486,o^909522486,c^909522486,l^909522486,u^909522486,d^909522486,f^909522486,h^909522486,p^909522486,m^909522486);b=Pe;v=Oe;_=Be;E=Re;k=Fe;g=64;y=0}function P(e,t,n){e=e|0;t=t|0;n=n|0;var a=0,i=0,r=0,s=0,o=0,c=0;if(e&63)return-1;if(~n)if(n&31)return-1;c=l(e,t,-1)|0;a=Pe,i=Oe,r=Be,s=Re,o=Fe;x();I(a,i,r,s,o,2147483648,0,0,0,0,0,0,0,0,0,672);if(~n)M(n);return c|0}function o(e,t,n,a,i){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;var r=0,s=0,o=0,c=0,l=0,u=0,d=0,f=0,h=0,p=0;if(e&63)return-1;if(~i)if(i&31)return-1;m[e+t|0]=n>>>24;m[e+t+1|0]=n>>>16&255;m[e+t+2|0]=n>>>8&255;m[e+t+3|0]=n&255;P(e,t+4|0,-1)|0;r=u=Pe,s=d=Oe,o=f=Be,c=h=Re,l=p=Fe;a=a-1|0;while((a|0)>0){C();I(u,d,f,h,p,2147483648,0,0,0,0,0,0,0,0,0,672);u=Pe,d=Oe,f=Be,h=Re,p=Fe;x();I(u,d,f,h,p,2147483648,0,0,0,0,0,0,0,0,0,672);u=Pe,d=Oe,f=Be,h=Re,p=Fe;r=r^Pe;s=s^Oe;o=o^Be;c=c^Re;l=l^Fe;a=a-1|0}Pe=r;Oe=s;Be=o;Re=c;Fe=l;if(~i)M(i);return 0}return{reset:D,init:a,process:s,finish:l,hmac_reset:C,hmac_init:i,hmac_finish:P,pbkdf2_generate_block:o}}function ee(e){e=e||{},this.heap=s(Uint8Array,e),this.asm=e.asm||$(f,null,this.heap.buffer),this.BLOCK_SIZE=on,this.HASH_SIZE=cn,this.reset()}function te(){return null===un&&(un=new ee({heapSize:1048576})),un}function ne(e){if(void 0===e)throw new SyntaxError("data required");return te().reset().process(e).finish().result}function ae(e){return i(ne(e))}function ie(e){return r(ne(e))}function re(e,t,n){"use asm";var A=0,N=0,S=0,I=0,M=0,D=0,C=0,x=0,g=0,y=0;var b=0,v=0,_=0,E=0,k=0,T=0,w=0,P=0,O=0,B=0,R=0,F=0,L=0,q=0,U=0,J=0;var j=new e.Uint8Array(n);function G(e,t,n,a,i,r,s,o,c,l,u,d,f,h,p,m){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;r=r|0;s=s|0;o=o|0;c=c|0;l=l|0;u=u|0;d=d|0;f=f|0;h=h|0;p=p|0;m=m|0;var g=0,y=0,b=0,v=0,_=0,E=0,k=0,T=0,w=0;g=A;y=N;b=S;v=I;_=M;E=D;k=C;T=x;w=e+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1116352408|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=t+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1899447441|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=n+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3049323471|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=a+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3921009573|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=i+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+961987163|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=r+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1508970993|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=s+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2453635748|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=o+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2870763221|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=c+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3624381080|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=l+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+310598401|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=u+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+607225278|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=d+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1426881987|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=f+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1925078388|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=h+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2162078206|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=p+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2614888103|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;w=m+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3248222580|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;e=w=(t>>>7^t>>>18^t>>>3^t<<25^t<<14)+(p>>>17^p>>>19^p>>>10^p<<15^p<<13)+e+l|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3835390401|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;t=w=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(m>>>17^m>>>19^m>>>10^m<<15^m<<13)+t+u|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+4022224774|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;n=w=(a>>>7^a>>>18^a>>>3^a<<25^a<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+n+d|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+264347078|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;a=w=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(t>>>17^t>>>19^t>>>10^t<<15^t<<13)+a+f|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+604807628|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;i=w=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+i+h|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+770255983|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;r=w=(s>>>7^s>>>18^s>>>3^s<<25^s<<14)+(a>>>17^a>>>19^a>>>10^a<<15^a<<13)+r+p|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1249150122|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;s=w=(o>>>7^o>>>18^o>>>3^o<<25^o<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+s+m|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1555081692|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;o=w=(c>>>7^c>>>18^c>>>3^c<<25^c<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+o+e|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1996064986|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;c=w=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(s>>>17^s>>>19^s>>>10^s<<15^s<<13)+c+t|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2554220882|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;l=w=(u>>>7^u>>>18^u>>>3^u<<25^u<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+l+n|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2821834349|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;u=w=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(c>>>17^c>>>19^c>>>10^c<<15^c<<13)+u+a|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2952996808|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;d=w=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+d+i|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3210313671|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;f=w=(h>>>7^h>>>18^h>>>3^h<<25^h<<14)+(u>>>17^u>>>19^u>>>10^u<<15^u<<13)+f+r|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3336571891|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;h=w=(p>>>7^p>>>18^p>>>3^p<<25^p<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+h+s|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3584528711|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;p=w=(m>>>7^m>>>18^m>>>3^m<<25^m<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+p+o|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+113926993|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;m=w=(e>>>7^e>>>18^e>>>3^e<<25^e<<14)+(h>>>17^h>>>19^h>>>10^h<<15^h<<13)+m+c|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+338241895|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;e=w=(t>>>7^t>>>18^t>>>3^t<<25^t<<14)+(p>>>17^p>>>19^p>>>10^p<<15^p<<13)+e+l|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+666307205|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;t=w=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(m>>>17^m>>>19^m>>>10^m<<15^m<<13)+t+u|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+773529912|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0
;n=w=(a>>>7^a>>>18^a>>>3^a<<25^a<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+n+d|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1294757372|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;a=w=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(t>>>17^t>>>19^t>>>10^t<<15^t<<13)+a+f|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1396182291|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;i=w=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+i+h|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1695183700|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;r=w=(s>>>7^s>>>18^s>>>3^s<<25^s<<14)+(a>>>17^a>>>19^a>>>10^a<<15^a<<13)+r+p|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1986661051|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;s=w=(o>>>7^o>>>18^o>>>3^o<<25^o<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+s+m|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2177026350|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;o=w=(c>>>7^c>>>18^c>>>3^c<<25^c<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+o+e|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2456956037|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;c=w=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(s>>>17^s>>>19^s>>>10^s<<15^s<<13)+c+t|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2730485921|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;l=w=(u>>>7^u>>>18^u>>>3^u<<25^u<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+l+n|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2820302411|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;u=w=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(c>>>17^c>>>19^c>>>10^c<<15^c<<13)+u+a|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3259730800|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;d=w=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+d+i|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3345764771|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;f=w=(h>>>7^h>>>18^h>>>3^h<<25^h<<14)+(u>>>17^u>>>19^u>>>10^u<<15^u<<13)+f+r|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3516065817|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;h=w=(p>>>7^p>>>18^p>>>3^p<<25^p<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+h+s|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3600352804|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;p=w=(m>>>7^m>>>18^m>>>3^m<<25^m<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+p+o|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+4094571909|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;m=w=(e>>>7^e>>>18^e>>>3^e<<25^e<<14)+(h>>>17^h>>>19^h>>>10^h<<15^h<<13)+m+c|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+275423344|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;e=w=(t>>>7^t>>>18^t>>>3^t<<25^t<<14)+(p>>>17^p>>>19^p>>>10^p<<15^p<<13)+e+l|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+430227734|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;t=w=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(m>>>17^m>>>19^m>>>10^m<<15^m<<13)+t+u|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+506948616|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;n=w=(a>>>7^a>>>18^a>>>3^a<<25^a<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+n+d|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+659060556|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;a=w=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(t>>>17^t>>>19^t>>>10^t<<15^t<<13)+a+f|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+883997877|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;i=w=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+i+h|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+958139571|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;r=w=(s>>>7^s>>>18^s>>>3^s<<25^s<<14)+(a>>>17^a>>>19^a>>>10^a<<15^a<<13)+r+p|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1322822218|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;s=w=(o>>>7^o>>>18^o>>>3^o<<25^o<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+s+m|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1537002063|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;o=w=(c>>>7^c>>>18^c>>>3^c<<25^c<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+o+e|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1747873779|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;c=w=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(s>>>17^s>>>19^s>>>10^s<<15^s<<13)+c+t|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+1955562222|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;l=w=(u>>>7^u>>>18^u>>>3^u<<25^u<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+l+n|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2024104815|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;u=w=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(c>>>17^c>>>19^c>>>10^c<<15^c<<13)+u+a|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2227730452|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;d=w=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+d+i|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2361852424|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;f=w=(h>>>7^h>>>18^h>>>3^h<<25^h<<14)+(u>>>17^u>>>19^u>>>10^u<<15^u<<13)+f+r|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2428436474|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;h=w=(p>>>7^p>>>18^p>>>3^p<<25^p<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+h+s|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+2756734187|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;p=w=(m>>>7^m>>>18^m>>>3^m<<25^m<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+p+o|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3204031479|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;m=w=(e>>>7^e>>>18^e>>>3^e<<25^e<<14)+(h>>>17^h>>>19^h>>>10^h<<15^h<<13)+m+c|0;w=w+T+(_>>>6^_>>>11^_>>>25^_<<26^_<<21^_<<7)+(k^_&(E^k))+3329325298|0;T=k;k=E;E=_;_=v+w|0;v=b;b=y;y=g;g=w+(y&b^v&(y^b))+(y>>>2^y>>>13^y>>>22^y<<30^y<<19^y<<10)|0;A=A+g|0;N=N+y|0;S=S+b|0;I=I+v|0;M=M+_|0;D=D+E|0;C=C+k|0;x=x+T|0}function r(e){e=e|0;G(j[e|0]<<24|j[e|1]<<16|j[e|2]<<8|j[e|3],j[e|4]<<24|j[e|5]<<16|j[e|6]<<8|j[e|7],j[e|8]<<24|j[e|9]<<16|j[e|10]<<8|j[e|11],j[e|12]<<24|j[e|13]<<16|j[e|14]<<8|j[e|15],j[e|16]<<24|j[e|17]<<16|j[e|18]<<8|j[e|19],j[e|20]<<24|j[e|21]<<16|j[e|22]<<8|j[e|23],j[e|24]<<24|j[e|25]<<16|j[e|26]<<8|j[e|27],j[e|28]<<24|j[e|29]<<16|j[e|30]<<8|j[e|31],j[e|32]<<24|j[e|33]<<16|j[e|34]<<8|j[e|35],j[e|36]<<24|j[e|37]<<16|j[e|38]<<8|j[e|39],j[e|40]<<24|j[e|41]<<16|j[e|42]<<8|j[e|43],j[e|44]<<24|j[e|45]<<16|j[e|46]<<8|j[e|47],j[e|48]<<24|j[e|49]<<16|j[e|50]<<8|j[e|51],j[e|52]<<24|j[e|53]<<16|j[e|54]<<8|j[e|55],j[e|56]<<24|j[e|57]<<16|j[e|58]<<8|j[e|59],j[e|60]<<24|j[e|61]<<16|j[e|62]<<8|j[e|63])}function H(e){e=e|0;j[e|0]=A>>>24;j[e|1]=A>>>16&255;j[e|2]=A>>>8&255;j[e|3]=A&255;j[e|4]=N>>>24;j[e|5]=N>>>16&255;j[e|6]=N>>>8&255;j[e|7]=N&255;j[e|8]=S>>>24;j[e|9]=S>>>16&255;j[e|10]=S>>>8&255;j[e|11]=S&255;j[e|12]=I>>>24;j[e|13]=I>>>16&255;j[e|14]=I>>>8&255;j[e|15]=I&255;j[e|16]=M>>>24;j[e|17]=M>>>16&255;j[e|18]=M>>>8&255;j[e|19]=M&255;j[e|20]=D>>>24;j[e|21]=D>>>16&255;j[e|22]=D>>>8&255;j[e|23]=D&255;j[e|24]=C>>>24;j[e|25]=C>>>16&255;j[e|26]=C>>>8&255;j[e|27]=C&255;j[e|28]=x>>>24;j[e|29]=x>>>16&255;j[e|30]=x>>>8&255;j[e|31]=x&255}function z(){A=1779033703;N=3144134277;S=1013904242;I=2773480762;M=1359893119;D=2600822924;C=528734635;x=1541459225;g=y=0}function a(e,t,n,a,i,r,s,o,c,l){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;r=r|0;s=s|0;o=o|0;c=c|0;l=l|0;A=e;N=t;S=n;I=a;M=i;D=r;C=s;x=o;g=c;y=l}function s(e,t){e=e|0;t=t|0;var n=0;if(e&63)return-1;while((t|0)>=64){r(e);e=e+64|0;t=t-64|0;n=n+64|0}g=g+n|0;if(g>>>0<n>>>0)y=y+1|0;return n|0}function f(e,t,n){e=e|0;t=t|0;n=n|0;var a=0,i=0;if(e&63)return-1;if(~n)if(n&31)return-1;if((t|0)>=64){a=s(e,t)|0;if((a|0)==-1)return-1;e=e+a|0;t=t-a|0}a=a+t|0;g=g+t|0;if(g>>>0<t>>>0)y=y+1|0;j[e|t]=128;if((t|0)>=56){for(i=t+1|0;(i|0)<64;i=i+1|0)j[e|i]=0;r(e);t=0;j[e|0]=0}for(i=t+1|0;(i|0)<59;i=i+1|0)j[e|i]=0;j[e|56]=y>>>21&255;j[e|57]=y>>>13&255;j[e|58]=y>>>5&255;j[e|59]=y<<3&255|g>>>29;j[e|60]=g>>>21&255;j[e|61]=g>>>13&255;j[e|62]=g>>>5&255;j[e|63]=g<<3&255;r(e);if(~n)H(n);return a|0}function W(){A=b;N=v;S=_;I=E;M=k;D=T;C=w;x=P;g=64;y=0}function V(){A=O;N=B;S=R;I=F;M=L;D=q;C=U;x=J;g=64;y=0}function i(e,t,n,a,i,r,s,o,c,l,u,d,f,h,p,m){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;r=r|0;s=s|0;o=o|0;c=c|0;l=l|0;u=u|0;d=d|0;f=f|0;h=h|0;p=p|0;m=m|0;z();G(e^1549556828,t^1549556828,n^1549556828,a^1549556828,i^1549556828,r^1549556828,s^1549556828,o^1549556828,c^1549556828,l^1549556828,u^1549556828,d^1549556828,f^1549556828,h^1549556828,p^1549556828,m^1549556828);O=A;B=N;R=S;F=I;L=M;q=D;U=C;J=x;z();G(e^909522486,t^909522486,n^909522486,a^909522486,i^909522486,r^909522486,s^909522486,o^909522486,c^909522486,l^909522486,u^909522486,d^909522486,f^909522486,h^909522486,p^909522486,m^909522486);b=A;v=N;_=S;E=I;k=M;T=D;w=C;P=x;g=64;y=0}function X(e,t,n){e=e|0;t=t|0;n=n|0;var a=0,i=0,r=0,s=0,o=0,c=0,l=0,u=0,d=0;if(e&63)return-1;if(~n)if(n&31)return-1;d=f(e,t,-1)|0;a=A,i=N,r=S,s=I,o=M,c=D,l=C,u=x;V();G(a,i,r,s,o,c,l,u,2147483648,0,0,0,0,0,0,768);if(~n)H(n);return d|0}function o(e,t,n,a,i){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;var r=0,s=0,o=0,c=0,l=0,u=0,d=0,f=0,h=0,p=0,m=0,g=0,y=0,b=0,v=0,_=0;if(e&63)return-1;if(~i)if(i&31)return-1;j[e+t|0]=n>>>24;j[e+t+1|0]=n>>>16&255;j[e+t+2|0]=n>>>8&255;j[e+t+3|0]=n&255;X(e,t+4|0,-1)|0;r=h=A,s=p=N,o=m=S,c=g=I,l=y=M,u=b=D,d=v=C,f=_=x;a=a-1|0;while((a|0)>0){W();G(h,p,m,g,y,b,v,_,2147483648,0,0,0,0,0,0,768);h=A,p=N,m=S,g=I,y=M,b=D,v=C,_=x;V();G(h,p,m,g,y,b,v,_,2147483648,0,0,0,0,0,0,768);h=A,p=N,m=S,g=I,y=M,b=D,v=C,_=x;r=r^A;s=s^N;o=o^S;c=c^I;l=l^M;u=u^D;d=d^C;f=f^x;a=a-1|0}A=r;N=s;S=o;I=c;M=l;D=u;C=d;x=f;if(~i)H(i);return 0}return{reset:z,init:a,process:s,finish:f,hmac_reset:W,hmac_init:i,hmac_finish:X,pbkdf2_generate_block:o}}function se(e){e=e||{},this.heap=s(Uint8Array,e),this.asm=e.asm||re(f,null,this.heap.buffer),this.BLOCK_SIZE=dn,this.HASH_SIZE=fn,this.reset()}function oe(){return null===pn&&(pn=new se({heapSize:1048576})),pn}function ce(e){if(void 0===e)throw new SyntaxError("data required");return oe().reset().process(e).finish().result}function le(e){return i(ce(e))}function ue(e){return r(ce(e))}function de(e){if(!(e=e||{}).hash)throw new SyntaxError("option 'hash' is required");if(!e.hash.HASH_SIZE)throw new SyntaxError("option 'hash' supplied doesn't seem to be a valid hash function");return this.hash=e.hash,this.BLOCK_SIZE=this.hash.BLOCK_SIZE,this.HMAC_SIZE=this.hash.HASH_SIZE,this.key=null,this.verify=null,this.result=null,(void 0!==e.password||void 0!==e.verify)&&this.reset(e),this}function fe(e,t){if(k(t)&&(t=new Uint8Array(t)),E(t)&&(t=y(t)),!m(t))throw new TypeError("password isn't of expected type");var n=new Uint8Array(e.BLOCK_SIZE);return t.length>e.BLOCK_SIZE?n.set(e.reset().process(t).finish().result):n.set(t),n}function he(e){if(k(e)||m(e))e=new Uint8Array(e);else{if(!E(e))throw new TypeError("verify tag isn't of expected type");e=y(e)}if(e.length!==this.HMAC_SIZE)throw new p("illegal verification tag size");this.verify=e}function pe(e){var t=(e=e||{}).password;if(null===this.key&&!E(t)&&!t)throw new b("no key is associated with the instance");this.result=null,this.hash.reset(),(t||E(t))&&(this.key=fe(this.hash,t));for(var n=new Uint8Array(this.key),a=0;a<n.length;++a)n[a]^=54;this.hash.process(n);var i=e.verify;return void 0!==i?he.call(this,i):this.verify=null,this}function me(e){if(null===this.key)throw new b("no key is associated with the instance");if(null!==this.result)throw new b("state must be reset before processing new data");return this.hash.process(e),this}function ge(){if(null===this.key)throw new b("no key is associated with the instance");if(null!==this.result)throw new b("state must be reset before processing new data");for(var e=this.hash.finish().result,t=new Uint8Array(this.key),n=0;n<t.length;++n)t[n]^=92;var a=this.verify,i=this.hash.reset().process(t).process(e).finish().result;if(a)if(a.length===i.length){var r=0;for(n=0;n<a.length;n++)r|=a[n]^i[n];this.result=!r}else this.result=!1;else this.result=i;return this}function ye(e){return(e=e||{}).hash instanceof ee||(e.hash=te()),de.call(this,e),this}function be(e){e=e||{},this.result=null,this.hash.reset();var t=e.password;if(void 0!==t){E(t)&&(t=y(t));var n=this.key=fe(this.hash,t);this.hash.reset().asm.hmac_init(n[0]<<24|n[1]<<16|n[2]<<8|n[3],n[4]<<24|n[5]<<16|n[6]<<8|n[7],n[8]<<24|n[9]<<16|n[10]<<8|n[11],n[12]<<24|n[13]<<16|n[14]<<8|n[15],n[16]<<24|n[17]<<16|n[18]<<8|n[19],n[20]<<24|n[21]<<16|n[22]<<8|n[23],n[24]<<24|n[25]<<16|n[26]<<8|n[27],n[28]<<24|n[29]<<16|n[30]<<8|n[31],n[32]<<24|n[33]<<16|n[34]<<8|n[35],n[36]<<24|n[37]<<16|n[38]<<8|n[39],n[40]<<24|n[41]<<16|n[42]<<8|n[43],n[44]<<24|n[45]<<16|n[46]<<8|n[47],n[48]<<24|n[49]<<16|n[50]<<8|n[51],n[52]<<24|n[53]<<16|n[54]<<8|n[55],n[56]<<24|n[57]<<16|n[58]<<8|n[59],n[60]<<24|n[61]<<16|n[62]<<8|n[63])}else this.hash.asm.hmac_reset();var a=e.verify;return void 0!==a?he.call(this,a):this.verify=null,this}function ve(){if(null===this.key)throw new b("no key is associated with the instance");if(null!==this.result)throw new b("state must be reset before processing new data");var e=this.hash,t=this.hash.asm,n=this.hash.heap;t.hmac_finish(e.pos,e.len,0);var a=this.verify,i=new Uint8Array(cn);if(i.set(n.subarray(0,cn)),a)if(a.length===i.length){for(var r=0,s=0;s<a.length;s++)r|=a[s]^i[s];this.result=!r}else this.result=!1;else this.result=i;return this}function _e(){return null===yn&&(yn=new ye),yn}function Ee(e){return(e=e||{}).hash instanceof se||(e.hash=oe()),de.call(this,e),this}function ke(e){e=e||{},this.result=null,this.hash.reset();var t=e.password;if(void 0!==t){E(t)&&(t=y(t));var n=this.key=fe(this.hash,t);this.hash.reset().asm.hmac_init(n[0]<<24|n[1]<<16|n[2]<<8|n[3],n[4]<<24|n[5]<<16|n[6]<<8|n[7],n[8]<<24|n[9]<<16|n[10]<<8|n[11],n[12]<<24|n[13]<<16|n[14]<<8|n[15],n[16]<<24|n[17]<<16|n[18]<<8|n[19],n[20]<<24|n[21]<<16|n[22]<<8|n[23],n[24]<<24|n[25]<<16|n[26]<<8|n[27],n[28]<<24|n[29]<<16|n[30]<<8|n[31],n[32]<<24|n[33]<<16|n[34]<<8|n[35],n[36]<<24|n[37]<<16|n[38]<<8|n[39],n[40]<<24|n[41]<<16|n[42]<<8|n[43],n[44]<<24|n[45]<<16|n[46]<<8|n[47],n[48]<<24|n[49]<<16|n[50]<<8|n[51],n[52]<<24|n[53]<<16|n[54]<<8|n[55],n[56]<<24|n[57]<<16|n[58]<<8|n[59],n[60]<<24|n[61]<<16|n[62]<<8|n[63])}else this.hash.asm.hmac_reset();var a=e.verify;return void 0!==a?he.call(this,a):this.verify=null,this}function Te(){if(null===this.key)throw new b("no key is associated with the instance");if(null!==this.result)throw new b("state must be reset before processing new data");var e=this.hash,t=this.hash.asm,n=this.hash.heap;t.hmac_finish(e.pos,e.len,0);var a=this.verify,i=new Uint8Array(fn);if(i.set(n.subarray(0,fn)),a)if(a.length===i.length){for(var r=0,s=0;s<a.length;s++)r|=a[s]^i[s];this.result=!r}else this.result=!1;else this.result=i;return this}function we(){return null===vn&&(vn=new Ee),vn}function Ae(e,t){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("password required");return _e().reset({password:t}).process(e).finish().result}function Ne(e,t){return i(Ae(e,t))}function Se(e,t){return r(Ae(e,t))}function Ie(e,t){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("password required");return we().reset({password:t}).process(e).finish().result}function Me(e,t){return i(Ie(e,t))}function De(e,t){return r(Ie(e,t))}function Ce(e){if(!(e=e||{}).hmac)throw new SyntaxError("option 'hmac' is required");if(!e.hmac.HMAC_SIZE)throw new SyntaxError("option 'hmac' supplied doesn't seem to be a valid HMAC function");this.hmac=e.hmac,this.count=e.count||4096,this.length=e.length||this.hmac.HMAC_SIZE,this.result=null;var t=e.password;return(t||E(t))&&this.reset(e),this}function xe(e){return this.result=null,this.hmac.reset(e),this}function Pe(e,t,n){if(null!==this.result)throw new b("state must be reset before processing new data");if(!e&&!E(e))throw new p("bad 'salt' value");t=t||this.count,n=n||this.length,this.result=new Uint8Array(n);for(var a=Math.ceil(n/this.hmac.HMAC_SIZE),i=1;i<=a;++i){var r=(i-1)*this.hmac.HMAC_SIZE,s=(i<a?0:n%this.hmac.HMAC_SIZE)||this.hmac.HMAC_SIZE,o=new Uint8Array(this.hmac.reset().process(e).process(new Uint8Array([i>>>24&255,i>>>16&255,i>>>8&255,255&i])).finish().result);this.result.set(o.subarray(0,s),r);for(var c=1;c<t;++c){o=new Uint8Array(this.hmac.reset().process(o).finish().result);for(var l=0;l<s;++l)this.result[r+l]^=o[l]}}return this}function Oe(e){return(e=e||{}).hmac instanceof ye||(e.hmac=_e()),Ce.call(this,e),this}function Be(e,t,n){if(null!==this.result)throw new b("state must be reset before processing new data");if(!e&&!E(e))throw new p("bad 'salt' value");t=t||this.count,n=n||this.length,this.result=new Uint8Array(n);for(var a=Math.ceil(n/this.hmac.HMAC_SIZE),i=1;i<=a;++i){var r=(i-1)*this.hmac.HMAC_SIZE,s=(i<a?0:n%this.hmac.HMAC_SIZE)||this.hmac.HMAC_SIZE;this.hmac.reset().process(e),this.hmac.hash.asm.pbkdf2_generate_block(this.hmac.hash.pos,this.hmac.hash.len,i,t,0),this.result.set(this.hmac.hash.heap.subarray(0,s),r)}return this}function Re(){return null===kn&&(kn=new Oe),kn}function Fe(e){return(e=e||{}).hmac instanceof Ee||(e.hmac=we()),Ce.call(this,e),this}function Le(e,t,n){if(null!==this.result)throw new b("state must be reset before processing new data");if(!e&&!E(e))throw new p("bad 'salt' value");t=t||this.count,n=n||this.length,this.result=new Uint8Array(n);for(var a=Math.ceil(n/this.hmac.HMAC_SIZE),i=1;i<=a;++i){var r=(i-1)*this.hmac.HMAC_SIZE,s=(i<a?0:n%this.hmac.HMAC_SIZE)||this.hmac.HMAC_SIZE;this.hmac.reset().process(e),this.hmac.hash.asm.pbkdf2_generate_block(this.hmac.hash.pos,this.hmac.hash.len,i,t,0),this.result.set(this.hmac.hash.heap.subarray(0,s),r)}return this}function qe(){return null===wn&&(wn=new Fe),wn}function Ue(e,t,n,a){if(void 0===e)throw new SyntaxError("password required");if(void 0===t)throw new SyntaxError("salt required");return Re().reset({password:e}).generate(t,n,a).result}function Je(e,t,n,a){return i(Ue(e,t,n,a))}function je(e,t,n,a){return r(Ue(e,t,n,a))}function Ge(e,t,n,a){if(void 0===e)throw new SyntaxError("password required");if(void 0===t)throw new SyntaxError("salt required");return qe().reset({password:e}).generate(t,n,a).result}function He(e,t,n,a){return i(Ge(e,t,n,a))}function ze(e,t,n,a){return r(Ge(e,t,n,a))}function We(){if(void 0!==Dn)n=new Uint8Array(32),An.call(Dn,n),On(n);else{var e,t,n=new Wt(3);n[0]=In(),n[1]=Sn(),n[2]=Cn(),n=new Uint8Array(n.buffer);var a=qe();for(e=0;e<100;e++)n=a.reset({password:n}).generate(f.location.href,1e3,32).result,t=Cn(),n[0]^=t>>>24,n[1]^=t>>>16,n[2]^=t>>>8,n[3]^=t;On(n)}Rn=!(Bn=0)}function Ve(e){if(!k(e)&&!o(e))throw new TypeError("bad seed type");var t=e.byteOffest||0,n=e.byteLength||e.length,a=new Uint8Array(e.buffer||e,t,n);On(a);for(var i=Bn=0,r=0;r<a.length;r++)i|=a[r],a[r]=0;return 0!==i&&(Ln+=4*n),Fn=qn<=Ln}function Xe(e){if(Rn||We(),!Fn&&void 0===Dn){if(!Un)throw new v("No strong PRNGs available. Use asmCrypto.random.seed().");void 0!==Vt&&Vt.error("No strong PRNGs available; your security is greatly lowered. Use asmCrypto.random.seed().")}if(!Jn&&!Fn&&void 0!==Dn&&void 0!==Vt){var t=(new Error).stack;jn[t]|=0,jn[t]++||Vt.warn("asmCrypto PRNG not seeded; your security relies on your system PRNG. If this is not acceptable, use asmCrypto.random.seed().")}if(!k(e)&&!o(e))throw new TypeError("unexpected buffer type");var n,a,i=e.byteOffset||0,r=e.byteLength||e.length,s=new Uint8Array(e.buffer||e,i,r);for(void 0!==Dn&&An.call(Dn,s),n=0;n<r;n++)0==(3&n)&&(1099511627776<=Bn&&We(),a=Pn(),Bn++),s[n]^=a,a>>>=8;return e}function Ke(){(!Rn||1099511627776<=Bn)&&We();var e=(1048576*Pn()+(Pn()>>>12))/4503599627370496;return Bn+=2,e}function Ze(e,t){return e*t|0}function Qe(e,t,n){"use asm";var a=0;var he=new e.Uint32Array(n);var pe=e.Math.imul;function i(e){e=e|0;a=e=e+31&-32;return e|0}function _(e){e=e|0;var t=0;t=a;a=t+(e+31&-32)|0;return t|0}function E(e){e=e|0;a=a-(e+31&-32)|0}function k(e,t,n){e=e|0;t=t|0;n=n|0;var a=0;if((t|0)>(n|0)){for(;(a|0)<(e|0);a=a+4|0){he[n+a>>2]=he[t+a>>2]}}else{for(a=e-4|0;(a|0)>=0;a=a-4|0){he[n+a>>2]=he[t+a>>2]}}}function T(e,t,n){e=e|0;t=t|0;n=n|0;var a=0;for(;(a|0)<(e|0);a=a+4|0){he[n+a>>2]=t}}function r(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;var i=0,r=0,s=0,o=0,c=0;if((a|0)<=0)a=t;if((a|0)<(t|0))t=a;r=1;for(;(c|0)<(t|0);c=c+4|0){i=~he[e+c>>2];s=(i&65535)+r|0;o=(i>>>16)+(s>>>16)|0;he[n+c>>2]=o<<16|s&65535;r=o>>>16}for(;(c|0)<(a|0);c=c+4|0){he[n+c>>2]=r-1|0}return r|0}function w(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;var i=0,r=0,s=0;if((t|0)>(a|0)){for(s=t-4|0;(s|0)>=(a|0);s=s-4|0){if(he[e+s>>2]|0)return 1}}else{for(s=a-4|0;(s|0)>=(t|0);s=s-4|0){if(he[n+s>>2]|0)return-1}}for(;(s|0)>=0;s=s-4|0){i=he[e+s>>2]|0,r=he[n+s>>2]|0;if(i>>>0<r>>>0)return-1;if(i>>>0>r>>>0)return 1}return 0}function s(e,t){e=e|0;t=t|0;var n=0;for(n=t-4|0;(n|0)>=0;n=n-4|0){if(he[e+n>>2]|0)return n+4|0}return 0}function o(e,t,n,a,i,r){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;r=r|0;var s=0,o=0,c=0,l=0,u=0,d=0;if((t|0)<(a|0)){l=e,e=n,n=l;l=t,t=a,a=l}if((r|0)<=0)r=t+4|0;if((r|0)<(a|0))t=a=r;for(;(d|0)<(a|0);d=d+4|0){s=he[e+d>>2]|0;o=he[n+d>>2]|0;l=((s&65535)+(o&65535)|0)+c|0;u=((s>>>16)+(o>>>16)|0)+(l>>>16)|0;he[i+d>>2]=l&65535|u<<16;c=u>>>16}for(;(d|0)<(t|0);d=d+4|0){s=he[e+d>>2]|0;l=(s&65535)+c|0;u=(s>>>16)+(l>>>16)|0;he[i+d>>2]=l&65535|u<<16;c=u>>>16}for(;(d|0)<(r|0);d=d+4|0){he[i+d>>2]=c|0;c=0}return c|0}function A(e,t,n,a,i,r){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;r=r|0;var s=0,o=0,c=0,l=0,u=0,d=0;if((r|0)<=0)r=(t|0)>(a|0)?t+4|0:a+4|0;if((r|0)<(t|0))t=r;if((r|0)<(a|0))a=r;if((t|0)<(a|0)){for(;(d|0)<(t|0);d=d+4|0){s=he[e+d>>2]|0;o=he[n+d>>2]|0;l=((s&65535)-(o&65535)|0)+c|0;u=((s>>>16)-(o>>>16)|0)+(l>>16)|0;he[i+d>>2]=l&65535|u<<16;c=u>>16}for(;(d|0)<(a|0);d=d+4|0){o=he[n+d>>2]|0;l=c-(o&65535)|0;u=(l>>16)-(o>>>16)|0;he[i+d>>2]=l&65535|u<<16;c=u>>16}}else{for(;(d|0)<(a|0);d=d+4|0){s=he[e+d>>2]|0;o=he[n+d>>2]|0;l=((s&65535)-(o&65535)|0)+c|0;u=((s>>>16)-(o>>>16)|0)+(l>>16)|0;he[i+d>>2]=l&65535|u<<16;c=u>>16}for(;(d|0)<(t|0);d=d+4|0){s=he[e+d>>2]|0;l=(s&65535)+c|0;u=(s>>>16)+(l>>16)|0;he[i+d>>2]=l&65535|u<<16;c=u>>16}}for(;(d|0)<(r|0);d=d+4|0){he[i+d>>2]=c|0}return c|0}function c(e,t,n,a,i,r){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;r=r|0;var s=0,o=0,c=0,l=0,u=0,d=0,f=0,h=0,p=0,m=0,g=0,y=0,b=0,v=0,_=0,E=0,k=0,T=0,w=0,A=0,N=0,S=0,I=0,M=0,D=0,C=0,x=0,P=0,O=0,B=0,R=0,F=0,L=0,q=0,U=0,J=0,j=0,G=0,H=0,z=0,W=0,V=0,X=0,K=0,Z=0,Q=0,Y=0,$=0,ee=0,te=0,ne=0,ae=0,ie=0,re=0,se=0,oe=0,ce=0;if((t|0)>(a|0)){ee=e,te=t;e=n,t=a;n=ee,a=te}ae=t+a|0;if((r|0)>(ae|0)|(r|0)<=0)r=ae;if((r|0)<(t|0))t=r;if((r|0)<(a|0))a=r;for(;(ie|0)<(t|0);ie=ie+32|0){re=e+ie|0;p=he[(re|0)>>2]|0,m=he[(re|4)>>2]|0,g=he[(re|8)>>2]|0,y=he[(re|12)>>2]|0,b=he[(re|16)>>2]|0,v=he[(re|20)>>2]|0,_=he[(re|24)>>2]|0,E=he[(re|28)>>2]|0,s=p&65535,o=m&65535,c=g&65535,l=y&65535,u=b&65535,d=v&65535,f=_&65535,h=E&65535,p=p>>>16,m=m>>>16,g=g>>>16,y=y>>>16,b=b>>>16,v=v>>>16,_=_>>>16,E=E>>>16;W=V=X=K=Z=Q=Y=$=0;for(se=0;(se|0)<(a|0);se=se+32|0){oe=n+se|0;ce=i+(ie+se|0)|0;D=he[(oe|0)>>2]|0,C=he[(oe|4)>>2]|0,x=he[(oe|8)>>2]|0,P=he[(oe|12)>>2]|0,O=he[(oe|16)>>2]|0,B=he[(oe|20)>>2]|0,R=he[(oe|24)>>2]|0,F=he[(oe|28)>>2]|0,k=D&65535,T=C&65535,w=x&65535,A=P&65535,N=O&65535,S=B&65535,I=R&65535,M=F&65535,D=D>>>16,C=C>>>16,x=x>>>16,P=P>>>16,O=O>>>16,B=B>>>16,R=R>>>16,F=F>>>16;L=he[(ce|0)>>2]|0,q=he[(ce|4)>>2]|0,U=he[(ce|8)>>2]|0,J=he[(ce|12)>>2]|0,j=he[(ce|16)>>2]|0,G=he[(ce|20)>>2]|0,H=he[(ce|24)>>2]|0,z=he[(ce|28)>>2]|0;ee=((pe(s,k)|0)+(W&65535)|0)+(L&65535)|0;te=((pe(p,k)|0)+(W>>>16)|0)+(L>>>16)|0;ne=((pe(s,D)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(p,D)|0)+(te>>>16)|0)+(ne>>>16)|0;L=ne<<16|ee&65535;ee=((pe(s,T)|0)+(ae&65535)|0)+(q&65535)|0;te=((pe(p,T)|0)+(ae>>>16)|0)+(q>>>16)|0;ne=((pe(s,C)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(p,C)|0)+(te>>>16)|0)+(ne>>>16)|0;q=ne<<16|ee&65535;ee=((pe(s,w)|0)+(ae&65535)|0)+(U&65535)|0;te=((pe(p,w)|0)+(ae>>>16)|0)+(U>>>16)|0;ne=((pe(s,x)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(p,x)|0)+(te>>>16)|0)+(ne>>>16)|0;U=ne<<16|ee&65535;ee=((pe(s,A)|0)+(ae&65535)|0)+(J&65535)|0;te=((pe(p,A)|0)+(ae>>>16)|0)+(J>>>16)|0;ne=((pe(s,P)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(p,P)|0)+(te>>>16)|0)+(ne>>>16)|0;J=ne<<16|ee&65535;ee=((pe(s,N)|0)+(ae&65535)|0)+(j&65535)|0;te=((pe(p,N)|0)+(ae>>>16)|0)+(j>>>16)|0;ne=((pe(s,O)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(p,O)|0)+(te>>>16)|0)+(ne>>>16)|0;j=ne<<16|ee&65535;ee=((pe(s,S)|0)+(ae&65535)|0)+(G&65535)|0;te=((pe(p,S)|0)+(ae>>>16)|0)+(G>>>16)|0;ne=((pe(s,B)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(p,B)|0)+(te>>>16)|0)+(ne>>>16)|0;G=ne<<16|ee&65535;ee=((pe(s,I)|0)+(ae&65535)|0)+(H&65535)|0;te=((pe(p,I)|0)+(ae>>>16)|0)+(H>>>16)|0;ne=((pe(s,R)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(p,R)|0)+(te>>>16)|0)+(ne>>>16)|0;H=ne<<16|ee&65535;ee=((pe(s,M)|0)+(ae&65535)|0)+(z&65535)|0;te=((pe(p,M)|0)+(ae>>>16)|0)+(z>>>16)|0;ne=((pe(s,F)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(p,F)|0)+(te>>>16)|0)+(ne>>>16)|0;z=ne<<16|ee&65535;W=ae;ee=((pe(o,k)|0)+(V&65535)|0)+(q&65535)|0;te=((pe(m,k)|0)+(V>>>16)|0)+(q>>>16)|0;ne=((pe(o,D)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(m,D)|0)+(te>>>16)|0)+(ne>>>16)|0;q=ne<<16|ee&65535;ee=((pe(o,T)|0)+(ae&65535)|0)+(U&65535)|0;te=((pe(m,T)|0)+(ae>>>16)|0)+(U>>>16)|0;ne=((pe(o,C)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(m,C)|0)+(te>>>16)|0)+(ne>>>16)|0;U=ne<<16|ee&65535;ee=((pe(o,w)|0)+(ae&65535)|0)+(J&65535)|0;te=((pe(m,w)|0)+(ae>>>16)|0)+(J>>>16)|0;ne=((pe(o,x)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(m,x)|0)+(te>>>16)|0)+(ne>>>16)|0;J=ne<<16|ee&65535;ee=((pe(o,A)|0)+(ae&65535)|0)+(j&65535)|0;te=((pe(m,A)|0)+(ae>>>16)|0)+(j>>>16)|0;ne=((pe(o,P)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(m,P)|0)+(te>>>16)|0)+(ne>>>16)|0;j=ne<<16|ee&65535;ee=((pe(o,N)|0)+(ae&65535)|0)+(G&65535)|0;te=((pe(m,N)|0)+(ae>>>16)|0)+(G>>>16)|0;ne=((pe(o,O)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(m,O)|0)+(te>>>16)|0)+(ne>>>16)|0;G=ne<<16|ee&65535;ee=((pe(o,S)|0)+(ae&65535)|0)+(H&65535)|0;te=((pe(m,S)|0)+(ae>>>16)|0)+(H>>>16)|0;ne=((pe(o,B)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(m,B)|0)+(te>>>16)|0)+(ne>>>16)|0;H=ne<<16|ee&65535;ee=((pe(o,I)|0)+(ae&65535)|0)+(z&65535)|0;te=((pe(m,I)|0)+(ae>>>16)|0)+(z>>>16)|0;ne=((pe(o,R)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(m,R)|0)+(te>>>16)|0)+(ne>>>16)|0;z=ne<<16|ee&65535;ee=((pe(o,M)|0)+(ae&65535)|0)+(W&65535)|0;te=((pe(m,M)|0)+(ae>>>16)|0)+(W>>>16)|0;ne=((pe(o,F)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(m,F)|0)+(te>>>16)|0)+(ne>>>16)|0;W=ne<<16|ee&65535;V=ae;ee=((pe(c,k)|0)+(X&65535)|0)+(U&65535)|0;te=((pe(g,k)|0)+(X>>>16)|0)+(U>>>16)|0;ne=((pe(c,D)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(g,D)|0)+(te>>>16)|0)+(ne>>>16)|0;U=ne<<16|ee&65535;ee=((pe(c,T)|0)+(ae&65535)|0)+(J&65535)|0;te=((pe(g,T)|0)+(ae>>>16)|0)+(J>>>16)|0;ne=((pe(c,C)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(g,C)|0)+(te>>>16)|0)+(ne>>>16)|0;J=ne<<16|ee&65535;ee=((pe(c,w)|0)+(ae&65535)|0)+(j&65535)|0;te=((pe(g,w)|0)+(ae>>>16)|0)+(j>>>16)|0;ne=((pe(c,x)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(g,x)|0)+(te>>>16)|0)+(ne>>>16)|0;j=ne<<16|ee&65535;ee=((pe(c,A)|0)+(ae&65535)|0)+(G&65535)|0;te=((pe(g,A)|0)+(ae>>>16)|0)+(G>>>16)|0;ne=((pe(c,P)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(g,P)|0)+(te>>>16)|0)+(ne>>>16)|0;G=ne<<16|ee&65535;ee=((pe(c,N)|0)+(ae&65535)|0)+(H&65535)|0;te=((pe(g,N)|0)+(ae>>>16)|0)+(H>>>16)|0;ne=((pe(c,O)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(g,O)|0)+(te>>>16)|0)+(ne>>>16)|0;H=ne<<16|ee&65535;ee=((pe(c,S)|0)+(ae&65535)|0)+(z&65535)|0;te=((pe(g,S)|0)+(ae>>>16)|0)+(z>>>16)|0;ne=((pe(c,B)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(g,B)|0)+(te>>>16)|0)+(ne>>>16)|0;z=ne<<16|ee&65535;ee=((pe(c,I)|0)+(ae&65535)|0)+(W&65535)|0;te=((pe(g,I)|0)+(ae>>>16)|0)+(W>>>16)|0;ne=((pe(c,R)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(g,R)|0)+(te>>>16)|0)+(ne>>>16)|0;W=ne<<16|ee&65535;ee=((pe(c,M)|0)+(ae&65535)|0)+(V&65535)|0;te=((pe(g,M)|0)+(ae>>>16)|0)+(V>>>16)|0;ne=((pe(c,F)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(g,F)|0)+(te>>>16)|0)+(ne>>>16)|0;V=ne<<16|ee&65535;X=ae;ee=((pe(l,k)|0)+(K&65535)|0)+(J&65535)|0;te=((pe(y,k)|0)+(K>>>16)|0)+(J>>>16)|0;ne=((pe(l,D)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(y,D)|0)+(te>>>16)|0)+(ne>>>16)|0;J=ne<<16|ee&65535;ee=((pe(l,T)|0)+(ae&65535)|0)+(j&65535)|0;te=((pe(y,T)|0)+(ae>>>16)|0)+(j>>>16)|0;ne=((pe(l,C)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(y,C)|0)+(te>>>16)|0)+(ne>>>16)|0;j=ne<<16|ee&65535;ee=((pe(l,w)|0)+(ae&65535)|0)+(G&65535)|0;te=((pe(y,w)|0)+(ae>>>16)|0)+(G>>>16)|0;ne=((pe(l,x)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(y,x)|0)+(te>>>16)|0)+(ne>>>16)|0;G=ne<<16|ee&65535;ee=((pe(l,A)|0)+(ae&65535)|0)+(H&65535)|0;te=((pe(y,A)|0)+(ae>>>16)|0)+(H>>>16)|0;ne=((pe(l,P)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(y,P)|0)+(te>>>16)|0)+(ne>>>16)|0;H=ne<<16|ee&65535;ee=((pe(l,N)|0)+(ae&65535)|0)+(z&65535)|0;te=((pe(y,N)|0)+(ae>>>16)|0)+(z>>>16)|0;ne=((pe(l,O)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(y,O)|0)+(te>>>16)|0)+(ne>>>16)|0;z=ne<<16|ee&65535;ee=((pe(l,S)|0)+(ae&65535)|0)+(W&65535)|0;te=((pe(y,S)|0)+(ae>>>16)|0)+(W>>>16)|0;ne=((pe(l,B)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(y,B)|0)+(te>>>16)|0)+(ne>>>16)|0;W=ne<<16|ee&65535;ee=((pe(l,I)|0)+(ae&65535)|0)+(V&65535)|0;te=((pe(y,I)|0)+(ae>>>16)|0)+(V>>>16)|0;ne=((pe(l,R)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(y,R)|0)+(te>>>16)|0)+(ne>>>16)|0;V=ne<<16|ee&65535;ee=((pe(l,M)|0)+(ae&65535)|0)+(X&65535)|0;te=((pe(y,M)|0)+(ae>>>16)|0)+(X>>>16)|0;ne=((pe(l,F)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(y,F)|0)+(te>>>16)|0)+(ne>>>16)|0;X=ne<<16|ee&65535;K=ae;ee=((pe(u,k)|0)+(Z&65535)|0)+(j&65535)|0;te=((pe(b,k)|0)+(Z>>>16)|0)+(j>>>16)|0;ne=((pe(u,D)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(b,D)|0)+(te>>>16)|0)+(ne>>>16)|0;j=ne<<16|ee&65535;ee=((pe(u,T)|0)+(ae&65535)|0)+(G&65535)|0;te=((pe(b,T)|0)+(ae>>>16)|0)+(G>>>16)|0;ne=((pe(u,C)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(b,C)|0)+(te>>>16)|0)+(ne>>>16)|0;G=ne<<16|ee&65535;ee=((pe(u,w)|0)+(ae&65535)|0)+(H&65535)|0;te=((pe(b,w)|0)+(ae>>>16)|0)+(H>>>16)|0;ne=((pe(u,x)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(b,x)|0)+(te>>>16)|0)+(ne>>>16)|0;H=ne<<16|ee&65535;ee=((pe(u,A)|0)+(ae&65535)|0)+(z&65535)|0;te=((pe(b,A)|0)+(ae>>>16)|0)+(z>>>16)|0;ne=((pe(u,P)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(b,P)|0)+(te>>>16)|0)+(ne>>>16)|0;z=ne<<16|ee&65535;ee=((pe(u,N)|0)+(ae&65535)|0)+(W&65535)|0;te=((pe(b,N)|0)+(ae>>>16)|0)+(W>>>16)|0;ne=((pe(u,O)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(b,O)|0)+(te>>>16)|0)+(ne>>>16)|0;W=ne<<16|ee&65535;ee=((pe(u,S)|0)+(ae&65535)|0)+(V&65535)|0;te=((pe(b,S)|0)+(ae>>>16)|0)+(V>>>16)|0;ne=((pe(u,B)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(b,B)|0)+(te>>>16)|0)+(ne>>>16)|0;V=ne<<16|ee&65535;ee=((pe(u,I)|0)+(ae&65535)|0)+(X&65535)|0;te=((pe(b,I)|0)+(ae>>>16)|0)+(X>>>16)|0;ne=((pe(u,R)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(b,R)|0)+(te>>>16)|0)+(ne>>>16)|0;X=ne<<16|ee&65535;ee=((pe(u,M)|0)+(ae&65535)|0)+(K&65535)|0;te=((pe(b,M)|0)+(ae>>>16)|0)+(K>>>16)|0;ne=((pe(u,F)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(b,F)|0)+(te>>>16)|0)+(ne>>>16)|0;K=ne<<16|ee&65535;Z=ae;ee=((pe(d,k)|0)+(Q&65535)|0)+(G&65535)|0;te=((pe(v,k)|0)+(Q>>>16)|0)+(G>>>16)|0;ne=((pe(d,D)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(v,D)|0)+(te>>>16)|0)+(ne>>>16)|0;G=ne<<16|ee&65535;ee=((pe(d,T)|0)+(ae&65535)|0)+(H&65535)|0;te=((pe(v,T)|0)+(ae>>>16)|0)+(H>>>16)|0;ne=((pe(d,C)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(v,C)|0)+(te>>>16)|0)+(ne>>>16)|0;H=ne<<16|ee&65535;ee=((pe(d,w)|0)+(ae&65535)|0)+(z&65535)|0;te=((pe(v,w)|0)+(ae>>>16)|0)+(z>>>16)|0;ne=((pe(d,x)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(v,x)|0)+(te>>>16)|0)+(ne>>>16)|0;z=ne<<16|ee&65535;ee=((pe(d,A)|0)+(ae&65535)|0)+(W&65535)|0;te=((pe(v,A)|0)+(ae>>>16)|0)+(W>>>16)|0;ne=((pe(d,P)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(v,P)|0)+(te>>>16)|0)+(
ne>>>16)|0;W=ne<<16|ee&65535;ee=((pe(d,N)|0)+(ae&65535)|0)+(V&65535)|0;te=((pe(v,N)|0)+(ae>>>16)|0)+(V>>>16)|0;ne=((pe(d,O)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(v,O)|0)+(te>>>16)|0)+(ne>>>16)|0;V=ne<<16|ee&65535;ee=((pe(d,S)|0)+(ae&65535)|0)+(X&65535)|0;te=((pe(v,S)|0)+(ae>>>16)|0)+(X>>>16)|0;ne=((pe(d,B)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(v,B)|0)+(te>>>16)|0)+(ne>>>16)|0;X=ne<<16|ee&65535;ee=((pe(d,I)|0)+(ae&65535)|0)+(K&65535)|0;te=((pe(v,I)|0)+(ae>>>16)|0)+(K>>>16)|0;ne=((pe(d,R)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(v,R)|0)+(te>>>16)|0)+(ne>>>16)|0;K=ne<<16|ee&65535;ee=((pe(d,M)|0)+(ae&65535)|0)+(Z&65535)|0;te=((pe(v,M)|0)+(ae>>>16)|0)+(Z>>>16)|0;ne=((pe(d,F)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(v,F)|0)+(te>>>16)|0)+(ne>>>16)|0;Z=ne<<16|ee&65535;Q=ae;ee=((pe(f,k)|0)+(Y&65535)|0)+(H&65535)|0;te=((pe(_,k)|0)+(Y>>>16)|0)+(H>>>16)|0;ne=((pe(f,D)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(_,D)|0)+(te>>>16)|0)+(ne>>>16)|0;H=ne<<16|ee&65535;ee=((pe(f,T)|0)+(ae&65535)|0)+(z&65535)|0;te=((pe(_,T)|0)+(ae>>>16)|0)+(z>>>16)|0;ne=((pe(f,C)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(_,C)|0)+(te>>>16)|0)+(ne>>>16)|0;z=ne<<16|ee&65535;ee=((pe(f,w)|0)+(ae&65535)|0)+(W&65535)|0;te=((pe(_,w)|0)+(ae>>>16)|0)+(W>>>16)|0;ne=((pe(f,x)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(_,x)|0)+(te>>>16)|0)+(ne>>>16)|0;W=ne<<16|ee&65535;ee=((pe(f,A)|0)+(ae&65535)|0)+(V&65535)|0;te=((pe(_,A)|0)+(ae>>>16)|0)+(V>>>16)|0;ne=((pe(f,P)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(_,P)|0)+(te>>>16)|0)+(ne>>>16)|0;V=ne<<16|ee&65535;ee=((pe(f,N)|0)+(ae&65535)|0)+(X&65535)|0;te=((pe(_,N)|0)+(ae>>>16)|0)+(X>>>16)|0;ne=((pe(f,O)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(_,O)|0)+(te>>>16)|0)+(ne>>>16)|0;X=ne<<16|ee&65535;ee=((pe(f,S)|0)+(ae&65535)|0)+(K&65535)|0;te=((pe(_,S)|0)+(ae>>>16)|0)+(K>>>16)|0;ne=((pe(f,B)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(_,B)|0)+(te>>>16)|0)+(ne>>>16)|0;K=ne<<16|ee&65535;ee=((pe(f,I)|0)+(ae&65535)|0)+(Z&65535)|0;te=((pe(_,I)|0)+(ae>>>16)|0)+(Z>>>16)|0;ne=((pe(f,R)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(_,R)|0)+(te>>>16)|0)+(ne>>>16)|0;Z=ne<<16|ee&65535;ee=((pe(f,M)|0)+(ae&65535)|0)+(Q&65535)|0;te=((pe(_,M)|0)+(ae>>>16)|0)+(Q>>>16)|0;ne=((pe(f,F)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(_,F)|0)+(te>>>16)|0)+(ne>>>16)|0;Q=ne<<16|ee&65535;Y=ae;ee=((pe(h,k)|0)+($&65535)|0)+(z&65535)|0;te=((pe(E,k)|0)+($>>>16)|0)+(z>>>16)|0;ne=((pe(h,D)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(E,D)|0)+(te>>>16)|0)+(ne>>>16)|0;z=ne<<16|ee&65535;ee=((pe(h,T)|0)+(ae&65535)|0)+(W&65535)|0;te=((pe(E,T)|0)+(ae>>>16)|0)+(W>>>16)|0;ne=((pe(h,C)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(E,C)|0)+(te>>>16)|0)+(ne>>>16)|0;W=ne<<16|ee&65535;ee=((pe(h,w)|0)+(ae&65535)|0)+(V&65535)|0;te=((pe(E,w)|0)+(ae>>>16)|0)+(V>>>16)|0;ne=((pe(h,x)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(E,x)|0)+(te>>>16)|0)+(ne>>>16)|0;V=ne<<16|ee&65535;ee=((pe(h,A)|0)+(ae&65535)|0)+(X&65535)|0;te=((pe(E,A)|0)+(ae>>>16)|0)+(X>>>16)|0;ne=((pe(h,P)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(E,P)|0)+(te>>>16)|0)+(ne>>>16)|0;X=ne<<16|ee&65535;ee=((pe(h,N)|0)+(ae&65535)|0)+(K&65535)|0;te=((pe(E,N)|0)+(ae>>>16)|0)+(K>>>16)|0;ne=((pe(h,O)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(E,O)|0)+(te>>>16)|0)+(ne>>>16)|0;K=ne<<16|ee&65535;ee=((pe(h,S)|0)+(ae&65535)|0)+(Z&65535)|0;te=((pe(E,S)|0)+(ae>>>16)|0)+(Z>>>16)|0;ne=((pe(h,B)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(E,B)|0)+(te>>>16)|0)+(ne>>>16)|0;Z=ne<<16|ee&65535;ee=((pe(h,I)|0)+(ae&65535)|0)+(Q&65535)|0;te=((pe(E,I)|0)+(ae>>>16)|0)+(Q>>>16)|0;ne=((pe(h,R)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(E,R)|0)+(te>>>16)|0)+(ne>>>16)|0;Q=ne<<16|ee&65535;ee=((pe(h,M)|0)+(ae&65535)|0)+(Y&65535)|0;te=((pe(E,M)|0)+(ae>>>16)|0)+(Y>>>16)|0;ne=((pe(h,F)|0)+(te&65535)|0)+(ee>>>16)|0;ae=((pe(E,F)|0)+(te>>>16)|0)+(ne>>>16)|0;Y=ne<<16|ee&65535;$=ae;he[(ce|0)>>2]=L,he[(ce|4)>>2]=q,he[(ce|8)>>2]=U,he[(ce|12)>>2]=J,he[(ce|16)>>2]=j,he[(ce|20)>>2]=G,he[(ce|24)>>2]=H,he[(ce|28)>>2]=z}ce=i+(ie+se|0)|0;he[(ce|0)>>2]=W,he[(ce|4)>>2]=V,he[(ce|8)>>2]=X,he[(ce|12)>>2]=K,he[(ce|16)>>2]=Z,he[(ce|20)>>2]=Q,he[(ce|24)>>2]=Y,he[(ce|28)>>2]=$}}function l(e,t,n){e=e|0;t=t|0;n=n|0;var a=0,i=0,r=0,s=0,o=0,c=0,l=0,u=0,d=0,f=0,h=0,p=0,m=0,g=0,y=0,b=0,v=0,_=0,E=0,k=0,T=0,w=0,A=0,N=0,S=0,I=0,M=0,D=0,C=0,x=0,P=0,O=0,B=0,R=0,F=0,L=0,q=0,U=0,J=0,j=0,G=0,H=0,z=0,W=0,V=0,X=0,K=0,Z=0,Q=0,Y=0,$=0,ee=0,te=0,ne=0,ae=0,ie=0,re=0,se=0,oe=0,ce=0,le=0,ue=0,de=0,fe=0;for(;(oe|0)<(t|0);oe=oe+4|0){fe=n+(oe<<1)|0;d=he[e+oe>>2]|0,a=d&65535,d=d>>>16;Q=pe(a,a)|0;Y=(pe(a,d)|0)+(Q>>>17)|0;$=(pe(d,d)|0)+(Y>>>15)|0;he[fe>>2]=Y<<17|Q&131071;he[(fe|4)>>2]=$}for(se=0;(se|0)<(t|0);se=se+8|0){ue=e+se|0,fe=n+(se<<1)|0;d=he[ue>>2]|0,a=d&65535,d=d>>>16;S=he[(ue|4)>>2]|0,v=S&65535,S=S>>>16;Q=pe(a,v)|0;Y=(pe(a,S)|0)+(Q>>>16)|0;$=(pe(d,v)|0)+(Y&65535)|0;ne=((pe(d,S)|0)+(Y>>>16)|0)+($>>>16)|0;ae=he[(fe|4)>>2]|0;Q=(ae&65535)+((Q&65535)<<1)|0;$=((ae>>>16)+(($&65535)<<1)|0)+(Q>>>16)|0;he[(fe|4)>>2]=$<<16|Q&65535;ee=$>>>16;ae=he[(fe|8)>>2]|0;Q=((ae&65535)+((ne&65535)<<1)|0)+ee|0;$=((ae>>>16)+(ne>>>16<<1)|0)+(Q>>>16)|0;he[(fe|8)>>2]=$<<16|Q&65535;ee=$>>>16;if(ee){ae=he[(fe|12)>>2]|0;Q=(ae&65535)+ee|0;$=(ae>>>16)+(Q>>>16)|0;he[(fe|12)>>2]=$<<16|Q&65535}}for(se=0;(se|0)<(t|0);se=se+16|0){ue=e+se|0,fe=n+(se<<1)|0;d=he[ue>>2]|0,a=d&65535,d=d>>>16,f=he[(ue|4)>>2]|0,i=f&65535,f=f>>>16;S=he[(ue|8)>>2]|0,v=S&65535,S=S>>>16,I=he[(ue|12)>>2]|0,_=I&65535,I=I>>>16;Q=pe(a,v)|0;Y=pe(d,v)|0;$=((pe(a,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,S)|0)+(Y>>>16)|0)+($>>>16)|0;B=$<<16|Q&65535;Q=(pe(a,_)|0)+(ne&65535)|0;Y=(pe(d,_)|0)+(ne>>>16)|0;$=((pe(a,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,I)|0)+(Y>>>16)|0)+($>>>16)|0;R=$<<16|Q&65535;F=ne;Q=(pe(i,v)|0)+(R&65535)|0;Y=(pe(f,v)|0)+(R>>>16)|0;$=((pe(i,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,S)|0)+(Y>>>16)|0)+($>>>16)|0;R=$<<16|Q&65535;Q=((pe(i,_)|0)+(F&65535)|0)+(ne&65535)|0;Y=((pe(f,_)|0)+(F>>>16)|0)+(ne>>>16)|0;$=((pe(i,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,I)|0)+(Y>>>16)|0)+($>>>16)|0;F=$<<16|Q&65535;L=ne;ae=he[(fe|8)>>2]|0;Q=(ae&65535)+((B&65535)<<1)|0;$=((ae>>>16)+(B>>>16<<1)|0)+(Q>>>16)|0;he[(fe|8)>>2]=$<<16|Q&65535;ee=$>>>16;ae=he[(fe|12)>>2]|0;Q=((ae&65535)+((R&65535)<<1)|0)+ee|0;$=((ae>>>16)+(R>>>16<<1)|0)+(Q>>>16)|0;he[(fe|12)>>2]=$<<16|Q&65535;ee=$>>>16;ae=he[(fe|16)>>2]|0;Q=((ae&65535)+((F&65535)<<1)|0)+ee|0;$=((ae>>>16)+(F>>>16<<1)|0)+(Q>>>16)|0;he[(fe|16)>>2]=$<<16|Q&65535;ee=$>>>16;ae=he[(fe|20)>>2]|0;Q=((ae&65535)+((L&65535)<<1)|0)+ee|0;$=((ae>>>16)+(L>>>16<<1)|0)+(Q>>>16)|0;he[(fe|20)>>2]=$<<16|Q&65535;ee=$>>>16;for(le=24;!!ee&(le|0)<32;le=le+4|0){ae=he[(fe|le)>>2]|0;Q=(ae&65535)+ee|0;$=(ae>>>16)+(Q>>>16)|0;he[(fe|le)>>2]=$<<16|Q&65535;ee=$>>>16}}for(se=0;(se|0)<(t|0);se=se+32|0){ue=e+se|0,fe=n+(se<<1)|0;d=he[ue>>2]|0,a=d&65535,d=d>>>16,f=he[(ue|4)>>2]|0,i=f&65535,f=f>>>16,h=he[(ue|8)>>2]|0,r=h&65535,h=h>>>16,p=he[(ue|12)>>2]|0,s=p&65535,p=p>>>16;S=he[(ue|16)>>2]|0,v=S&65535,S=S>>>16,I=he[(ue|20)>>2]|0,_=I&65535,I=I>>>16,M=he[(ue|24)>>2]|0,E=M&65535,M=M>>>16,D=he[(ue|28)>>2]|0,k=D&65535,D=D>>>16;Q=pe(a,v)|0;Y=pe(d,v)|0;$=((pe(a,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,S)|0)+(Y>>>16)|0)+($>>>16)|0;B=$<<16|Q&65535;Q=(pe(a,_)|0)+(ne&65535)|0;Y=(pe(d,_)|0)+(ne>>>16)|0;$=((pe(a,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,I)|0)+(Y>>>16)|0)+($>>>16)|0;R=$<<16|Q&65535;Q=(pe(a,E)|0)+(ne&65535)|0;Y=(pe(d,E)|0)+(ne>>>16)|0;$=((pe(a,M)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,M)|0)+(Y>>>16)|0)+($>>>16)|0;F=$<<16|Q&65535;Q=(pe(a,k)|0)+(ne&65535)|0;Y=(pe(d,k)|0)+(ne>>>16)|0;$=((pe(a,D)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,D)|0)+(Y>>>16)|0)+($>>>16)|0;L=$<<16|Q&65535;q=ne;Q=(pe(i,v)|0)+(R&65535)|0;Y=(pe(f,v)|0)+(R>>>16)|0;$=((pe(i,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,S)|0)+(Y>>>16)|0)+($>>>16)|0;R=$<<16|Q&65535;Q=((pe(i,_)|0)+(F&65535)|0)+(ne&65535)|0;Y=((pe(f,_)|0)+(F>>>16)|0)+(ne>>>16)|0;$=((pe(i,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,I)|0)+(Y>>>16)|0)+($>>>16)|0;F=$<<16|Q&65535;Q=((pe(i,E)|0)+(L&65535)|0)+(ne&65535)|0;Y=((pe(f,E)|0)+(L>>>16)|0)+(ne>>>16)|0;$=((pe(i,M)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,M)|0)+(Y>>>16)|0)+($>>>16)|0;L=$<<16|Q&65535;Q=((pe(i,k)|0)+(q&65535)|0)+(ne&65535)|0;Y=((pe(f,k)|0)+(q>>>16)|0)+(ne>>>16)|0;$=((pe(i,D)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,D)|0)+(Y>>>16)|0)+($>>>16)|0;q=$<<16|Q&65535;U=ne;Q=(pe(r,v)|0)+(F&65535)|0;Y=(pe(h,v)|0)+(F>>>16)|0;$=((pe(r,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(h,S)|0)+(Y>>>16)|0)+($>>>16)|0;F=$<<16|Q&65535;Q=((pe(r,_)|0)+(L&65535)|0)+(ne&65535)|0;Y=((pe(h,_)|0)+(L>>>16)|0)+(ne>>>16)|0;$=((pe(r,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(h,I)|0)+(Y>>>16)|0)+($>>>16)|0;L=$<<16|Q&65535;Q=((pe(r,E)|0)+(q&65535)|0)+(ne&65535)|0;Y=((pe(h,E)|0)+(q>>>16)|0)+(ne>>>16)|0;$=((pe(r,M)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(h,M)|0)+(Y>>>16)|0)+($>>>16)|0;q=$<<16|Q&65535;Q=((pe(r,k)|0)+(U&65535)|0)+(ne&65535)|0;Y=((pe(h,k)|0)+(U>>>16)|0)+(ne>>>16)|0;$=((pe(r,D)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(h,D)|0)+(Y>>>16)|0)+($>>>16)|0;U=$<<16|Q&65535;J=ne;Q=(pe(s,v)|0)+(L&65535)|0;Y=(pe(p,v)|0)+(L>>>16)|0;$=((pe(s,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(p,S)|0)+(Y>>>16)|0)+($>>>16)|0;L=$<<16|Q&65535;Q=((pe(s,_)|0)+(q&65535)|0)+(ne&65535)|0;Y=((pe(p,_)|0)+(q>>>16)|0)+(ne>>>16)|0;$=((pe(s,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(p,I)|0)+(Y>>>16)|0)+($>>>16)|0;q=$<<16|Q&65535;Q=((pe(s,E)|0)+(U&65535)|0)+(ne&65535)|0;Y=((pe(p,E)|0)+(U>>>16)|0)+(ne>>>16)|0;$=((pe(s,M)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(p,M)|0)+(Y>>>16)|0)+($>>>16)|0;U=$<<16|Q&65535;Q=((pe(s,k)|0)+(J&65535)|0)+(ne&65535)|0;Y=((pe(p,k)|0)+(J>>>16)|0)+(ne>>>16)|0;$=((pe(s,D)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(p,D)|0)+(Y>>>16)|0)+($>>>16)|0;J=$<<16|Q&65535;j=ne;ae=he[(fe|16)>>2]|0;Q=(ae&65535)+((B&65535)<<1)|0;$=((ae>>>16)+(B>>>16<<1)|0)+(Q>>>16)|0;he[(fe|16)>>2]=$<<16|Q&65535;ee=$>>>16;ae=he[(fe|20)>>2]|0;Q=((ae&65535)+((R&65535)<<1)|0)+ee|0;$=((ae>>>16)+(R>>>16<<1)|0)+(Q>>>16)|0;he[(fe|20)>>2]=$<<16|Q&65535;ee=$>>>16;ae=he[(fe|24)>>2]|0;Q=((ae&65535)+((F&65535)<<1)|0)+ee|0;$=((ae>>>16)+(F>>>16<<1)|0)+(Q>>>16)|0;he[(fe|24)>>2]=$<<16|Q&65535;ee=$>>>16;ae=he[(fe|28)>>2]|0;Q=((ae&65535)+((L&65535)<<1)|0)+ee|0;$=((ae>>>16)+(L>>>16<<1)|0)+(Q>>>16)|0;he[(fe|28)>>2]=$<<16|Q&65535;ee=$>>>16;ae=he[fe+32>>2]|0;Q=((ae&65535)+((q&65535)<<1)|0)+ee|0;$=((ae>>>16)+(q>>>16<<1)|0)+(Q>>>16)|0;he[fe+32>>2]=$<<16|Q&65535;ee=$>>>16;ae=he[fe+36>>2]|0;Q=((ae&65535)+((U&65535)<<1)|0)+ee|0;$=((ae>>>16)+(U>>>16<<1)|0)+(Q>>>16)|0;he[fe+36>>2]=$<<16|Q&65535;ee=$>>>16;ae=he[fe+40>>2]|0;Q=((ae&65535)+((J&65535)<<1)|0)+ee|0;$=((ae>>>16)+(J>>>16<<1)|0)+(Q>>>16)|0;he[fe+40>>2]=$<<16|Q&65535;ee=$>>>16;ae=he[fe+44>>2]|0;Q=((ae&65535)+((j&65535)<<1)|0)+ee|0;$=((ae>>>16)+(j>>>16<<1)|0)+(Q>>>16)|0;he[fe+44>>2]=$<<16|Q&65535;ee=$>>>16;for(le=48;!!ee&(le|0)<64;le=le+4|0){ae=he[fe+le>>2]|0;Q=(ae&65535)+ee|0;$=(ae>>>16)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16}}for(ie=32;(ie|0)<(t|0);ie=ie<<1){re=ie<<1;for(se=0;(se|0)<(t|0);se=se+re|0){fe=n+(se<<1)|0;te=0;for(oe=0;(oe|0)<(ie|0);oe=oe+32|0){ue=(e+se|0)+oe|0;d=he[ue>>2]|0,a=d&65535,d=d>>>16,f=he[(ue|4)>>2]|0,i=f&65535,f=f>>>16,h=he[(ue|8)>>2]|0,r=h&65535,h=h>>>16,p=he[(ue|12)>>2]|0,s=p&65535,p=p>>>16,m=he[(ue|16)>>2]|0,o=m&65535,m=m>>>16,g=he[(ue|20)>>2]|0,c=g&65535,g=g>>>16,y=he[(ue|24)>>2]|0,l=y&65535,y=y>>>16,b=he[(ue|28)>>2]|0,u=b&65535,b=b>>>16;G=H=z=W=V=X=K=Z=ee=0;for(ce=0;(ce|0)<(ie|0);ce=ce+32|0){de=((e+se|0)+ie|0)+ce|0;S=he[de>>2]|0,v=S&65535,S=S>>>16,I=he[(de|4)>>2]|0,_=I&65535,I=I>>>16,M=he[(de|8)>>2]|0,E=M&65535,M=M>>>16,D=he[(de|12)>>2]|0,k=D&65535,D=D>>>16,C=he[(de|16)>>2]|0,T=C&65535,C=C>>>16,x=he[(de|20)>>2]|0,w=x&65535,x=x>>>16,P=he[(de|24)>>2]|0,A=P&65535,P=P>>>16,O=he[(de|28)>>2]|0,N=O&65535,O=O>>>16;B=R=F=L=q=U=J=j=0;Q=((pe(a,v)|0)+(B&65535)|0)+(G&65535)|0;Y=((pe(d,v)|0)+(B>>>16)|0)+(G>>>16)|0;$=((pe(a,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,S)|0)+(Y>>>16)|0)+($>>>16)|0;B=$<<16|Q&65535;Q=((pe(a,_)|0)+(R&65535)|0)+(ne&65535)|0;Y=((pe(d,_)|0)+(R>>>16)|0)+(ne>>>16)|0;$=((pe(a,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,I)|0)+(Y>>>16)|0)+($>>>16)|0;R=$<<16|Q&65535;Q=((pe(a,E)|0)+(F&65535)|0)+(ne&65535)|0;Y=((pe(d,E)|0)+(F>>>16)|0)+(ne>>>16)|0;$=((pe(a,M)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,M)|0)+(Y>>>16)|0)+($>>>16)|0;F=$<<16|Q&65535;Q=((pe(a,k)|0)+(L&65535)|0)+(ne&65535)|0;Y=((pe(d,k)|0)+(L>>>16)|0)+(ne>>>16)|0;$=((pe(a,D)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,D)|0)+(Y>>>16)|0)+($>>>16)|0;L=$<<16|Q&65535;Q=((pe(a,T)|0)+(q&65535)|0)+(ne&65535)|0;Y=((pe(d,T)|0)+(q>>>16)|0)+(ne>>>16)|0;$=((pe(a,C)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,C)|0)+(Y>>>16)|0)+($>>>16)|0;q=$<<16|Q&65535;Q=((pe(a,w)|0)+(U&65535)|0)+(ne&65535)|0;Y=((pe(d,w)|0)+(U>>>16)|0)+(ne>>>16)|0;$=((pe(a,x)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,x)|0)+(Y>>>16)|0)+($>>>16)|0;U=$<<16|Q&65535;Q=((pe(a,A)|0)+(J&65535)|0)+(ne&65535)|0;Y=((pe(d,A)|0)+(J>>>16)|0)+(ne>>>16)|0;$=((pe(a,P)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,P)|0)+(Y>>>16)|0)+($>>>16)|0;J=$<<16|Q&65535;Q=((pe(a,N)|0)+(j&65535)|0)+(ne&65535)|0;Y=((pe(d,N)|0)+(j>>>16)|0)+(ne>>>16)|0;$=((pe(a,O)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(d,O)|0)+(Y>>>16)|0)+($>>>16)|0;j=$<<16|Q&65535;G=ne;Q=((pe(i,v)|0)+(R&65535)|0)+(H&65535)|0;Y=((pe(f,v)|0)+(R>>>16)|0)+(H>>>16)|0;$=((pe(i,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,S)|0)+(Y>>>16)|0)+($>>>16)|0;R=$<<16|Q&65535;Q=((pe(i,_)|0)+(F&65535)|0)+(ne&65535)|0;Y=((pe(f,_)|0)+(F>>>16)|0)+(ne>>>16)|0;$=((pe(i,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,I)|0)+(Y>>>16)|0)+($>>>16)|0;F=$<<16|Q&65535;Q=((pe(i,E)|0)+(L&65535)|0)+(ne&65535)|0;Y=((pe(f,E)|0)+(L>>>16)|0)+(ne>>>16)|0;$=((pe(i,M)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,M)|0)+(Y>>>16)|0)+($>>>16)|0;L=$<<16|Q&65535;Q=((pe(i,k)|0)+(q&65535)|0)+(ne&65535)|0;Y=((pe(f,k)|0)+(q>>>16)|0)+(ne>>>16)|0;$=((pe(i,D)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,D)|0)+(Y>>>16)|0)+($>>>16)|0;q=$<<16|Q&65535;Q=((pe(i,T)|0)+(U&65535)|0)+(ne&65535)|0;Y=((pe(f,T)|0)+(U>>>16)|0)+(ne>>>16)|0;$=((pe(i,C)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,C)|0)+(Y>>>16)|0)+($>>>16)|0;U=$<<16|Q&65535;Q=((pe(i,w)|0)+(J&65535)|0)+(ne&65535)|0;Y=((pe(f,w)|0)+(J>>>16)|0)+(ne>>>16)|0;$=((pe(i,x)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,x)|0)+(Y>>>16)|0)+($>>>16)|0;J=$<<16|Q&65535;Q=((pe(i,A)|0)+(j&65535)|0)+(ne&65535)|0;Y=((pe(f,A)|0)+(j>>>16)|0)+(ne>>>16)|0;$=((pe(i,P)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,P)|0)+(Y>>>16)|0)+($>>>16)|0;j=$<<16|Q&65535;Q=((pe(i,N)|0)+(G&65535)|0)+(ne&65535)|0;Y=((pe(f,N)|0)+(G>>>16)|0)+(ne>>>16)|0;$=((pe(i,O)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(f,O)|0)+(Y>>>16)|0)+($>>>16)|0;G=$<<16|Q&65535;H=ne;Q=((pe(r,v)|0)+(F&65535)|0)+(z&65535)|0;Y=((pe(h,v)|0)+(F>>>16)|0)+(z>>>16)|0;$=((pe(r,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(h,S)|0)+(Y>>>16)|0)+($>>>16)|0;F=$<<16|Q&65535;Q=((pe(r,_)|0)+(L&65535)|0)+(ne&65535)|0;Y=((pe(h,_)|0)+(L>>>16)|0)+(ne>>>16)|0;$=((pe(r,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(h,I)|0)+(Y>>>16)|0)+($>>>16)|0;L=$<<16|Q&65535;Q=((pe(r,E)|0)+(q&65535)|0)+(ne&65535)|0;Y=((pe(h,E)|0)+(q>>>16)|0)+(ne>>>16)|0;$=((pe(r,M)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(h,M)|0)+(Y>>>16)|0)+($>>>16)|0;q=$<<16|Q&65535;Q=((pe(r,k)|0)+(U&65535)|0)+(ne&65535)|0;Y=((pe(h,k)|0)+(U>>>16)|0)+(ne>>>16)|0;$=((pe(r,D)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(h,D)|0)+(Y>>>16)|0)+($>>>16)|0;U=$<<16|Q&65535;Q=((pe(r,T)|0)+(J&65535)|0)+(ne&65535)|0;Y=((pe(h,T)|0)+(J>>>16)|0)+(ne>>>16)|0;$=((pe(r,C)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(h,C)|0)+(Y>>>16)|0)+($>>>16)|0;J=$<<16|Q&65535;Q=((pe(r,w)|0)+(j&65535)|0)+(ne&65535)|0;Y=((pe(h,w)|0)+(j>>>16)|0)+(ne>>>16)|0;$=((pe(r,x)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(h,x)|0)+(Y>>>16)|0)+($>>>16)|0;j=$<<16|Q&65535;Q=((pe(r,A)|0)+(G&65535)|0)+(ne&65535)|0;Y=((pe(h,A)|0)+(G>>>16)|0)+(ne>>>16)|0;$=((pe(r,P)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(h,P)|0)+(Y>>>16)|0)+($>>>16)|0;G=$<<16|Q&65535;Q=((pe(r,N)|0)+(H&65535)|0)+(ne&65535)|0;Y=((pe(h,N)|0)+(H>>>16)|0)+(ne>>>16)|0;$=((pe(r,O)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(h,O)|0)+(Y>>>16)|0)+($>>>16)|0;H=$<<16|Q&65535;z=ne;Q=((pe(s,v)|0)+(L&65535)|0)+(W&65535)|0;Y=((pe(p,v)|0)+(L>>>16)|0)+(W>>>16)|0;$=((pe(s,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(p,S)|0)+(Y>>>16)|0)+($>>>16)|0;L=$<<16|Q&65535;Q=((pe(s,_)|0)+(q&65535)|0)+(ne&65535)|0;Y=((pe(p,_)|0)+(q>>>16)|0)+(ne>>>16)|0;$=((pe(s,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(p,I)|0)+(Y>>>16)|0)+($>>>16)|0;q=$<<16|Q&65535;Q=((pe(s,E)|0)+(U&65535)|0)+(ne&65535)|0;Y=((pe(p,E)|0)+(U>>>16)|0)+(ne>>>16)|0;$=((pe(s,M)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(p,M)|0)+(Y>>>16)|0)+($>>>16)|0;U=$<<16|Q&65535;Q=((pe(s,k)|0)+(J&65535)|0)+(ne&65535)|0;Y=((pe(p,k)|0)+(J>>>16)|0)+(ne>>>16)|0;$=((pe(s,D)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(p,D)|0)+(Y>>>16)|0)+($>>>16)|0;J=$<<16|Q&65535;Q=((pe(s,T)|0)+(j&65535)|0)+(ne&65535)|0;Y=((pe(p,T)|0)+(j>>>16)|0)+(ne>>>16)|0;$=((pe(s,C)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(p,C)|0)+(Y>>>16)|0)+($>>>16)|0;j=$<<16|Q&65535;Q=((pe(s,w)|0)+(G&65535)|0)+(ne&65535)|0;Y=((pe(p,w)|0)+(G>>>16)|0)+(ne>>>16)|0;$=((pe(s,x)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(p,x)|0)+(Y>>>16)|0)+($>>>16)|0;G=$<<16|Q&65535;Q=((pe(s,A)|0)+(H&65535)|0)+(ne&65535)|0;Y=((pe(p,A)|0)+(H>>>16)|0)+(ne>>>16)|0;$=((pe(s,P)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(p,P)|0)+(Y>>>16)|0)+($>>>16)|0;H=$<<16|Q&65535;Q=((pe(s,N)|0)+(z&65535)|0)+(ne&65535)|0;Y=((pe(p,N)|0)+(z>>>16)|0)+(ne>>>16)|0;$=((pe(s,O)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(p,O)|0)+(Y>>>16)|0)+($>>>16)|0;z=$<<16|Q&65535;W=ne;Q=((pe(o,v)|0)+(q&65535)|0)+(V&65535)|0;Y=((pe(m,v)|0)+(q>>>16)|0)+(V>>>16)|0;$=((pe(o,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(m,S)|0)+(Y>>>16)|0)+($>>>16)|0;q=$<<16|Q&65535;Q=((pe(o,_)|0)+(U&65535)|0)+(ne&65535)|0;Y=((pe(m,_)|0)+(U>>>16)|0)+(ne>>>16)|0;$=((pe(o,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(m,I)|0)+(Y>>>16)|0)+($>>>16)|0;U=$<<16|Q&65535;Q=((pe(o,E)|0)+(J&65535)|0)+(ne&65535)|0;Y=((pe(m,E)|0)+(J>>>16)|0)+(ne>>>16)|0;$=((pe(o,M)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(m,M)|0)+(Y>>>16)|0)+($>>>16)|0;J=$<<16|Q&65535;Q=((pe(o,k)|0)+(j&65535)|0)+(ne&65535)|0;Y=((pe(m,k)|0)+(j>>>16)|0)+(ne>>>16)|0;$=((pe(o,D)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(m,D)|0)+(Y>>>16)|0)+($>>>16)|0;j=$<<16|Q&65535;Q=((pe(o,T)|0)+(G&65535)|0)+(ne&65535)|0;Y=((pe(m,T)|0)+(G>>>16)|0)+(ne>>>16)|0;$=((pe(o,C)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(m,C)|0)+(Y>>>16)|0)+($>>>16)|0;G=$<<16|Q&65535;Q=((pe(o,w)|0)+(H&65535)|0)+(ne&65535)|0;Y=((pe(m,w)|0)+(H>>>16)|0)+(ne>>>16)|0;$=((pe(o,x)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(m,x)|0)+(Y>>>16)|0)+($>>>16)|0;H=$<<16|Q&65535;Q=((pe(o,A)|0)+(z&65535)|0)+(ne&65535)|0;Y=((pe(m,A)|0)+(z>>>16)|0)+(ne>>>16)|0;$=((pe(o,P)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(m,P)|0)+(Y>>>16)|0)+($>>>16)|0;z=$<<16|Q&65535;Q=((pe(o,N)|0)+(W&65535)|0)+(ne&65535)|0;Y=((pe(m,N)|0)+(W>>>16)|0)+(ne>>>16)|0;$=((pe(o,O)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(m,O)|0)+(Y>>>16)|0)+($>>>16)|0;W=$<<16|Q&65535;V=ne;Q=((pe(c,v)|0)+(U&65535)|0)+(X&65535)|0;Y=((pe(g,v)|0)+(U>>>16)|0)+(X>>>16)|0;$=((pe(c,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(g,S)|0)+(Y>>>16)|0)+($>>>16)|0;U=$<<16|Q&65535;Q=((pe(c,_)|0)+(J&65535)|0)+(ne&65535)|0;Y=((pe(g,_)|0)+(J>>>16)|0)+(ne>>>16)|0;$=((pe(c,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(g,I)|0)+(Y>>>16)|0)+($>>>16)|0;J=$<<16|Q&65535;Q=((pe(c,E)|0)+(j&65535)|0)+(ne&65535)|0;Y=((pe(g,E)|0)+(j>>>16)|0)+(ne>>>16)|0;$=((pe(c,M)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(g,M)|0)+(Y>>>16)|0)+($>>>16)|0;j=$<<16|Q&65535;Q=((pe(c,k)|0)+(G&65535)|0)+(ne&65535)|0;Y=((pe(g,k)|0)+(G>>>16)|0)+(ne>>>16)|0;$=((pe(c,D)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(g,D)|0)+(Y>>>16)|0)+($>>>16)|0;G=$<<16|Q&65535;Q=((pe(c,T)|0)+(H&65535)|0)+(ne&65535)|0;Y=((pe(g,T)|0)+(H>>>16)|0)+(ne>>>16)|0;$=((pe(c,C)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(g,C)|0)+(Y>>>16)|0)+($>>>16)|0;H=$<<16|Q&65535;Q=((pe(c,w)|0)+(z&65535)|0)+(ne&65535)|0;Y=((pe(g,w)|0)+(z>>>16)|0)+(ne>>>16)|0;$=((pe(c,x)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(g,x)|0)+(Y>>>16)|0)+($>>>16)|0;z=$<<16|Q&65535;Q=((pe(c,A)|0)+(W&65535)|0)+(ne&65535)|0;Y=((pe(g,A)|0)+(W>>>16)|0)+(ne>>>16)|0;$=((pe(c,P)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(g,P)|0)+(Y>>>16)|0)+($>>>16)|0;W=$<<16|Q&65535;Q=((pe(c,N)|0)+(V&65535)|0)+(ne&65535)|0;Y=((pe(g,N)|0)+(V>>>16)|0)+(ne>>>16)|0;$=((pe(c,O)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(g,O)|0)+(Y>>>16)|0)+($>>>16)|0;V=$<<16|Q&65535;X=ne;Q=((pe(l,v)|0)+(J&65535)|0)+(K&65535)|0;Y=((pe(y,v)|0)+(J>>>16)|0)+(K>>>16)|0;$=((pe(l,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(y,S)|0)+(Y>>>16)|0)+($>>>16)|0;J=$<<16|Q&65535;Q=((pe(l,_)|0)+(j&65535)|0)+(ne&65535)|0;Y=((pe(y,_)|0)+(j>>>16)|0)+(ne>>>16)|0;$=((pe(l,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(y,I)|0)+(Y>>>16)|0)+($>>>16)|0;j=$<<16|Q&65535;Q=((pe(l,E)|0)+(G&65535)|0)+(ne&65535)|0;Y=((pe(y,E)|0)+(G>>>16)|0)+(ne>>>16)|0;$=((pe(l,M)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(y,M)|0)+(Y>>>16)|0)+($>>>16)|0;G=$<<16|Q&65535;Q=((pe(l,k)|0)+(H&65535)|0)+(ne&65535)|0;Y=((pe(y,k)|0)+(H>>>16)|0)+(ne>>>16)|0;$=((pe(l,D)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(y,D)|0)+(Y>>>16)|0)+($>>>16)|0;H=$<<16|Q&65535;Q=((pe(l,T)|0)+(z&65535)|0)+(ne&65535)|0;Y=((pe(y,T)|0)+(z>>>16)|0)+(ne>>>16)|0;$=((pe(l,C)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(y,C)|0)+(Y>>>16)|0)+($>>>16)|0;z=$<<16|Q&65535;Q=((pe(l,w)|0)+(W&65535)|0)+(ne&65535)|0;Y=((pe(y,w)|0)+(W>>>16)|0)+(ne>>>16)|0;$=((pe(l,x)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(y,x)|0)+(Y>>>16)|0)+($>>>16)|0;W=$<<16|Q&65535;Q=((pe(l,A)|0)+(V&65535)|0)+(ne&65535)|0;Y=((pe(y,A)|0)+(V>>>16)|0)+(ne>>>16)|0;$=((pe(l,P)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(y,P)|0)+(Y>>>16)|0)+($>>>16)|0;V=$<<16|Q&65535;Q=((pe(l,N)|0)+(X&65535)|0)+(ne&65535)|0;Y=((pe(y,N)|0)+(X>>>16)|0)+(ne>>>16)|0;$=((pe(l,O)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(y,O)|0)+(Y>>>16)|0)+($>>>16)|0;X=$<<16|Q&65535;K=ne;Q=((pe(u,v)|0)+(j&65535)|0)+(Z&65535)|0;Y=((pe(b,v)|0)+(j>>>16)|0)+(Z>>>16)|0;$=((pe(u,S)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(b,S)|0)+(Y>>>16)|0)+($>>>16)|0;j=$<<16|Q&65535;Q=((pe(u,_)|0)+(G&65535)|0)+(ne&65535)|0;Y=((pe(b,_)|0)+(G>>>16)|0)+(ne>>>16)|0;$=((pe(u,I)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(b,I)|0)+(Y>>>16)|0)+($>>>16)|0;G=$<<16|Q&65535;Q=((pe(u,E)|0)+(H&65535)|0)+(ne&65535)|0;Y=((pe(b,E)|0)+(H>>>16)|0)+(ne>>>16)|0;$=((pe(u,M)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(b,M)|0)+(Y>>>16)|0)+($>>>16)|0;H=$<<16|Q&65535;Q=((pe(u,k)|0)+(z&65535)|0)+(ne&65535)|0;Y=((pe(b,k)|0)+(z>>>16)|0)+(ne>>>16)|0;$=((pe(u,D)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(b,D)|0)+(Y>>>16)|0)+($>>>16)|0;z=$<<16|Q&65535;Q=((pe(u,T)|0)+(W&65535)|0)+(ne&65535)|0;Y=((pe(b,T)|0)+(W>>>16)|0)+(ne>>>16)|0;$=((pe(u,C)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(b,C)|0)+(Y>>>16)|0)+($>>>16)|0;W=$<<16|Q&65535;Q=((pe(u,w)|0)+(V&65535)|0)+(ne&65535)|0;Y=((pe(b,w)|0)+(V>>>16)|0)+(ne>>>16)|0;$=((pe(u,x)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(b,x)|0)+(Y>>>16)|0)+($>>>16)|0;V=$<<16|Q&65535;Q=((pe(u,A)|0)+(X&65535)|0)+(ne&65535)|0;Y=((pe(b,A)|0)+(X>>>16)|0)+(ne>>>16)|0;$=((pe(u,P)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(b,P)|0)+(Y>>>16)|0)+($>>>16)|0;X=$<<16|Q&65535;Q=((pe(u,N)|0)+(K&65535)|0)+(ne&65535)|0;Y=((pe(b,N)|0)+(K>>>16)|0)+(ne>>>16)|0;$=((pe(u,O)|0)+(Y&65535)|0)+(Q>>>16)|0;ne=((pe(b,O)|0)+(Y>>>16)|0)+($>>>16)|0;K=$<<16|Q&65535;Z=ne;le=ie+(oe+ce|0)|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((B&65535)<<1)|0)+ee|0;$=((ae>>>16)+(B>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((R&65535)<<1)|0)+ee|0;$=((ae>>>16)+(R>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((F&65535)<<1)|0)+ee|0;$=((ae>>>16)+(F>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((L&65535)<<1)|0)+ee|0;$=((ae>>>16)+(L>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((q&65535)<<1)|0)+ee|0;$=((ae>>>16)+(q>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((U&65535)<<1)|0)+ee|0;$=((ae>>>16)+(U>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((J&65535)<<1)|0)+ee|0;$=((ae>>>16)+(J>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((j&65535)<<1)|0)+ee|0;$=((ae>>>16)+(j>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16}le=ie+(oe+ce|0)|0;ae=he[fe+le>>2]|0;Q=(((ae&65535)+((G&65535)<<1)|0)+ee|0)+te|0;$=((ae>>>16)+(G>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((H&65535)<<1)|0)+ee|0;$=((ae>>>16)+(H>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((z&65535)<<1)|0)+ee|0;$=((ae>>>16)+(z>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((W&65535)<<1)|0)+ee|0;$=((ae>>>16)+(W>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((V&65535)<<1)|0)+ee|0;$=((ae>>>16)+(V>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((X&65535)<<1)|0)+ee|0;$=((ae>>>16)+(X>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((K&65535)<<1)|0)+ee|0;$=((ae>>>16)+(K>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;ee=$>>>16;le=le+4|0;ae=he[fe+le>>2]|0;Q=((ae&65535)+((Z&65535)<<1)|0)+ee|0;$=((ae>>>16)+(Z>>>16<<1)|0)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;te=$>>>16}for(le=le+4|0;!!te&(le|0)<re<<1;le=le+4|0){ae=he[fe+le>>2]|0;Q=(ae&65535)+te|0;$=(ae>>>16)+(Q>>>16)|0;he[fe+le>>2]=$<<16|Q&65535;te=$>>>16}}}}function u(e,t,n,a,i){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;var r=0,s=0,o=0,c=0,l=0,u=0,d=0,f=0,h=0,p=0,m=0,g=0,y=0,b=0,v=0,_=0,E=0,k=0,T=0;for(E=t-1&-4;(E|0)>=0;E=E-4|0){r=he[e+E>>2]|0;if(r){t=E;break}}for(E=a-1&-4;(E|0)>=0;E=E-4|0){s=he[n+E>>2]|0;if(s){a=E;break}}while((s&2147483648)==0){s=s<<1;o=o+1|0}l=he[e+t>>2]|0;if(o){c=l>>>(32-o|0);for(E=t-4|0;(E|0)>=0;E=E-4|0){r=he[e+E>>2]|0;he[e+E+4>>2]=l<<o|(o?r>>>(32-o|0):0);l=r}he[e>>2]=l<<o}if(o){u=he[n+a>>2]|0;for(E=a-4|0;(E|0)>=0;E=E-4|0){s=he[n+E>>2]|0;he[n+E+4>>2]=u<<o|s>>>(32-o|0);u=s}he[n>>2]=u<<o}u=he[n+a>>2]|0;d=u>>>16,f=u&65535;for(E=t;(E|0)>=(a|0);E=E-4|0){k=E-a|0;l=he[e+E>>2]|0;h=(c>>>0)/(d>>>0)|0,m=(c>>>0)%(d>>>0)|0,y=pe(h,f)|0;while((h|0)==65536|y>>>0>(m<<16|l>>>16)>>>0){h=h-1|0,m=m+d|0,y=y-f|0;if((m|0)>=65536)break}v=0,_=0;for(T=0;(T|0)<=(a|0);T=T+4|0){s=he[n+T>>2]|0;y=(pe(h,s&65535)|0)+(v>>>16)|0;b=(pe(h,s>>>16)|0)+(y>>>16)|0;s=v&65535|y<<16;v=b;r=he[e+k+T>>2]|0;y=((r&65535)-(s&65535)|0)+_|0;b=((r>>>16)-(s>>>16)|0)+(y>>16)|0;he[e+k+T>>2]=b<<16|y&65535;_=b>>16}y=((c&65535)-(v&65535)|0)+_|0;b=((c>>>16)-(v>>>16)|0)+(y>>16)|0;c=b<<16|y&65535;_=b>>16;if(_){h=h-1|0;_=0;for(T=0;(T|0)<=(a|0);T=T+4|0){s=he[n+T>>2]|0;r=he[e+k+T>>2]|0;y=(r&65535)+_|0;b=(r>>>16)+s+(y>>>16)|0;he[e+k+T>>2]=b<<16|y&65535;_=b>>>16}c=c+_|0}l=he[e+E>>2]|0;r=c<<16|l>>>16;p=(r>>>0)/(d>>>0)|0,g=(r>>>0)%(d>>>0)|0,y=pe(p,f)|0;while((p|0)==65536|y>>>0>(g<<16|l&65535)>>>0){p=p-1|0,g=g+d|0,y=y-f|0;if((g|0)>=65536)break}v=0,_=0;for(T=0;(T|0)<=(a|0);T=T+4|0){s=he[n+T>>2]|0;y=(pe(p,s&65535)|0)+(v&65535)|0;b=((pe(p,s>>>16)|0)+(y>>>16)|0)+(v>>>16)|0;s=y&65535|b<<16;v=b>>>16;r=he[e+k+T>>2]|0;y=((r&65535)-(s&65535)|0)+_|0;b=((r>>>16)-(s>>>16)|0)+(y>>16)|0;_=b>>16;he[e+k+T>>2]=b<<16|y&65535}y=((c&65535)-(v&65535)|0)+_|0;b=((c>>>16)-(v>>>16)|0)+(y>>16)|0;_=b>>16;if(_){p=p-1|0;_=0;for(T=0;(T|0)<=(a|0);T=T+4|0){s=he[n+T>>2]|0;r=he[e+k+T>>2]|0;y=((r&65535)+(s&65535)|0)+_|0;b=((r>>>16)+(s>>>16)|0)+(y>>>16)|0;_=b>>>16;he[e+k+T>>2]=y&65535|b<<16}}he[i+k>>2]=h<<16|p;c=he[e+E>>2]|0}if(o){l=he[e>>2]|0;for(E=4;(E|0)<=(a|0);E=E+4|0){r=he[e+E>>2]|0;he[e+E-4>>2]=r<<(32-o|0)|l>>>o;l=r}he[e+a>>2]=l>>>o}}function d(e,t,n,a,i,r){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;r=r|0;var s=0,o=0,c=0,l=0,u=0,d=0,f=0,h=0,p=0,m=0,g=0,y=0,b=0,v=0;s=_(a<<1)|0;T(a<<1,0,s);k(t,e,s);for(y=0;(y|0)<(a|0);y=y+4|0){c=he[s+y>>2]|0,l=c&65535,c=c>>>16;d=i>>>16,u=i&65535;f=pe(l,u)|0,h=((pe(l,d)|0)+(pe(c,u)|0)|0)+(f>>>16)|0;l=f&65535,c=h&65535;g=0;for(b=0;(b|0)<(a|0);b=b+4|0){v=y+b|0;d=he[n+b>>2]|0,u=d&65535,d=d>>>16;m=he[s+v>>2]|0;f=((pe(l,u)|0)+(g&65535)|0)+(m&65535)|0;h=((pe(l,d)|0)+(g>>>16)|0)+(m>>>16)|0;p=((pe(c,u)|0)+(h&65535)|0)+(f>>>16)|0;g=((pe(c,d)|0)+(p>>>16)|0)+(h>>>16)|0;m=p<<16|f&65535;he[s+v>>2]=m}v=y+b|0;m=he[s+v>>2]|0;f=((m&65535)+(g&65535)|0)+o|0;h=((m>>>16)+(g>>>16)|0)+(f>>>16)|0;he[s+v>>2]=h<<16|f&65535;o=h>>>16}k(a,s+a|0,r);E(a<<1);if(o|(w(n,a,r,a)|0)<=0){A(r,a,n,a,r,a)|0}}return{sreset:i,salloc:_,sfree:E,z:T,tst:s,neg:r,cmp:w,add:o,sub:A,mul:c,sqr:l,div:u,mredc:d}}function Ye(e){return e instanceof $e}function $e(e){var t=zn,n=0,a=0;if(E(e)&&(e=y(e)),k(e)&&(e=new Uint8Array(e)),void 0===e);else if(_(e)){var i=Math.abs(e);4294967295<i?((t=new Uint32Array(2))[0]=0|i,t[1]=i/4294967296|0,n=52):0<i?((t=new Uint32Array(1))[0]=i,n=32):(t=zn,n=0),a=e<0?-1:1}else if(m(e)){if(!(n=8*e.length))return Vn;t=new Uint32Array(n+31>>5);for(var r=e.length-4;0<=r;r-=4)t[e.length-4-r>>2]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3];-3===r?t[t.length-1]=e[0]:-2===r?t[t.length-1]=e[0]<<8|e[1]:-1===r&&(t[t.length-1]=e[0]<<16|e[1]<<8|e[2]),a=1}else{if("object"!=typeof e||null===e)throw new TypeError("number is of unexpected type");t=new Uint32Array(e.limbs),n=e.bitLength,a=e.sign}this.limbs=t,this.bitLength=n,this.sign=a}function et(e){e=e||16;var t=this.limbs,n=this.bitLength,a="";if(16!==e)throw new p("bad radix");for(var i=(n+31>>5)-1;0<=i;i--){var r=t[i].toString(16);a+="00000000".substr(r.length),a+=r}return(a=a.replace(/^0+/,"")).length||(a="0"),this.sign<0&&(a="-"+a),a}function tt(){var e=this.bitLength,t=this.limbs;if(0===e)return new Uint8Array(0);for(var n=e+7>>3,a=new Uint8Array(n),i=0;i<n;i++){var r=n-i-1;a[i]=t[r>>2]>>((3&r)<<3)}return a}function nt(){var e=this.limbs,t=this.bitLength,n=this.sign;if(!n)return 0;if(t<=32)return n*(e[0]>>>0);if(t<=52)return n*(4294967296*(e[1]>>>0)+(e[0]>>>0));var a,i,r=0;for(a=e.length-1;0<=a;a--)if(0!==(i=e[a])){for(;0==(i<<r&2147483648);)r++;break}return 0===a?n*(e[0]>>>0):n*(1048576*((e[a]<<r|(r?e[a-1]>>>32-r:0))>>>0)+((e[a-1]<<r|(r&&1<a?e[a-2]>>>32-r:0))>>>12))*Math.pow(2,32*a-r-52)}function at(e){var t=this.limbs;if(this.bitLength<=e)return this;var n=new $e,a=e+31>>5,i=e%32;return n.limbs=new Uint32Array(t.subarray(0,a)),n.bitLength=e,n.sign=this.sign,i&&(n.limbs[a-1]&=-1>>>32-i),n}function it(e,t){if(!_(e))throw new TypeError("TODO");if(void 0!==t&&!_(t))throw new TypeError("TODO");var n=this.limbs,a=this.bitLength;if(e<0)throw new RangeError("TODO");if(a<=e)return Vn;(void 0===t||a-e<t)&&(t=a-e);var i,r=new $e,s=e>>5,o=e+t+31>>5,c=t+31>>5,l=e%32,u=t%32;if(i=new Uint32Array(c),l){for(var d=0;d<o-s-1;d++)i[d]=n[s+d]>>>l|n[s+d+1]<<32-l;i[d]=n[s+d]>>>l}else i.set(n.subarray(s,o));return u&&(i[c-1]&=-1>>>32-u),r.limbs=i,r.bitLength=t,r.sign=this.sign,r}function rt(){var e=new $e;return e.limbs=this.limbs,e.bitLength=this.bitLength,e.sign=-1*this.sign,e}function st(e){Ye(e)||(e=new $e(e));var t=this.limbs,n=t.length,a=e.limbs,i=a.length;return this.sign<e.sign?-1:this.sign>e.sign?1:(Hn.set(t,0),Hn.set(a,n),Qe.cmp(0,n<<2,n<<2,i<<2)*this.sign)}function ot(e){if(Ye(e)||(e=new $e(e)),!this.sign)return e;if(!e.sign)return this;var t,n,a,i,r=this.bitLength,s=this.limbs,o=s.length,c=this.sign,l=e.bitLength,u=e.limbs,d=u.length,f=e.sign,h=new $e;n=(t=(l<r?r:l)+(0<c*f?1:0))+31>>5,Qe.sreset();var p=Qe.salloc(o<<2),m=Qe.salloc(d<<2),g=Qe.salloc(n<<2);return Qe.z(g-p+(n<<2),0,p),Hn.set(s,p>>2),Hn.set(u,m>>2),0<c*f?(Qe.add(p,o<<2,m,d<<2,g,n<<2),a=c):a=f<c?(i=Qe.sub(p,o<<2,m,d<<2,g,n<<2))?f:c:(i=Qe.sub(m,d<<2,p,o<<2,g,n<<2))?c:f,i&&Qe.neg(g,n<<2,g,n<<2),0===Qe.tst(g,n<<2)?Vn:(h.limbs=new Uint32Array(Hn.subarray(g>>2,(g>>2)+n)),h.bitLength=t,h.sign=a,h)}function ct(e){return Ye(e)||(e=new $e(e)),this.add(e.negate())}function lt(e){if(Ye(e)||(e=new $e(e)),!this.sign||!e.sign)return Vn;var t,n,a=this.bitLength,i=this.limbs,r=i.length,s=e.bitLength,o=e.limbs,c=o.length,l=new $e;n=(t=a+s)+31>>5,Qe.sreset();var u=Qe.salloc(r<<2),d=Qe.salloc(c<<2),f=Qe.salloc(n<<2);return Qe.z(f-u+(n<<2),0,u),Hn.set(i,u>>2),Hn.set(o,d>>2),Qe.mul(u,r<<2,d,c<<2,f,n<<2),l.limbs=new Uint32Array(Hn.subarray(f>>2,(f>>2)+n)),l.sign=this.sign*e.sign,l.bitLength=t,l}function ut(){if(!this.sign)return Vn;var e,t,n=this.bitLength,a=this.limbs,i=a.length,r=new $e;t=31+(e=n<<1)>>5,Qe.sreset();var s=Qe.salloc(i<<2),o=Qe.salloc(t<<2);return Qe.z(o-s+(t<<2),0,s),Hn.set(a,s>>2),Qe.sqr(s,i<<2,o),r.limbs=new Uint32Array(Hn.subarray(o>>2,(o>>2)+t)),r.bitLength=e,r.sign=1,r}function dt(e){Ye(e)||(e=new $e(e));var t,n,a=this.bitLength,i=this.limbs,r=i.length,s=e.bitLength,o=e.limbs,c=o.length,l=Vn,u=Vn;Qe.sreset();var d=Qe.salloc(r<<2),f=Qe.salloc(c<<2),h=Qe.salloc(r<<2);return Qe.z(h-d+(r<<2),0,d),Hn.set(i,d>>2),Hn.set(o,f>>2),Qe.div(d,r<<2,f,c<<2,h),(t=Qe.tst(h,r<<2)>>2)&&((l=new $e).limbs=new Uint32Array(Hn.subarray(h>>2,(h>>2)+t)),l.bitLength=a<t<<5?a:t<<5,l.sign=this.sign*e.sign),(n=Qe.tst(d,c<<2)>>2)&&((u=new $e).limbs=new Uint32Array(Hn.subarray(d>>2,(d>>2)+n)),u.bitLength=s<n<<5?s:n<<5,u.sign=this.sign),{quotient:l,remainder:u}}function ft(e,t){var n,a,i,r,s=e<0?-1:1,o=t<0?-1:1,c=1,l=0,u=0,d=1;for((r=(e*=s)<(t*=o))&&(i=e,e=t,t=i,i=s,s=o,o=i),n=e-(a=Math.floor(e/t))*t;n;)i=c-a*l,c=l,l=i,i=u-a*d,u=d,d=i,e=t,
t=n,n=e-(a=Math.floor(e/t))*t;return l*=s,d*=o,r&&(i=l,l=d,d=i),{gcd:t,x:l,y:d}}function ht(e,t){Ye(e)||(e=new $e(e)),Ye(t)||(t=new $e(t));var n=e.sign,a=t.sign;n<0&&(e=e.negate()),a<0&&(t=t.negate());var i=e.compare(t);if(i<0){var r=e;e=t,t=r,r=n,n=a,a=r}var s,o,c,l=Xn,u=Vn,d=t.bitLength,f=Vn,h=Xn,p=e.bitLength;for(s=e.divide(t);(o=s.remainder)!==Vn;)c=s.quotient,s=l.subtract(c.multiply(u).clamp(d)).clamp(d),l=u,u=s,s=f.subtract(c.multiply(h).clamp(p)).clamp(p),f=h,h=s,e=t,t=o,s=e.divide(t);return n<0&&(u=u.negate()),a<0&&(h=h.negate()),i<0&&(r=u,u=h,h=r),{gcd:t,x:u,y:h}}function pt(){if($e.apply(this,arguments),this.valueOf()<1)throw new RangeError;var e;if(!(this.bitLength<=32)&&1&this.limbs[0]){var t=1+(this.bitLength+31&-32),n=new Uint32Array(t+31>>5);n[n.length-1]=1,(e=new $e).sign=1,e.bitLength=t,e.limbs=n;var a=ft(4294967296,this.limbs[0]).y;this.coefficient=a<0?-a:4294967296-a,this.comodulus=e,this.comodulusRemainder=e.divide(this).remainder,this.comodulusRemainderSquare=e.square().divide(this).remainder}}function mt(e){return Ye(e)||(e=new $e(e)),e.bitLength<=32&&this.bitLength<=32?new $e(e.valueOf()%this.valueOf()):e.compare(this)<0?e:e.divide(this).remainder}function gt(e){var t=ht(this,e=this.reduce(e));return 1!==t.gcd.valueOf()?null:((t=t.y).sign<0&&(t=t.add(this).clamp(this.bitLength)),t)}function yt(e,t){Ye(e)||(e=new $e(e)),Ye(t)||(t=new $e(t));for(var n=0,a=0;a<t.limbs.length;a++)for(var i=t.limbs[a];i;)1&i&&n++,i>>>=1;var r=8;t.bitLength<=4536&&(r=7),t.bitLength<=1736&&(r=6),t.bitLength<=630&&(r=5),t.bitLength<=210&&(r=4),t.bitLength<=60&&(r=3),t.bitLength<=12&&(r=2),n<=1<<r-1&&(r=1);var s=bt((e=bt(this.reduce(e).multiply(this.comodulusRemainderSquare),this)).square(),this),o=new Array(1<<r-1);for(o[0]=e,o[1]=bt(e.multiply(s),this),a=2;a<1<<r-1;a++)o[a]=bt(o[a-1].multiply(s),this);var c=this.comodulusRemainder,l=c;for(a=t.limbs.length-1;0<=a;a--){i=t.limbs[a];for(var u=32;0<u;)if(2147483648&i){for(var d=i>>>32-r,f=r;0==(1&d);)d>>>=1,f--;for(var h=o[d>>>1];d;)d>>>=1,l!==c&&(l=bt(l.square(),this));l=l!==c?bt(l.multiply(h),this):h,i<<=f,u-=f}else l!==c&&(l=bt(l.square(),this)),i<<=1,u--}return bt(l,this)}function bt(e,t){var n=e.limbs,a=n.length,i=t.limbs,r=i.length,s=t.coefficient;Qe.sreset();var o=Qe.salloc(a<<2),c=Qe.salloc(r<<2),l=Qe.salloc(r<<2);Qe.z(l-o+(r<<2),0,o),Hn.set(n,o>>2),Hn.set(i,c>>2),Qe.mredc(o,a<<2,c,r<<2,s,l);var u=new $e;return u.limbs=new Uint32Array(Hn.subarray(l>>2,(l>>2)+r)),u.bitLength=t.bitLength,u.sign=1,u}function vt(e){var t=new $e(this),n=0;for(t.limbs[0]-=1;0===t.limbs[n>>5];)n+=32;for(;0==(t.limbs[n>>5]>>(31&n)&1);)n++;t=t.slice(n);for(var a=new pt(this),i=this.subtract(Xn),r=new $e(this),s=this.limbs.length-1;0===r.limbs[s];)s--;for(;0<=--e;){for(Xe(r.limbs),r.limbs[0]<2&&(r.limbs[0]+=2);0<=r.compare(i);)r.limbs[s]>>>=1;var o=a.power(r,t);if(0!==o.compare(Xn)&&0!==o.compare(i)){for(var c=n;0<--c;){if(0===(o=o.square().divide(a).remainder).compare(Xn))return!1;if(0===o.compare(i))break}if(0===c)return!1}}return!0}function _t(e){e=e||80;var t=this.limbs,n=0;if(0==(1&t[0]))return!1;if(e<=1)return!0;var a=0,i=0,r=0;for(n=0;n<t.length;n++){for(var s=t[n];s;)a+=3&s,s>>>=2;for(var o=t[n];o;)i+=3&o,i-=3&(o>>>=2),o>>>=2;for(var c=t[n];c;)r+=15&c,r-=15&(c>>>=4),c>>>=4}return!!(a%3&&i%5&&r%17)&&(e<=2||vt.call(this,e>>>1))}function Et(e){if(Zn.length>=e)return Zn.slice(0,e);for(var t=Zn[Zn.length-1]+2;Zn.length<e;t+=2){for(var n=0,a=Zn[n];a*a<=t&&t%a!=0;a=Zn[++n]);t<a*a&&Zn.push(t)}return Zn}function kt(e,t){var n=e+31>>5,a=new $e({sign:1,bitLength:e,limbs:n}),i=a.limbs,r=1e4;e<=512&&(r=2200),e<=256&&(r=600);var s=Et(r),o=new Uint32Array(r),c=e*f.Math.LN2|0,l=27;for(250<=e&&(l=12),450<=e&&(l=6),850<=e&&(l=3),1300<=e&&(l=2);;){Xe(i),i[0]|=1,i[n-1]|=1<<(e-1&31),31&e&&(i[n-1]&=h(e+1&31)-1);for(var u=o[0]=1;u<r;u++)o[u]=a.divide(s[u]).remainder.valueOf();e:for(var d=0;d<c;d+=2,i[0]+=2){for(u=1;u<r;u++)if((o[u]+d)%s[u]==0)continue e;if(("function"!=typeof t||t(a))&&vt.call(a,l))return a}}}function Tt(e){e=e||{},this.key=null,this.result=null,this.reset(e)}function wt(e){e=e||{},this.result=null;var t=e.key;if(void 0!==t){if(!(t instanceof Array))throw new TypeError("unexpected key type");var n=t.length;if(2!==n&&3!==n&&8!==n)throw new SyntaxError("unexpected key type");var a=[];a[0]=new pt(t[0]),a[1]=new $e(t[1]),2<n&&(a[2]=new $e(t[2])),3<n&&(a[3]=new pt(t[3]),a[4]=new pt(t[4]),a[5]=new $e(t[5]),a[6]=new $e(t[6]),a[7]=new $e(t[7])),this.key=a}return this}function At(e){if(!this.key)throw new b("no key is associated with the instance");var t;if(E(e)&&(e=y(e)),k(e)&&(e=new Uint8Array(e)),m(e))t=new $e(e);else{if(!Ye(e))throw new TypeError("unexpected data type");t=e}if(this.key[0].compare(t)<=0)throw new RangeError("data too large");var n=this.key[0],a=this.key[1],i=n.power(t,a).toBytes(),r=n.bitLength+7>>3;if(i.length<r){var s=new Uint8Array(r);s.set(i,r-i.length),i=s}return this.result=i,this}function Nt(e){if(!this.key)throw new b("no key is associated with the instance");if(this.key.length<3)throw new b("key isn't suitable for decription");var t,n;if(E(e)&&(e=y(e)),k(e)&&(e=new Uint8Array(e)),m(e))t=new $e(e);else{if(!Ye(e))throw new TypeError("unexpected data type");t=e}if(this.key[0].compare(t)<=0)throw new RangeError("data too large");if(3<this.key.length){for(var a=this.key[0],i=this.key[3],r=this.key[4],s=this.key[5],o=this.key[6],c=this.key[7],l=i.power(t,s),u=r.power(t,o),d=l.subtract(u);d.sign<0;)d=d.add(i);n=i.reduce(c.multiply(d)).multiply(r).add(u).clamp(a.bitLength).toBytes()}else{a=this.key[0];var f=this.key[2];n=a.power(t,f).toBytes()}var h=a.bitLength+7>>3;if(n.length<h){var p=new Uint8Array(h);p.set(n,h-n.length),n=p}return this.result=n,this}function St(t,n){if(n=n||65537,(t=t||2048)<512)throw new p("bit length is too small");if(E(n)&&(n=y(n)),k(n)&&(n=new Uint8Array(n)),!(m(n)||_(n)||Ye(n)))throw new TypeError("unexpected exponent type");if(0==(1&(n=new $e(n)).limbs[0]))throw new p("exponent must be an odd number");var a,e,i,r,s,o,c,l;i=kt(t>>1,function(e){return(s=new $e(e)).limbs[0]-=1,1==ht(s,n).gcd.valueOf()}),r=kt(t-(t>>1),function(e){return!!((a=new pt(i.multiply(e))).limbs[(t+31>>5)-1]>>>(t-1&31))&&((o=new $e(e)).limbs[0]-=1,1==ht(o,n).gcd.valueOf())}),c=(e=new pt(s.multiply(o)).inverse(n)).divide(s).remainder,l=e.divide(o).remainder,i=new pt(i),r=new pt(r);var u=i.inverse(r);return[a,n,e,i,r,c,l,u]}function It(e){if(!(e=e||{}).hash)throw new SyntaxError("option 'hash' is required");if(!e.hash.HASH_SIZE)throw new SyntaxError("option 'hash' supplied doesn't seem to be a valid hash function");this.hash=e.hash,this.label=null,this.reset(e)}function Mt(e){var t=(e=e||{}).label;if(void 0!==t){if(k(t)||m(t))t=new Uint8Array(t);else{if(!E(t))throw new TypeError("unexpected label type");t=y(t)}this.label=0<t.length?t:null}else this.label=null;wt.call(this,e)}function Dt(e){if(!this.key)throw new b("no key is associated with the instance");var t=Math.ceil(this.key[0].bitLength/8),n=this.hash.HASH_SIZE,a=e.byteLength||e.length||0,i=t-a-2*n-2;if(a>t-2*this.hash.HASH_SIZE-2)throw new p("data too large");var r=new Uint8Array(t),s=r.subarray(1,n+1),o=r.subarray(n+1);if(m(e))o.set(e,n+i+1);else if(k(e))o.set(new Uint8Array(e),n+i+1);else{if(!E(e))throw new TypeError("unexpected data type");o.set(y(e),n+i+1)}o.set(this.hash.reset().process(this.label||"").finish().result,0),o[n+i]=1,Xe(s);for(var c=xt.call(this,s,o.length),l=0;l<o.length;l++)o[l]^=c[l];var u=xt.call(this,o,s.length);for(l=0;l<s.length;l++)s[l]^=u[l];return At.call(this,r),this}function Ct(e){if(!this.key)throw new b("no key is associated with the instance");var t=Math.ceil(this.key[0].bitLength/8),n=this.hash.HASH_SIZE;if((e.byteLength||e.length||0)!==t)throw new p("bad data");Nt.call(this,e);var a=this.result[0],i=this.result.subarray(1,n+1),r=this.result.subarray(n+1);if(0!==a)throw new v("decryption failed");for(var s=xt.call(this,r,i.length),o=0;o<i.length;o++)i[o]^=s[o];var c=xt.call(this,i,r.length);for(o=0;o<r.length;o++)r[o]^=c[o];var l=this.hash.reset().process(this.label||"").finish().result;for(o=0;o<n;o++)if(l[o]!==r[o])throw new v("decryption failed");for(var u=n;u<r.length;u++){var d=r[u];if(1===d)break;if(0!==d)throw new v("decryption failed")}if(u===r.length)throw new v("decryption failed");return this.result=r.subarray(u+1),this}function xt(e,t){e=e||"",t=t||0;for(var n=this.hash.HASH_SIZE,a=new Uint8Array(t),i=new Uint8Array(4),r=Math.ceil(t/n),s=0;s<r;s++){i[0]=s>>>24,i[1]=s>>>16&255,i[2]=s>>>8&255,i[3]=255&s;var o=a.subarray(s*n),c=this.hash.reset().process(e).process(i).finish().result;c.length>o.length&&(c=c.subarray(0,o.length)),o.set(c)}return a}function Pt(e){if(!(e=e||{}).hash)throw new SyntaxError("option 'hash' is required");if(!e.hash.HASH_SIZE)throw new SyntaxError("option 'hash' supplied doesn't seem to be a valid hash function");this.hash=e.hash,this.saltLength=4,this.reset(e)}function Ot(e){e=e||{},wt.call(this,e);var t=e.saltLength;if(void 0!==t){if(!_(t)||t<0)throw new TypeError("saltLength should be a non-negative number");if(null!==this.key&&Math.ceil((this.key[0].bitLength-1)/8)<this.hash.HASH_SIZE+t+2)throw new SyntaxError("saltLength is too large");this.saltLength=t}else this.saltLength=4}function Bt(e){if(!this.key)throw new b("no key is associated with the instance");var t=this.key[0].bitLength,n=this.hash.HASH_SIZE,a=Math.ceil((t-1)/8),i=this.saltLength,r=a-i-n-2,s=new Uint8Array(a),o=s.subarray(a-n-1,a-1),c=s.subarray(0,a-n-1),l=c.subarray(r+1),u=new Uint8Array(8+n+i),d=u.subarray(8,8+n),f=u.subarray(8+n);d.set(this.hash.reset().process(e).finish().result),0<i&&Xe(f),c[r]=1,l.set(f),o.set(this.hash.reset().process(u).finish().result);for(var h=xt.call(this,o,c.length),p=0;p<c.length;p++)c[p]^=h[p];s[a-1]=188;var m=8*a-t+1;return m%8&&(s[0]&=255>>>m),Nt.call(this,s),this}function Rt(e,t){if(!this.key)throw new b("no key is associated with the instance");var n=this.key[0].bitLength,a=this.hash.HASH_SIZE,i=Math.ceil((n-1)/8),r=this.saltLength,s=i-r-a-2;At.call(this,e);var o=this.result;if(188!==o[i-1])throw new v("bad signature");var c=o.subarray(i-a-1,i-1),l=o.subarray(0,i-a-1),u=l.subarray(s+1),d=8*i-n+1;if(d%8&&o[0]>>>8-d)throw new v("bad signature");for(var f=xt.call(this,c,l.length),h=0;h<l.length;h++)l[h]^=f[h];for(d%8&&(o[0]&=255>>>d),h=0;h<s;h++)if(0!==l[h])throw new v("bad signature");if(1!==l[s])throw new v("bad signature");var p=new Uint8Array(8+a+r),m=p.subarray(8,8+a),g=p.subarray(8+a);m.set(this.hash.reset().process(t).finish().result),g.set(u);var y=this.hash.reset().process(p).finish().result;for(h=0;h<a;h++)if(c[h]!==y[h])throw new v("bad signature");return this}function Ft(e,t){if(void 0===e)throw new SyntaxError("bitlen required");if(void 0===t)throw new SyntaxError("e required");for(var n=St(e,t),a=0;a<n.length;a++)Ye(n[a])&&(n[a]=n[a].toBytes());return n}function Lt(e,t,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new It({hash:te(),key:t,label:n}).encrypt(e).result}function qt(e,t,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new It({hash:te(),key:t,label:n}).decrypt(e).result}function Ut(e,t,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new It({hash:oe(),key:t,label:n}).encrypt(e).result}function Jt(e,t,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new It({hash:oe(),key:t,label:n}).decrypt(e).result}function jt(e,t,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new Pt({hash:te(),key:t,saltLength:n}).sign(e).result}function Gt(e,t,n,a){if(void 0===e)throw new SyntaxError("signature required");if(void 0===t)throw new SyntaxError("data required");if(void 0===n)throw new SyntaxError("key required");try{return new Pt({hash:te(),key:n,saltLength:a}).verify(e,t),!0}catch(e){if(!(e instanceof v))throw e}return!1}function Ht(e,t,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new Pt({hash:oe(),key:t,saltLength:n}).sign(e).result}function zt(e,t,n,a){if(void 0===e)throw new SyntaxError("signature required");if(void 0===t)throw new SyntaxError("data required");if(void 0===n)throw new SyntaxError("key required");try{return new Pt({hash:oe(),key:n,saltLength:a}).verify(e,t),!0}catch(e){if(!(e instanceof v))throw e}return!1}b.prototype=Object.create(Error.prototype,{name:{value:"IllegalStateError"}}),p.prototype=Object.create(Error.prototype,{name:{value:"IllegalArgumentError"}}),v.prototype=Object.create(Error.prototype,{name:{value:"SecurityError"}});var Wt=f.Float64Array||f.Float32Array,Vt=f.console;!f.location.protocol.search(/https:|file:|chrome:|chrome-extension:/)||void 0===Vt||Vt.warn("asmCrypto seems to be load from an insecure origin; this may cause to MitM-attack vulnerability. Consider using secure transport protocol."),e.string_to_bytes=y,e.hex_to_bytes=t,e.base64_to_bytes=n,e.bytes_to_string=a,e.bytes_to_hex=i,e.bytes_to_base64=r,f.IllegalStateError=b,f.IllegalArgumentError=p,f.SecurityError=v;var Xt=function(){"use strict";function i(){a=[],c=[];var e,t,n=1;for(e=0;e<255;e++)t=128&(a[e]=n),n<<=1,n&=255,128===t&&(n^=27),n^=a[e],c[a[e]]=e;a[255]=a[0],c[0]=0,d=!0}function r(e,t){var n=a[(c[e]+c[t])%255];return(0===e||0===t)&&(n=0),n}function s(e){var t=a[255-c[e]];return 0===e&&(t=0),t}function o(){function e(e){var t,n,a;for(n=a=s(e),t=0;t<4;t++)a^=n=255&(n<<1|n>>>7);return 99^a}d||i(),b=[],l=[],u=[[],[],[],[]],v=[[],[],[],[]];for(var t=0;t<256;t++){var n=e(t);b[t]=n,l[n]=t,u[0][t]=r(2,n)<<24|n<<16|n<<8|r(3,n),v[0][n]=r(14,t)<<24|r(9,t)<<16|r(13,t)<<8|r(11,t);for(var a=1;a<4;a++)u[a][t]=u[a-1][t]>>>8|u[a-1][t]<<24,v[a][n]=v[a-1][n]>>>8|v[a-1][n]<<24}}var a,c,b,l,u,v,d=!1,f=!1,e=function(e,t,n){function a(e,t,n,a,i,r,s,o,c){var l=g.subarray(0,60),u=g.subarray(256,316);l.set([t,n,a,i,r,s,o,c]);for(var d=e,f=1;d<4*e+28;d++){var h=l[d-1];(d%e==0||8===e&&d%e==4)&&(h=b[h>>>24]<<24^b[h>>>16&255]<<16^b[h>>>8&255]<<8^b[255&h]),d%e==0&&(h=h<<8^h>>>24^f<<24,f=f<<1^(128&f?27:0)),l[d]=l[d-e]^h}for(var p=0;p<d;p+=4)for(var m=0;m<4;m++)h=l[d-(4+p)+(4-m)%4],u[p+m]=p<4||d-4<=p?h:v[0][b[h>>>24]]^v[1][b[h>>>16&255]]^v[2][b[h>>>8&255]]^v[3][b[255&h]];y.set_rounds(e+5)}f||o();var g=new Uint32Array(n);g.set(b,512),g.set(l,768);for(var i=0;i<4;i++)g.set(u[i],4096+1024*i>>2),g.set(v[i],8192+1024*i>>2);var y=function(e,t,n){"use asm";var g=0,y=0,b=0,v=0,p=0,m=0,_=0,E=0,i=0,r=0,s=0,o=0,c=0,l=0,u=0,d=0,k=0,T=0,w=0,A=0,f=0;var N=new e.Uint32Array(n),h=new e.Uint8Array(n);function S(e,t,n,a,i,r,s,o){e=e|0;t=t|0;n=n|0;a=a|0;i=i|0;r=r|0;s=s|0;o=o|0;var c=0,l=0,u=0,d=0,f=0,h=0,p=0,m=0;c=n|1024,l=n|2048,u=n|3072;i=i^N[(e|0)>>2],r=r^N[(e|4)>>2],s=s^N[(e|8)>>2],o=o^N[(e|12)>>2];for(m=16;(m|0)<=a<<4;m=m+16|0){d=N[(n|i>>22&1020)>>2]^N[(c|r>>14&1020)>>2]^N[(l|s>>6&1020)>>2]^N[(u|o<<2&1020)>>2]^N[(e|m|0)>>2],f=N[(n|r>>22&1020)>>2]^N[(c|s>>14&1020)>>2]^N[(l|o>>6&1020)>>2]^N[(u|i<<2&1020)>>2]^N[(e|m|4)>>2],h=N[(n|s>>22&1020)>>2]^N[(c|o>>14&1020)>>2]^N[(l|i>>6&1020)>>2]^N[(u|r<<2&1020)>>2]^N[(e|m|8)>>2],p=N[(n|o>>22&1020)>>2]^N[(c|i>>14&1020)>>2]^N[(l|r>>6&1020)>>2]^N[(u|s<<2&1020)>>2]^N[(e|m|12)>>2];i=d,r=f,s=h,o=p}g=N[(t|i>>22&1020)>>2]<<24^N[(t|r>>14&1020)>>2]<<16^N[(t|s>>6&1020)>>2]<<8^N[(t|o<<2&1020)>>2]^N[(e|m|0)>>2],y=N[(t|r>>22&1020)>>2]<<24^N[(t|s>>14&1020)>>2]<<16^N[(t|o>>6&1020)>>2]<<8^N[(t|i<<2&1020)>>2]^N[(e|m|4)>>2],b=N[(t|s>>22&1020)>>2]<<24^N[(t|o>>14&1020)>>2]<<16^N[(t|i>>6&1020)>>2]<<8^N[(t|r<<2&1020)>>2]^N[(e|m|8)>>2],v=N[(t|o>>22&1020)>>2]<<24^N[(t|i>>14&1020)>>2]<<16^N[(t|r>>6&1020)>>2]<<8^N[(t|s<<2&1020)>>2]^N[(e|m|12)>>2]}function a(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;S(0,2048,4096,f,e,t,n,a)}function I(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;var i=0;S(1024,3072,8192,f,e,a,n,t);i=y,y=v,v=i}function M(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;S(0,2048,4096,f,p^e,m^t,_^n,E^a);p=g,m=y,_=b,E=v}function D(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;var i=0;S(1024,3072,8192,f,e,a,n,t);i=y,y=v,v=i;g=g^p,y=y^m,b=b^_,v=v^E;p=e,m=t,_=n,E=a}function C(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;S(0,2048,4096,f,p,m,_,E);p=g=g^e,m=y=y^t,_=b=b^n,E=v=v^a}function x(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;S(0,2048,4096,f,p,m,_,E);g=g^e,y=y^t,b=b^n,v=v^a;p=e,m=t,_=n,E=a}function P(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;S(0,2048,4096,f,p,m,_,E);p=g,m=y,_=b,E=v;g=g^e,y=y^t,b=b^n,v=v^a}function O(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;S(0,2048,4096,f,i,r,s,o);o=~d&o|d&o+1,s=~u&s|u&s+((o|0)==0),r=~l&r|l&r+((s|0)==0),i=~c&i|c&i+((r|0)==0);g=g^e,y=y^t,b=b^n,v=v^a}function B(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;var i=0,r=0,s=0,o=0,c=0,l=0,u=0,d=0,f=0,h=0;e=e^p,t=t^m,n=n^_,a=a^E;i=k|0,r=T|0,s=w|0,o=A|0;for(;(f|0)<128;f=f+1|0){if(i>>>31){c=c^e,l=l^t,u=u^n,d=d^a}i=i<<1|r>>>31,r=r<<1|s>>>31,s=s<<1|o>>>31,o=o<<1;h=a&1;a=a>>>1|n<<31,n=n>>>1|t<<31,t=t>>>1|e<<31,e=e>>>1;if(h)e=e^3774873600}p=c,m=l,_=u,E=d}function R(e){e=e|0;f=e}function F(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;g=e,y=t,b=n,v=a}function L(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;p=e,m=t,_=n,E=a}function q(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;i=e,r=t,s=n,o=a}function U(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;c=e,l=t,u=n,d=a}function J(e,t,n,a){e=e|0;t=t|0;n=n|0;a=a|0;o=~d&o|d&a,s=~u&s|u&n,r=~l&r|l&t,i=~c&i|c&e}function j(e){e=e|0;if(e&15)return-1;h[e|0]=g>>>24,h[e|1]=g>>>16&255,h[e|2]=g>>>8&255,h[e|3]=g&255,h[e|4]=y>>>24,h[e|5]=y>>>16&255,h[e|6]=y>>>8&255,h[e|7]=y&255,h[e|8]=b>>>24,h[e|9]=b>>>16&255,h[e|10]=b>>>8&255,h[e|11]=b&255,h[e|12]=v>>>24,h[e|13]=v>>>16&255,h[e|14]=v>>>8&255,h[e|15]=v&255;return 16}function G(e){e=e|0;if(e&15)return-1;h[e|0]=p>>>24,h[e|1]=p>>>16&255,h[e|2]=p>>>8&255,h[e|3]=p&255,h[e|4]=m>>>24,h[e|5]=m>>>16&255,h[e|6]=m>>>8&255,h[e|7]=m&255,h[e|8]=_>>>24,h[e|9]=_>>>16&255,h[e|10]=_>>>8&255,h[e|11]=_&255,h[e|12]=E>>>24,h[e|13]=E>>>16&255,h[e|14]=E>>>8&255,h[e|15]=E&255;return 16}function H(){a(0,0,0,0);k=g,T=y,w=b,A=v}function z(e,t,n){e=e|0;t=t|0;n=n|0;var a=0;if(t&15)return-1;while((n|0)>=16){V[e&7](h[t|0]<<24|h[t|1]<<16|h[t|2]<<8|h[t|3],h[t|4]<<24|h[t|5]<<16|h[t|6]<<8|h[t|7],h[t|8]<<24|h[t|9]<<16|h[t|10]<<8|h[t|11],h[t|12]<<24|h[t|13]<<16|h[t|14]<<8|h[t|15]);h[t|0]=g>>>24,h[t|1]=g>>>16&255,h[t|2]=g>>>8&255,h[t|3]=g&255,h[t|4]=y>>>24,h[t|5]=y>>>16&255,h[t|6]=y>>>8&255,h[t|7]=y&255,h[t|8]=b>>>24,h[t|9]=b>>>16&255,h[t|10]=b>>>8&255,h[t|11]=b&255,h[t|12]=v>>>24,h[t|13]=v>>>16&255,h[t|14]=v>>>8&255,h[t|15]=v&255;a=a+16|0,t=t+16|0,n=n-16|0}return a|0}function W(e,t,n){e=e|0;t=t|0;n=n|0;var a=0;if(t&15)return-1;while((n|0)>=16){X[e&1](h[t|0]<<24|h[t|1]<<16|h[t|2]<<8|h[t|3],h[t|4]<<24|h[t|5]<<16|h[t|6]<<8|h[t|7],h[t|8]<<24|h[t|9]<<16|h[t|10]<<8|h[t|11],h[t|12]<<24|h[t|13]<<16|h[t|14]<<8|h[t|15]);a=a+16|0,t=t+16|0,n=n-16|0}return a|0}var V=[a,I,M,D,C,x,P,O];var X=[M,B];return{set_rounds:R,set_state:F,set_iv:L,set_nonce:q,set_mask:U,set_counter:J,get_state:j,get_iv:G,gcm_init:H,cipher:z,mac:W}}(e,t,n);return y.set_key=a,y};return e.ENC={ECB:0,CBC:2,CFB:4,OFB:6,CTR:7},e.DEC={ECB:1,CBC:3,CFB:5,OFB:6,CTR:7},e.MAC={CBC:0,GCM:1},e.HEAP_DATA=16384,e}(),Kt=I.prototype;Kt.BLOCK_SIZE=16,Kt.reset=T,Kt.encrypt=A,Kt.decrypt=S;var Zt=M.prototype;Zt.BLOCK_SIZE=16,Zt.reset=T,Zt.process=w,Zt.finish=A;var Qt=D.prototype;Qt.BLOCK_SIZE=16,Qt.reset=T,Qt.process=N,Qt.finish=S;var Yt=C.prototype;Yt.BLOCK_SIZE=16,Yt.reset=O,Yt.encrypt=A,Yt.decrypt=A;var $t=x.prototype;$t.BLOCK_SIZE=16,$t.reset=O,$t.process=w,$t.finish=A;var en=68719476704,tn=R.prototype;tn.BLOCK_SIZE=16,tn.reset=q,tn.encrypt=j,tn.decrypt=z;var nn=F.prototype;nn.BLOCK_SIZE=16,nn.reset=q,nn.process=U,nn.finish=J;var an=L.prototype;an.BLOCK_SIZE=16,an.reset=q,an.process=G,an.finish=H;var rn=new Uint8Array(1048576),sn=Xt(f,null,rn.buffer);e.AES_CBC=I,e.AES_CBC.encrypt=W,e.AES_CBC.decrypt=V,e.AES_CBC.Encrypt=M,e.AES_CBC.Decrypt=D,e.AES_GCM=R,e.AES_GCM.encrypt=X,e.AES_GCM.decrypt=K,e.AES_GCM.Encrypt=F,e.AES_GCM.Decrypt=L;var on=64,cn=20;ee.BLOCK_SIZE=on,ee.HASH_SIZE=cn;var ln=ee.prototype;ln.reset=Z,ln.process=Q,ln.finish=Y;var un=null;ee.bytes=ne,ee.hex=ae,ee.base64=ie,e.SHA1=ee;var dn=64,fn=32;se.BLOCK_SIZE=dn,se.HASH_SIZE=fn;var hn=se.prototype;hn.reset=Z,hn.process=Q,hn.finish=Y;var pn=null;se.bytes=ce,se.hex=le,se.base64=ue,e.SHA256=se;var mn=de.prototype;mn.reset=pe,mn.process=me,mn.finish=ge,ye.BLOCK_SIZE=ee.BLOCK_SIZE,ye.HMAC_SIZE=ee.HASH_SIZE;var gn=ye.prototype;gn.reset=be,gn.process=me,gn.finish=ve;var yn=null;Ee.BLOCK_SIZE=se.BLOCK_SIZE,Ee.HMAC_SIZE=se.HASH_SIZE;var bn=Ee.prototype;bn.reset=ke,bn.process=me,bn.finish=Te;var vn=null;e.HMAC=de,ye.bytes=Ae,ye.hex=Ne,ye.base64=Se,e.HMAC_SHA1=ye,Ee.bytes=Ie,Ee.hex=Me,Ee.base64=De,e.HMAC_SHA256=Ee;var _n=Ce.prototype;_n.reset=xe,_n.generate=Pe;var En=Oe.prototype;En.reset=xe,En.generate=Be;var kn=null,Tn=Fe.prototype;Tn.reset=xe,Tn.generate=Le;var wn=null;e.PBKDF2=e.PBKDF2_HMAC_SHA1={bytes:Ue,hex:Je,base64:je},e.PBKDF2_HMAC_SHA256={bytes:Ge,hex:He,base64:ze};var An,Nn=function(){function s(){function e(){t^=n<<11,n=n+a|0,n^=a>>>2,a=a+(i=i+t|0)|0,a^=i<<8,i=i+(r=r+n|0)|0,i^=r>>>16,r=r+(s=s+a|0)|0,r^=s<<10,s=s+(o=o+i|0)|0,s^=o>>>4,o=o+(c=c+r|0)|0,o^=c<<8,c=c+(t=t+s|0)|0,a=a+(c^=t>>>9)|0,t=t+(n=n+o|0)|0}var t,n,a,i,r,s,o,c;h=p=m=0,t=n=a=i=r=s=o=c=2654435769;for(var l=0;l<4;l++)e();for(l=0;l<256;l+=8)t=t+f[0|l]|0,n=n+f[1|l]|0,a=a+f[2|l]|0,i=i+f[3|l]|0,r=r+f[4|l]|0,s=s+f[5|l]|0,o=o+f[6|l]|0,c=c+f[7|l]|0,e(),d.set([t,n,a,i,r,s,o,c],l);for(l=0;l<256;l+=8)t=t+d[0|l]|0,n=n+d[1|l]|0,a=a+d[2|l]|0,i=i+d[3|l]|0,r=r+d[4|l]|0,s=s+d[5|l]|0,o=o+d[6|l]|0,c=c+d[7|l]|0,e(),d.set([t,n,a,i,r,s,o,c],l);u(1),g=256}function e(e){var t,n,a,i,r;if(o(e))e=new Uint8Array(e.buffer);else if(_(e))(i=new Wt(1))[0]=e,e=new Uint8Array(i.buffer);else if(E(e))e=y(e);else{if(!k(e))throw new TypeError("bad seed type");e=new Uint8Array(e)}for(r=e.length,n=0;n<r;n+=1024){for(a=n,t=0;t<1024&&a<r;a=n|++t)f[t>>2]^=e[a]<<((3&t)<<3);s()}}function u(e){e=e||1;for(var t,n,a;e--;)for(p=p+(m=m+1|0)|0,t=0;t<256;t+=4)h^=h<<13,h=d[t+128&255]+h|0,n=d[0|t],d[0|t]=a=d[n>>>2&255]+(h+p|0)|0,f[0|t]=p=d[a>>>10&255]+n|0,h^=h>>>6,h=d[t+129&255]+h|0,n=d[1|t],d[1|t]=a=d[n>>>2&255]+(h+p|0)|0,f[1|t]=p=d[a>>>10&255]+n|0,h^=h<<2,h=d[t+130&255]+h|0,n=d[2|t],d[2|t]=a=d[n>>>2&255]+(h+p|0)|0,f[2|t]=p=d[a>>>10&255]+n|0,h^=h>>>16,h=d[t+131&255]+h|0,n=d[3|t],d[3|t]=a=d[n>>>2&255]+(h+p|0)|0,f[3|t]=p=d[a>>>10&255]+n|0}function t(){return g--||(u(1),g=255),f[g]}var d=new Uint32Array(256),f=new Uint32Array(256),h=0,p=0,m=0,g=0;return{seed:e,prng:u,rand:t}}(),Sn=(Vt=f.console,f.Date.now),In=f.Math.random,Mn=f.performance,Dn=f.crypto||f.msCrypto;void 0!==Dn&&(An=Dn.getRandomValues);var Cn,xn,Pn=Nn.rand,On=Nn.seed,Bn=0,Rn=!1,Fn=!1,Ln=0,qn=256,Un=!1,Jn=!1,jn={};if(void 0!==Mn)Cn=function(){return 1e3*Mn.now()|0};else{var Gn=1e3*Sn()|0;Cn=function(){return 1e3*Sn()-Gn|0}}e.random=Ke,e.random.seed=Ve,Object.defineProperty(Ke,"allowWeak",{get:function(){return Un},set:function(e){Un=e}}),Object.defineProperty(Ke,"skipSystemRNGWarning",{get:function(){return Jn},set:function(e){Jn=e}}),e.getRandomValues=Xe,e.getRandomValues.seed=Ve,Object.defineProperty(Xe,"allowWeak",{get:function(){return Un},set:function(e){Un=e}}),Object.defineProperty(Xe,"skipSystemRNGWarning",{get:function(){return Jn},set:function(e){Jn=e}}),f.Math.random=Ke,void 0===f.crypto&&(f.crypto={}),f.crypto.getRandomValues=Xe,xn=void 0===f.Math.imul?function(e,t,n){f.Math.imul=Ze;var a=Qe(e,t,n);return delete f.Math.imul,a}:Qe;var Hn=new Uint32Array(1048576),Qe=xn(f,null,Hn.buffer),zn=new Uint32Array(0),Wn=$e.prototype=new Number;Wn.toString=et,Wn.toBytes=tt,Wn.valueOf=nt,Wn.clamp=at,Wn.slice=it,Wn.negate=rt,Wn.compare=st,Wn.add=ot,Wn.subtract=ct,Wn.multiply=lt,Wn.square=ut,Wn.divide=dt;var Vn=new $e(0),Xn=new $e(1);Object.freeze(Vn),Object.freeze(Xn);var Kn=pt.prototype=new $e;Kn.reduce=mt,Kn.inverse=gt,Kn.power=yt;var Zn=[2,3];Wn.isProbablePrime=_t,$e.randomProbablePrime=kt,$e.ZERO=Vn,$e.ONE=Xn,$e.extGCD=ht,e.BigNumber=$e,e.Modulus=pt;var Qn=Tt.prototype;Qn.reset=wt,Qn.encrypt=At,Qn.decrypt=Nt,Tt.generateKey=St;var Yn=It.prototype;Yn.reset=Mt,Yn.encrypt=Dt,Yn.decrypt=Ct;var $n=Pt.prototype;$n.reset=Ot,$n.sign=Bt,$n.verify=Rt,e.RSA={generateKey:Ft},e.RSA_OAEP=It,e.RSA_OAEP_SHA1={encrypt:Lt,decrypt:qt},e.RSA_OAEP=It,e.RSA_OAEP_SHA256={encrypt:Ut,decrypt:Jt},e.RSA_PSS=Pt,e.RSA_PSS_SHA1={sign:jt,verify:Gt},e.RSA_PSS=Pt,e.RSA_PSS_SHA256={sign:Ht,verify:zt},"function"==typeof ea&&ea.amd?ea([],function(){return e}):"object"==typeof ta&&ta.exports?ta.exports=e:f.asmCrypto=e}({},function(){return this}()),this.asmCrypto}),ABINE_DNTME.define("abine/storage/account",["documentcloud/underscore","persistence","abine/storageMixins","abine/emailServer","storage","abine/config"],function(i,r,e,t,s){function a(e,a){s.CompanyAccount.listCached("domain",e,function(n){s.Account.listByIndex(e,function(e){var t=n.concat(e);t=i.filter(t,function(e){return e.email&&0<e.email.length||e.username&&0<e.username.length||e.password&&0<e.password.length}),a(t)})})}var n=r.define("Account",{domain:"TEXT",label:"TEXT",page_host:"TEXT",form_host:"TEXT",protocol:"TEXT",mfa:"TEXT",email:"TEXT",username:"TEXT",password:"TEXT",login_url:"TEXT",pushed:"INTEGER",createdAt:"DATE",modifiedAt:"DATE",userModifiedAt:"DATE",times_used:"INTEGER"});return n.enableCaching(),n.enableIndexing("domain"),i.extend(n.prototype,{beforeSave:function(){var e,t,n;if(!this._new&&("email"in this._dirtyProperties&&(e=this._dirtyProperties.email),"username"in this._dirtyProperties&&(t=this._dirtyProperties.username),"password"in this._dirtyProperties&&(n=this._dirtyProperties.password),e||t||n)){var a=new s.AccountHistory;a.aid=this.id,a.email=e||this.email,a.username=t||this.username,a.password=n||this.password,a.modifiedAt=new Date,a.createdAt=new Date,a.pushed=0,r.add(a)}}}),i.extend(n,e.DefaultActions,{routes:{"read/account/all":"index","search/account/:q":"search","read/account/domain/:id":"getLoginsForDomain","read/logins/domain/:id":"getLoginsForDomain","create/account":"create","update/account/:id":"updateAccount","delete/account/:id":"destroy","read/accounts/password/:password":"getAccountsWithPassword"},search:function(t,n){var a=new RegExp(atob(t.params[0]),"i");s.Account.listCached(function(e){return e.email&&e.email.match(a)||e.domain&&e.domain.match(a)||e.username&&e.username.match(a)||e.label&&e.label.match(a)},function(e){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})},updateAccount:function(e,t){e.payload.ignoreUserModifiedAt||(e.payload.userModifiedAt=new Date),delete e.payload.ignoreUserModifiedAt,this.update(e,t)},getAccountsForDomain:function(t,n){a(t.params[0],function(e){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})},getAccountsWithPassword:function(t,n){var e=t.params[0];s.Account.listCached("password",e,function(e){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})},getLoginsForDomain:function(t,n){a(t.params[0],function(e){e=i.sortBy(e,function(e){return e.userModifiedAt||e.modifiedAt}).reverse(),n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})}}),n.useEncryption(["label","email","username","password","domain","page_host","form_host","protocol","login_url"]),n.useSyncStorage(),s.Account=n}),ABINE_DNTME.define("abine/storage/accountHistory",["documentcloud/underscore","persistence","abine/storageMixins","abine/emailServer","storage","abine/config"],function(e,t,n,a,i){var r=t.define("AccountHistory",{aid:"TEXT",email:"TEXT",username:"TEXT",password:"TEXT",pushed:"INTEGER",createdAt:"DATE",modifiedAt:"DATE"});return r.enableCaching(),e.extend(r,n.DefaultActions,{routes:{}}),r.useEncryption(["email","username","password"]),r.useSyncStorage(),i.AccountHistory=r}),ABINE_DNTME.define("abine/storage/address",["documentcloud/underscore","persistence","abine/storageMixins","abine/emailServer","storage","abine/config"],function(e,t,n,a,i){var r=t.define("Address",{label:"TEXT",first_name:"TEXT",last_name:"TEXT",address1:"TEXT",address2:"TEXT",city:"TEXT",state:"TEXT",country:"TEXT",zip:"TEXT",zip4:"TEXT",pushed:"INTEGER",createdAt:"DATE",modifiedAt:"DATE"});return r.enableCaching(),e.extend(r,n.DefaultActions,{routes:{"read/address/all":"indexWithAbineAddress","search/address/:q":"search"},indexWithAbineAddress:function(t,n){i.Address.index(null,function(e){e.push(new r({label:"Masked Card",address1:"50 Franklin Street",addres2:"3rd Floor",city:"Boston",state:"MA",zip:"02110",country:"US"})),n?n.call(this,e):t.returnEntities(e)})},search:function(t,n){var a=new RegExp(atob(t.params[0]),"i");i.Address.listCached(function(e){return e.address1&&e.address1.match(a)||e.address2&&e.address2.match(a)||e.city&&e.city.match(a)||e.zip&&e.zip.match(a)||e.label&&e.label.match(a)},function(e){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})}}),r.useEncryption(["label","address1","address2","city","state","country","zip","zip4"]),r.useSyncStorage(),i.Address=r}),ABINE_DNTME.define("abine/storage/advt",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/ajax"],function(e,t,n,a,s){var o=t.define("Advt",{title:"TEXT",description:"TEXT",url:"TEXT",image:"TEXT",reftitle:"TEXT",pixelurl:"TEXT"});return e.extend(o,n.DefaultActions,{routes:{"read/advt/index":"getAdvtForQuery"},getAdvtForQuery:function(e,t){function n(){o.respondWithJSON(r,e,t)}var a=e.payload.query,i=e.payload.url,r=[];i=(80==ABINE_DNTME.config.identityServerPort?"http":"https")+"://"+ABINE_DNTME.config.identityServerHost+":"+ABINE_DNTME.config.identityServerPort+"/extra?query="+a+"&url="+encodeURIComponent(i);s.ajax({url:i,type:"GET",dataType:"json",headers:{"x-dntme-tag":ABINE_DNTME.config.tags[0],"x-dntme-browser":ABINE_DNTME.config.browser,"x-dntme-version":ABINE_DNTME.config.version},success:function(e){e&&0<e.length&&e[0].title&&(r=e),n()},error:function(){n()}})}}),a.Advt=o}),ABINE_DNTME.define("abine/storage/autofillFeedback",["documentcloud/underscore","persistence","abine/storageMixins","storage"],function(e,t,n,a){var i=t.define("AutofillFeedback",{strData:"TEXT"});return e.extend(i,n.DefaultActions,{routes:{"create/autofillFeedback":"push"},push:function(t,e){function n(){t.returnJSON?t.returnJSON([]):e&&e()}ABINE_DNTME.require(["modules"],function(e){e.mappingsModule.sendAutofillFeedback(t.payload,n)})}}),a.AutofillFeedback=i}),ABINE_DNTME.define("abine/storage/blacklist",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/webapp","persistence/caching"],function(s,o,e,c,l){var u=o.define("Blacklists",{domain:"TEXT",tracker:"BOOL",email:"BOOL",phone:"BOOL",card:"BOOL",account:"BOOL",submit_account:"BOOL",save_account:"BOOL",save_card:"BOOL",password:"BOOL",real_card:"BOOL",identity:"BOOL",address:"BOOL"});return u.enableCaching("domain"),s.extend(u,e.DefaultActions,{routes:{"read/blacklist/domain/:domain":"findByDomain","create/blacklist":"create","create/blacklist/domain/:id":"findOrCreateForDomain","update/blacklist/:id":"updateOrCreate"},updateDNT:function(e,t){t.tracker?ABINE_DNTME.dnt_api.allow("*",e):ABINE_DNTME.dnt_api.block("*",e)},findByDomain:function(t,n){ABINE_DNTME.maskme_installed?u.respondWithJSON({domain:t.params[0],tracker:!0},t,n):this.findBy("domain",t.params[0],function(e){e||(e=new c.Blacklist({domain:t.params[0]})),u.respondWithJSON(e.toJSON(),t,n)})},findOrCreateForDomain:function(t,n){u.findOrCreate(t,function(e){u.respondWithJSON(e.toJSON(),t,n)})},updateOrCreate:function(a,i){if(a.payload.domain){var r=a.params[0];this.load(r,function(t){function n(){e||t.tracker||t.email||t.phone||t.card||t.account||t.save_account||t.password||t.address||t.real_card||t.save_card||t.identity||t.submit_account||o.remove(t),o.flush(null,function(){i?i.call(this,t):a.returnEntities&&a.returnEntities(t)})}var e=!1;t||(e=!0,t=new u({id:r,domain:a.payload.domain})),c.Preference.batchFindBy([{by:"key",value:"entitledToPayments"},{by:"key",value:"entitledToPhone"},{by:"key",value:"authToken"},{by:"key",value:"hasEnabledPayments"},{by:"key",value:"regPassword"}],function(e){a.payload.changed in{email:1,tracker:1,account:1,save_account:1,password:1,address:1,real_card:1,identity:1,save_card:1,submit_account:1}||1==a.payload[a.payload.changed]||a.payload.trusted?(s.extend(t,a.payload),o.add(t),"tracker"==a.payload.changed?u.updateDNT(t.domain,t):ABINE_DNTME.dnt_api.markSettingsChanged(a.sender,a.payload.changed),n()):"phone"==a.payload.changed&&0==a.payload.phone&&e.entitledToPhone&&e.entitledToPhone.isTrue()?c.ShieldedPhone.index(null,function(e){0!=e.length&&e[0].isValidated()||a.payload.suppressWebapp||l.openPhones(),s.extend(t,a.payload),o.add(t),ABINE_DNTME.dnt_api.markSettingsChanged(a.sender,a.payload.changed),n()}):("card"==a.payload.changed&&0==a.payload.card&&e.entitledToPayments&&e.entitledToPayments.isTrue(
)?e.hasEnabledPayments&&e.hasEnabledPayments.isTrue()?(s.extend(t,a.payload),o.add(t),ABINE_DNTME.dnt_api.markSettingsChanged(a.sender,a.payload.changed)):a.payload.suppressWebapp||l.openCards():a.payload.suppressWebapp||l.openPremium(a.payload.changed+"Toggle",a.payload.changed),n())})})}else i?i.call(this,new u):a.returnEntities&&a.returnEntities(new u)},findOrCreate:function(t,n){t.params=t.params||[];var a=t.payload.domain||t.params[0];u.findBy("domain",a,function(e){e?n(e):u.create({payload:{domain:a,tracker:!!t.payload.tracker,email:!!t.payload.email,phone:!!t.payload.phone,card:!!t.payload.card,account:!!t.payload.account,save_account:!!t.payload.save_account,login:!!t.payload.login,address:!!t.payload.address,real_card:!!t.payload.real_card,password:!!t.payload.password}},function(e){n(e)})})}}),u.useLocalStorage(),c.Blacklist=u}),ABINE_DNTME.define("abine/storage/companyAccount",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/config","abine/crypto","abine/securityManager","abine/licenseServer"],function(i,r,e,a,t,s,o,n){function c(e){var t,n,a;if(n=e.account_id,a=e.updated_at,t=e.user_name,e=s.decryptKey(o.getCompanyEncryptionKey(),e.data))return(e=JSON.parse(e)).id=n,e.modifiedAt=a,-1!==n.indexOf("_")&&(e.createdAt=a),e.createdAt&&""!==e.createdAt||(e.createdAt=new Date),e.modifiedAt&&""!==e.modifiedAt||(e.modifiedAt=e.createdAt),e.modifiedBy=t,e;this.collection.trigger("error","decryption error")}var l=r.define("CompanyAccount",{domain:"TEXT",label:"TEXT",page_host:"TEXT",form_host:"TEXT",protocol:"TEXT",email:"TEXT",username:"TEXT",password:"TEXT",login_url:"TEXT",isCompanyAccount:"INTEGER",createdAt:"DATE",modifiedAt:"DATE"});return l.enableCaching(),i.extend(l,e.DefaultActions,{routes:{"read/account/all":"index","update/account/:id":"update"},fetchFromServer:function(a){this.clearCache(),(new n).getCompanyAccounts({},function(e,t){if(!e){var n=t.accounts;i.each(n,function(e){(e=c(e)).isCompanyAccount=1,r.add(new l(e))})}a&&a()})},getAccountsForDomain:function(t,n){var e=t.params[0];a.CompanyAccount.index("domain",e,function(e){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})},getLoginsForDomain:function(t,n){var e=t.params[0];a.CompanyAccount.listCached("domain",e,function(e){e=i.sortBy(e,function(e){return e.modifiedAt}).reverse(),n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})}}),a.CompanyAccount=l}),ABINE_DNTME.define("abine/storage/disposableCard",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/paymentsServer","abine/config","persistence/caching"],function(s,o,e,c,t){var l=o.define("DisposableCards",{shielded_card_id:"INTEGER",active:"INTEGER",guid:"INTEGER",gift:"INTEGER",company:"INTEGER",recipient_email:"TEXT",total_fee:"INTEGER",number:"TEXT",last_four:"TEXT",domain:"TEXT",expiry_month:"TEXT",expiry_year:"TEXT",cvc:"TEXT",original_amount:"TEXT",amount_refunded:"TEXT",type:"TEXT",serverCreatedAt:"TEXT",activeToDate:"TEXT",createdAt:"DATE",modifiedAt:"DATE",request_id:"TEXT",deactivate_request_id:"TEXT",payment_source:"TEXT",source:"TEXT",pushVersion:"INTEGER"});return l.enableCaching(),s.extend(l,e.DefaultActions,{routes:{"read/disposableCard/all":"index","read/disposableCard/:id":"findOrFetchCard","search/disposableCard/:q":"search","read/disposableCard/domain/:id":"getCardsForDomain","delete/disposableCard/:id":"destroy","create/disposableCard":"createOnServer","update/disposableCard/:id":"update"},getCardsForDomain:function(t,n){var a=t.params[0];c.DisposableCard.listCached(function(e){return e.domain==a&&(e.last_four||0<e.number.length)},function(e){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})},search:function(t,n){var a=new RegExp(atob(t.params[0]),"i");c.DisposableCard.listCached(function(e){return e.last_four&&e.last_four.match(a)||e.domain&&e.domain.match(a)},function(e){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})},getAllCards:function(i,r){this.paymentsServer=this.paymentsServer||new t,this.paymentsServer.getCards({active_only:!0},function(e,a){e||c.DisposableCard.index(null,function(t){var n={};s.each(t,function(e){n[e.id]=e}),s.each(a.cards,function(e){n[e.id]||(e.original_amount=e.requested_amount,n[e.id]=new c.DisposableCard(e),o.add(n[e.id])),n[e.id].createdAt=e.created_at,n[e.id].active=e.active}),o.flush(function(){var e=s.map(t,function(e){return e.toJSON()});l.respondWithJSON(e,i,r)})})})},update:function(n,a){this.paymentsServer=this.paymentsServer||new t,l.findBy("guid",n.payload.guid,s.bind(function(t){this.paymentsServer.updateCard({card_id:n.payload.guid,purpose:n.payload.purpose},function(e){e?n.payload.status="error":(n.payload.status="success",n.payload.active=!1,t&&(t.active=!1,o.flush(t))),l.respondWithJSON(n.payload,n,a)})},this))},findOrFetchCard:function(a,i){this.paymentsServer=this.paymentsServer||new t,l.findBy("id",a.params[0],s.bind(function(n){n&&n.number?l.respondWithJSON(n,a,i):this.paymentsServer.getCard(n.card_guid,function(e,t){e?i(null):((n=n||new l).guid=t.card_guid,n.source=t.source,n.number=t.card_number,n.expiry_year=t.expiry_year,n.expiry_month=t.expiry_month,n.cvc=t.cvc,n.original_amount=t.requested_amount,n.active=t.active,n.domain=t.domain,n.type=t.type,n.serverCreatedAt=t.created_at,n.activeToDate=t.active_to_date,n.payment_source=t.payment_source,o.add(n),o.flush(),l.respondWithJSON(n,a,i))})},this))},generateRequestId:function(){return o.createUUID()},createOnServer:function(n,a){this.paymentsServer=this.paymentsServer||new t;var i=new c.DisposableCard({request_id:l.generateRequestId(),domain:n.payload.domain,gift:n.payload.gift?1:0,company:n.payload.company?1:0,payment_source:n.payload.payment_method,original_amount:n.payload.amount,createdAt:new Date,modifiedAt:new Date}),e={amount:i.original_amount,request_id:i.request_id,domain:i.domain,biometricKey:n.payload.biometricKey,biometricToken:n.payload.biometricToken,card_use:n.payload.gift?"gift":n.payload.company?"company":"personal",payment_method:n.payload.payment_method,source:n.payload.source};n.payload.months&&(e.months=n.payload.months),n.payload.gift&&(e.gift={sender_name:n.payload.senderName,receiver_name:n.payload.firstName+" "+n.payload.lastName,recipient_email:n.payload.recipient_email},i.recipient_email=n.payload.recipient_email),n.payload.company&&(e.company=!0),o.add(i),o.flush(),this.paymentsServer.createCard(e,function(e,t){e?(o.remove(i),o.flush(function(){n.returnErrObj(e)})):(c.Preference.decrementByIntegerIfExists({key:"cardsEarned",value:1,options:{nonNegative:!0}},function(){}),i.guid=t.card_id,i.number=t.card.card_number,i.expiry_year=t.card.expiry_year,i.expiry_month=t.card.expiry_month,i.cvc=t.card.cvc,i.original_amount=t.card.original_amount,i.active=1,i.type=t.card.type,i.serverCreatedAt=t.card.created_at,i.activeToDate=t.card.active_to_date,i.total_fee=t.total_fee,i.payment_source=t.card.payment_source,i.source=n.payload.source,o.flush(null,function(){a?a.call(this,i):n.returnEntities&&n.returnEntities(i)}))})}}),c.DisposableCard=l}),ABINE_DNTME.define("abine/storage/disposableEmail",["documentcloud/underscore","persistence","abine/storageMixins","abine/emailServer","storage","abine/config"],function(s,o,e,t,c,i){var l=o.define("DisposableEmails",{accountId:"TEXT",guid:"TEXT",targetId:"INT",targetGuid:"TEXT",user:"TEXT",domain:"TEXT",active:"INTEGER",createdAt:"DATE",mails:"INTEGER",label:"TEXT",modifiedAt:"DATE",pushVersion:"INTEGER"});return l.enableCaching("user"),l.enableIndexing("label"),s.extend(l.prototype,{getAddress:function(){return this.user+"@"+this.domain}}),s.extend(l,e.DefaultActions,{routes:{"read/disposableEmail/all":"indexFromServer","search/disposableEmail/:q":"search","read/disposableEmail/allLocal":"indexLocal","read/disposableEmail/domain/:id":"getEmailsForDomain","create/disposableEmail":"createOnServer"},getEmailsForDomain:function(t,n){var e=t.params[0];c.DisposableEmail.listByIndex(e,function(e){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})},search:function(t,n){var a=new RegExp(atob(t.params[0]),"i");c.DisposableEmail.listCached(function(e){return e.user&&e.user.match(a)||e.domain&&e.domain.match(a)},function(e){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})},indexLocal:function(n,a){c.ShieldedEmail.index(null,s.bind(function(e){if(0<e.length){e[0];c.DisposableEmail.index(null,function(e){var t=s.map(e,function(e){return e.toJSON()});l.respondWithJSON(t,n,a)})}else l.respondWithJSON([],n,a)},this))},indexFromServer:function(i,r){this.emailServer=this.emailServer||new t,c.ShieldedEmail.index(null,s.bind(function(e){if(0<e.length){var t=e[0];this.emailServer.readDisposables({guid:t.guid},function(e,a){e?(ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/storage/disposableEmail]#[indexFromServer]# error event in server.makeRequest"),l.respondWithJSON([],i,r)):c.DisposableEmail.index(null,function(t){var n={};s.each(t,function(e){n[e.guid]=e}),s.each(a.disposables,function(e){n[e.guid]||(n[e.guid]=new c.DisposableEmail(e),o.add(n[e.guid])),n[e.guid].createdAt=e.created_at||e.created,n[e.guid].mails=e.num_mails,n[e.guid].active=e.active}),o.flush(function(){var e=s.map(t,function(e){return e.toJSON()});l.respondWithJSON(e,i,r)})})})}else l.respondWithJSON([],i,r)},this))},createOnServer:function(n,a){this.emailServer=this.emailServer||new t;var e=null;c.DisposableEmail.findBy("accountId",e,s.bind(function(e){if(e)a?a(e):n.returnEntities(e);else{var t=s.bind(function(){var e=i.disposableDomain,t={label:n.payload.label,domain:e,source:n.payload.source};n.payload.customName&&(t.custom=n.payload.customName,t.domain=n.payload.customDomain),this.emailServer.generateDisposable(t,function(e,t){e?(ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/storage/disposableEmail]#[createOnServer]# error event in server.generateDisposable"),n.returnError(e)):(n.payload.guid=t.guid,n.payload.domain=t.domain,n.payload.user=t.user,n.payload.active=1,n.payload.createdAt=t.created,l.create(n,a))})},this);n.payload.label&&"MaskMe Feedback"==n.payload.label?c.DisposableEmail.findBy("label","MaskMe Feedback",function(e){e?a?a(e):n.returnEntities(e):t()}):t()}},this))}}),c.DisposableEmail=l}),ABINE_DNTME.define("abine/storage/disposablePhone",["documentcloud/underscore","persistence","abine/storageMixins","storage","modules","persistence/caching"],function(e,r,t,s,o){var n=r.define("DisposablePhones",{accountId:"TEXT",shielded_phone_id:"INTEGER",rails_id:"INTEGER",country_code:"TEXT",number:"TEXT",createdAt:"DATE",modifiedAt:"DATE",pushVersion:"INTEGER",isSuspended:"TEXT",released:"TEXT",nextBillingDate:"DATE"});return n.enableCaching(),e.extend(n.prototype,{getPrettyNumber:function(){return"("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal()},getAreaCode:function(){return this.number.substr(0,3)},getExchange:function(){return this.number.substr(3,3)},getLocal:function(){return this.number.substr(6,4)}}),e.extend(n,t.DefaultActions,{routes:{"read/disposablePhone/all":"index","read/disposablePhone/:id":"show","delete/disposablePhone/:id":"destroy","create/disposablePhone":"createFromDatabase"},createFromDatabase:function(a,i){s.DisposablePhone.all().one(function(n){n&&(a.payload.filling&&n.released?s.ShieldedPhone.index(null,function(e){o.phoneModule.restorePhone({restore:!0,id:e[0].rails_id},function(e,t){e||!t.shielded_phone||0==t.shielded_phone.disposable_phones.length?a.returnError(e):(n.number=t.shielded_phone.disposable_phones[0].number,n.released=!1,a.payload.released=n.released,a.payload.number=n.number,a.payload.country_code=n.country_code,r.flush(),i?i.call(this,n):a.returnEntities&&a.returnEntities(n))})}):(i?i.call(this,n):a.returnEntities&&a.returnEntities(n),a.payload.filling&&s.ShieldedPhone.index(null,function(e){o.phoneModule.logDisposableFilled(e[0].rails_id)})))})}}),s.DisposablePhone=n}),ABINE_DNTME.define("abine/storage/dntStats",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/localStorage","abine/securityManager","abine/badgeManager"],function(e,t,n,a,i,r,s){var o=t.define("DntStats",{totalAllTimeTrackers:"INTEGER",dailyTrackerCounts:"TEXT",badTrackers:"TEXT",viewedBadge:"BOOL",earnedOn:"INTEGER",currentBadge:"TEXT",currentBadgeIndex:"INTEGER"});return o.enableCaching(),e.extend(o,n.DefaultActions,{routes:{"create/dntStats":"create","read/dntStats/all":"index","read/dntStats/getBadgeData":"getBadgeData","update/dntStats/:id":"update"},getBadgeData:function(e){e.returnJSON(s.badges)}}),o.useLocalStorage(),a.DntStats=o}),ABINE_DNTME.define("abine/storage/emailDomain",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/config","abine/crypto","abine/securityManager","abine/emailServer"],function(r,s,e,t,n,a,i,o){var c=s.define("EmailDomain",{domain:"TEXT"});return c.enableCaching(),r.extend(c,e.DefaultActions,{routes:{"read/emailDomain/all":"index"},fetchFromServer:function(e){if(this._waitCallbacks)this._waitCallbacks.push(e);else{this._waitCallbacks=[e];var i=this;this.clearCache(),(new o).getDomains(function(e,t){if(!e){var n=t.data;r.each(n,function(t){c.findBy("domain",t,function(e){e||s.add(new c({domain:t}))})})}var a=i._waitCallbacks;i._waitCallbacks=null,a.forEach(function(e){e&&e()})})}}}),t.EmailDomain=c}),ABINE_DNTME.define("abine/storage/extensionVersion",["documentcloud/underscore","persistence","abine/storageMixins","storage"],function(e,t,n,i){var r=t.define("ExtensionVersion",{newVersionAvailable:"BOOL",version:"TEXT",error:"BOOL"});return e.extend(r,n.DefaultActions,{routes:{"read/extensionVersion/:id":"getNewVersion"},getNewVersion:function(e,t){function n(){r.respondWithJSON(a,e,t)}var a={error:!0};ABINE_DNTME.require(["modules"],function(e){e.mappingsModule.forceMappingUpdate(!0,function(){a.error=!1,i.Preference.findBy("key","new_version",function(e){e&&(a.newVersionAvailable=!0,a.version=e.value),n()})})})}}),i.ExtensionVersion=r}),ABINE_DNTME.define("abine/storage/fieldData",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/localStorage","abine/crypto"],function(c,e,t,n,l,u){var a=e.define("FieldData",{className:"TEXT",dataType:"TEXT",detectedType:"TEXT",mappedType:"TEXT",fieldType:"TEXT",fieldId:"TEXT",label:"TEXT",maxlength:"INTEGER",name:"TEXT",position:"INTEGER",signature:"TEXT",size:"INTEGER",maskedValue:"TEXT",matchedDataType:"TEXT",domain:"TEXT",formSignature:"TEXT",formHost:"TEXT",formId:"TEXT",fieldCount:"INTEGER",pageUrl:"TEXT",pageHost:"TEXT",formType:"TEXT",mappedFormType:"TEXT"});return c.extend(a,t.DefaultActions,{routes:{},createLocal:function(o,e){n.Preference.findBy("key","shouldSendErrorReports",c.bind(function(e){if(!e||e.isTrue()){var n=l.getItem("fieldData-to-push");if(n)try{n=JSON.parse(n)}catch(s){n={}}else n={};var t=c.size(n),a=n[o.payload.formId];a&&"sequenceId"in a&&(t=a.sequenceId),o.form.sequenceId=t,n[o.payload.formId]=o.form;var i=u.sha1(o.payload.formId+o.payload.signature).toString(),r=n[i];if(n[i]=o.payload,r&&r.fillType)try{n[i].fillType=(10*parseInt(r.fillType)+o.payload.fillType)%100}catch(s){n[i].fillType=o.payload.fillType}c.each(o.allFields,function(e){var t=u.sha1(e.formId+e.signature).toString();t in n?(n[t].maskedValue=e.maskedValue,n[t].hidden=e.hidden):n[t]=e}),l.setItem("fieldData-to-push",JSON.stringify(n))}else l.removeItem("fieldData-to-push")},this)),e?e(o.payload):o.returnEntities(o.payload)}}),n.FieldData=a}),ABINE_DNTME.define("abine/fixtures",["documentcloud/underscore","persistence","storage"],function(){return{createFixtures:function(e){this.createRidiculousDatabase(100,3),e()},getRandomInteger:function(e){return Math.floor(Math.random()*e)},getRandomString:function(e,t){t=t||"abcdefghijklmnopqrstuvwxyz1234567890";for(var n="",a=0;a<12;a++)n+=t.charAt(Math.floor(Math.random()*t.length));return n},generateFieldsForAccount:function(e,t,n){var a={value:this.getRandomString(10)+"@"+(t?"opayq.com":"gmail.com"),dataType:"/contact/email",origin:t?"disposable":"",name:"email"},i={value:a.value,dataType:"/contact/email",origin:t?"disposable":"",name:"confirm_email"},r={value:this.getRandomString(10,"0123456789"),dataType:"/contact/phone",origin:e?"disposable":"",name:"phone"},s={value:n?this.getRandomString(12):["password","tedted","iloveabine","maskme","a"][this.getRandomInteger(5)],dataType:"/password",origin:n?"strong":"",name:"password"};return[a,i,r,s,{value:s.value,dataType:"/password",origin:n?"strong":"",name:"confirm_password"}]},asyncCreateAccounts:function(e){if(0<e.length)e.shift()},createRidiculousDatabase:function(e,t){for(var n=[],a=0;a<e;a++)for(var i="http://"+this.getRandomString(10)+[".com",".net",".org"][Math.floor(3*Math.random())],r=0;r<t;r++)n.push({data:{data:this.generateFieldsForAccount(0==this.getRandomInteger(3),0==this.getRandomInteger(3),0==this.getRandomInteger(3)),pageUrl:i,type:"registrationForm",url:i},fixture:!0,tabId:null});this.asyncCreateAccounts(n)}}}),ABINE_DNTME.define("abine/storage/globalData",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/webapp"],function(h,e,t,p,r){var n=function(){};h.extend(n,t.DefaultActions,{routes:{"create/globalTracker":"toggleTracker"},toggleTracker:function(e){e.payload.blocked?ABINE_DNTME.dnt_api.block(e.payload.name,"*"):ABINE_DNTME.dnt_api.allow(e.payload.name,"*")}});var a=function(){};h.extend(a,t.DefaultActions,{routes:{"create/globalPreference":"togglePreference"},togglePreference:function(t){"gpc"==t.payload.name?chrome.permissions.request({permissions:["webNavigation"]},function(e){e?ABINE_DNTME.dnt_api.setGPC("*",t.payload.value):console.log("permission denied")}):"suggestions"==t.payload.name?ABINE_DNTME.dnt_api.setSuggestionsEnabled(t.payload.value):p.Preference.createOrModify({key:t.payload.name,value:t.payload.value?"true":"false"})}});var i=function(){};h.extend(i,t.DefaultActions,{routes:{"create/globalFeature":"toggleFeature"},toggleFeature:function(t,n){function e(e){i.respondWithJSON({name:t.payload.name,value:e?!t.payload.value:t.payload.value},t,n)}"browsing"==t.payload.name?(ABINE_DNTME.dnt_api.setDefaultBlocking(t.payload.value),e(!1)):this.setFeatureState(t.payload.name,t.payload.value,e)},setFeatureState:function(n,t,a){function i(){var e=n;e.match(/helpMeLogin|rememberAccounts|suggest|CheckoutPanelGrowl|rememberCards|submitAccount/)||(e="suggestProtected"+n.charAt(0).toUpperCase()+n.slice(1)),p.Preference.createOrModify({key:e,value:t?"true":"false"},function(){a(!1)})}a=a||function(){},t&&n in{phone:1,card:1}?p.Preference.batchFindBy([{by:"key",value:"entitledToPayments"},{by:"key",value:"entitledToPhone"},{by:"key",value:"authToken"},{by:"key",value:"hasEnabledPayments"},{by:"key",value:"suggestProtectedCard"},{by:"key",value:"regPassword"}],function(e){if("phone"==n&&e.entitledToPhone&&e.entitledToPhone.isTrue())p.ShieldedPhone.index(null,function(e){i(),0!=e.length&&e[0].isValidated()||(r.openPhones(),a(!0))});else if("card"==n&&e.entitledToPayments&&e.entitledToPayments.isTrue())if(e.hasEnabledPayments&&e.hasEnabledPayments.isTrue())i();else{var t=!0;e.suggestProtectedCard&&e.suggestProtectedCard.isFalse()&&(e.suggestProtectedCard.setTrue(),t=!1),r.openCards(),a(t)}else if("card"!=n||e.entitledToPayments&&e.entitledToPayments.isTrue())r.openPremium(n+"ToggleGlobal",n),a(!0);else if(!e.hasEnabledPayments||!e.hasEnabledPayments.isTrue()){t=!0;e.suggestProtectedCard&&e.suggestProtectedCard.isFalse()&&(e.suggestProtectedCard.setTrue(),t=!1),r.openPremium(n+"ToggleGlobal",n),a(t)}}):i()}});var m=function(){};return h.extend(m,t.DefaultActions,{routes:{"read/globalData/:id":"getGlobalData"},getSettings:function(n){p.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"suggestProtectedEmail"},{by:"key",value:"suggestProtectedPhone"},{by:"key",value:"suggestProtectedCard"},{by:"key",value:"suggestRealCard"},{by:"key",value:"suggestIdentities"},{by:"key",value:"promptWhenSavingAccounts"},{by:"key",value:"promptWhenSavingCards"},{by:"key",value:"hasEnabledPayments"},{by:"key",value:"entitledToPhone"},{by:"key",value:"entitledToAccounts"},{by:"key",value:"suggestStrongPassword"},{by:"key",value:"suggestAddresses"},{by:"key",value:"rememberAccounts"},{by:"key",value:"rememberCards"},{by:"key",value:"helpMeLogin"},{by:"key",value:"submitAccount"},{by:"key",value:"showMedals"},{by:"key",value:"showNotifications"},{by:"key",value:"showTrackersOnload"},{by:"key",value:"showInTheKnowGrowls"},{by:"key",value:"showWeeklyReports"},{by:"key",value:"showCheckoutPanelGrowl"},{by:"key",value:"autoPremiumRegisterShown"},{by:"key",value:"shouldSendErrorReports"},{by:"key",value:"shouldSendShoppingFeedback"}],function(e){var t={};t.loggedIn=e.authToken&&""!=e.authToken.value,t.browsing=ABINE_DNTME.dnt_api.getDefaultBlocking(),t.email=e.suggestProtectedEmail&&e.suggestProtectedEmail.isTrue(),t.phone=e.suggestProtectedPhone&&e.suggestProtectedPhone.isTrue(),t.card=e.suggestProtectedCard&&e.suggestProtectedCard.isTrue(),t.suggestions=ABINE_DNTME.dnt_api.getSuggestionsEnabled(),t.showMedals=e.showMedals&&e.showMedals.isTrue(),t.showCheckoutPanelGrowl=e.showCheckoutPanelGrowl&&e.showCheckoutPanelGrowl.isTrue(),t.helpMeLogin=e.helpMeLogin&&e.helpMeLogin.isTrue(),t.submitAccount=e.submitAccount&&e.submitAccount.isTrue(),t.showNotifications=e.showNotifications&&e.showNotifications.isTrue(),t.shouldSendErrorReports=e.shouldSendErrorReports&&e.shouldSendErrorReports.isTrue(),t.shouldSendShoppingFeedback=e.shouldSendShoppingFeedback&&e.shouldSendShoppingFeedback.isTrue(),t.showTrackersOnload=e.showTrackersOnload&&e.showTrackersOnload.isTrue(),t.showInTheKnowGrowls=e.showInTheKnowGrowls&&e.showInTheKnowGrowls.isTrue(),t.showWeeklyReports=!e.showWeeklyReports||e.showWeeklyReports.isTrue(),t.premium=t.loggedIn&&e.entitledToPhone&&e.entitledToPhone.isTrue(),t.accounts=t.loggedIn&&e.entitledToAccounts&&e.entitledToAccounts.isTrue(),t.suggestStrongPassword=e.suggestStrongPassword&&e.suggestStrongPassword.isTrue(),t.rememberAccounts=e.rememberAccounts&&e.rememberAccounts.isTrue(),t.rememberCards=e.rememberCards&&e.rememberCards.isTrue(),t.suggestAddresses=e.suggestAddresses&&e.suggestAddresses.isTrue(),t.suggestRealCard=e.suggestRealCard&&e.suggestRealCard.isTrue(),t.suggestIdentities=e.suggestIdentities&&e.suggestIdentities.isTrue(),t.promptWhenSavingAccounts=e.promptWhenSavingAccounts&&e.promptWhenSavingAccounts.isTrue(),t.promptWhenSavingCards=e.promptWhenSavingCards&&e.promptWhenSavingCards.isTrue(),t.gpc=ABINE_DNTME.dnt_api.getGPC("*"),n(t)})},getGlobalData:function(l,u){var d=ABINE_DNTME.dnt_api.getTabData(l.sender),e=ABINE_DNTME.dnt_api.getTrackerDefaults(),f=[];for(var t in e)f.push({name:t,blocked:e[t]});f.sort(function(e,t){return(e=e.name.toLowerCase())<(t=t.name.toLowerCase())?-1:t<e?1:0}),this.getSettings(h.bind(function(c){p.Blacklist.index(null,h.bind(function(e){var t=[];h.each(e,function(e){e=e.toJSON();c.accounts&&(e.globalAccounts=!0),t.push(e)});var n=[],a=[],i={gpc:1,suggestions:1,showMedals:1,shouldSendErrorReports:1,showInTheKnowGrowls:1,showWeeklyReports:1,promptWhenSavingCards:1,promptWhenSavingAccounts:1,shouldSendShoppingFeedback:1};"Chrome"!=ABINE_DNTME.config.browser&&delete i.gpc;var r={browsing:1,rememberAccounts:1,rememberCards:1,helpMeLogin:1,submitAccount:1,suggestStrongPassword:1,showCheckoutPanelGrowl:1,suggestRealCard:1,suggestIdentities:1,suggestAddresses:1,card:1,email:1,phone:1};for(var s in ABINE_DNTME.maskme_installed&&(i={suggestions:1,showMedals:1},r={browsing:1}),i)s in c&&(n.push({name:s,value:c[s]}),delete c[s]);for(var o in r)a.push({name:o,value:c[o]}),delete c[o];c.tabId=d.tabId,c.host=d.host,c.trackers=f,c.preferences=n,c.globalFeatures=a,c.blacklist=t.sort(function(e,t){return(e.domain||"").localeCompare(t.domain)}),c.maskmeInstalled=!!ABINE_DNTME.maskme_installed,p.Preference.findBy("key","new_version",function(e){e&&(c.new_version=e.value),m.respondWithJSON(c,l,u)})},this))},this))}}),p.GlobalData=m,p.GlobalTracker=n,p.GlobalPreference=a,p.GlobalFeature=i,m}),ABINE_DNTME.define("abine/storage/identity",["documentcloud/underscore","persistence","abine/storageMixins","storage"],function(o,e,t,c){var n=e.define("Identity",{label:"TEXT",first_name:"TEXT",middle_name:"TEXT",last_name:"TEXT",email:"TEXT",phone:"TEXT",card:"TEXT",address_id:"TEXT",password:"TEXT",dob_year:"TEXT",dob_month:"TEXT",dob_day:"TEXT",gender:"TEXT",username:"TEXT",url:"TEXT",company:"TEXT",designation:"TEXT",ssn:"TEXT",driver_license:"TEXT",pushed:"INTEGER",createdAt:"DATE",modifiedAt:"DATE"});return n.enableCaching(),o.extend(n,t.DefaultActions,{routes:{"read/identity/all":"indexWithAddress","create/identity":"create"},indexWithAddress:function(r,s){c.Address.index(null,function(e){var t={};o.each(e,function(e){t[e.id]=e.toJSON()});var a={},i={};c.Identity.index(null,function(e){var n=[];o.each(e,function(e){(e=e.toJSON()).type="identity",e.address_id&&e.address_id in t?(e.address=t[e.address_id],a[e.address_id]=!0):e.address=e.address_id=null,i[(e.first_name+e.last_name).toLowerCase().replace(/\s+/g,"")]=!0,n.push(e)}),o.each(t,function(e,t){if(!(t in a)&&e.first_name&&e.last_name){if((e.first_name+e.last_name).toLowerCase().replace(/\s+/g,"")in i)return;n.push({id:t,type:"address",address:e,address_id:t,first_name:e.first_name,last_name:e.last_name,label:e.first_name+" "+e.last_name+" - "+e.label})}}),c.RealCard.index(null,function(){s?s.call(this,n):r.returnJSON(n)})})})}}),n.useEncryption(["email","dob_year","dob_month","dob_day","gender","label","first_name","middle_name","last_name","username","url","company","designation","ssn","driver_license","phone"]),n.useSyncStorage(),c.Identity=n}),ABINE_DNTME.define("abine/storage/loginUrl",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/lruCache","abine/crypto","abine/localStorage"],function(e,t,n,r,a,i,c){function s(e){return i.md5(e).substr(0,2)}var o=t.define("LoginUrl",{domain:"TEXT",href:"TEXT",events:"TEXT"}),l=50,u=new a(l);return e.extend(o,n.DefaultActions,{routes:{"read/loginUrl/site/:id":"loginUrlForSite"},loginUrlForSite:function(e,t){function n(){t?t(i):e.returnJSON(i)}var a=e.params[0],i=null;!a||"null"==a||(i=u.fetch(a))?n():r.LoginUrl.getByDomain(a,function(e){i=e,u.add(a,i),n()})},getByDomain:function(e,t){var n=s(e),a=c.getItem("loginurl-"+n,null);t(a?(a=JSON.parse(a))[e]:null)},getAllLoginUrls:function(e){var t=c.getItem("loginurl-buckets",null),n=[];if(t){t=JSON.parse(t);for(var a=0;a<t.length;a++){var i=c.getItem("loginurl-"+t[a],null);if(i)for(var r in i=JSON.parse(i))for(var s=i[r],o=0;o<s.length;o++)n.push(s[o])}}e(n)},saveAll:function(e){var t={},n=[];for(var a in e){(i=s(a))in t||(t[i]={},n.push(i)),t[i][a]=e[a]}for(var i in c.setItem("loginurl-buckets",JSON.stringify(n)),t)c.setItem("loginurl-"+i,JSON.stringify(t[i]));this.clearCache()},clearCache:function(){delete u,u=new a(l)}}),r.LoginUrl=o}),ABINE_DNTME.define("abine/storage/mappedField",["documentcloud/underscore","persistence","abine/storageMixins","storage"],function(e,t,n,a){var i=t.define("MappedField",{formId:"TEXT",signature:"TEXT",dataType:"TEXT"});return e.extend(i,n.DefaultActions,{routes:{"read/mappedField/all":"index","read/mappedField/:id":"show","create/mappedField":"create","update/mappedField/:id":"update","delete/mappedField/:id":"destroy"}}),a.MappedField=i}),ABINE_DNTME.define("abine/storage/mappedForm",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/lruCache","abine/crypto","abine/localStorage","abine/ajax","abine/storage/preference","abine/timer"],function(d,e,t,f,n,a,h,i,r,o){function p(e){return a.md5(e).substr(0,2)}function s(e,t){var i=[];return e&&(i=e),t&&(d.each(t,function(e){e.local=!0}),0<i.length?d.each(t,function(n){var a=d.find(i,function(e){return e.signature==n.signature});a?(a.local=!0,a.formType=n.formType,d.each(n.fields,function(t){var e=d.find(a.fields,function(e){return e.signature==t.signature});e?e.dataType=t.dataType:n.fields.push(t)})):i.push(n)}):i=t),i}!function(){if("Firefox"!=ABINE_DNTME.config.browser){var t=h.getItem("embedded-rules-version"),n=!0;t&&i.ajax({url:"/mappings-version.txt",success:function(e){parseInt(e)<=parseInt(t)&&(n=!1)},async:!1}),n&&i.ajax({url:"/mappings.json",success:function(e){try{e=JSON.parse(e);h.setItem("embedded-rules-version",e.version);var n=[];d.each(e.mappings,function(e){var t={domain:e.domain,signature:e.signature,mapping_signature:e.mapping_signature,formType:e.formType,fields:e.fields};n.push(t)}),c.saveAllForms(n),f.Preference.createOrModify({key:"mapping-version",value:e.version})}catch(t){}}})}}();var c=e.define("MappedForm",{domain:"TEXT",signature:"TEXT",mapping_signature:"TEXT",formType:"TEXT",strData:"TEXT"}),l=50,u=new n(l);return d.extend(c,t.DefaultActions,{routes:{"read/mappedForm/all":"index","read/mappedForm/:id":"show","read/mappedForm/site/:id":"mappingsForSite","read/mappedForm/local/:id":"localMappingForSite","create/mappedForm":"createLocal","update/mappedForm/:id":"update","delete/mappedForm/:id":"destroy"},createLocal:function(a,e){function i(){a.returnJSON?a.returnJSON([]):e&&e()}var r=JSON.parse(a.payload.strData),t=r.domain,n=p(t),s=h.getItem("lMapping-"+n,null),o=null;if(s)o=(s=JSON.parse(s))[t];else{var c=h.getItem("lMapping-buckets",null);-1==(c=c?JSON.parse(c):[]).indexOf(n)&&(c.push(n),h.setItem("lMapping-buckets",JSON.stringify(c))),s={}}var l=null;if(o?(l=d.find(o,function(e){return e.signature==r.signature}))&&(o=d.filter(o,function(e){return e.signature!=r.signature}),d.each(l.fields,function(t){if(t.right_click){var e=d.find(r.fields,function(e){return e.signature==t.signature});e&&(e.right_click=!0)}})):o=[],a.payload.changed){var u={domain:t,signature:r.signature,formType:r.formType,fields:[]};d.each(r.fields,function(e){u.fields.push({signature:e.signature,dataType:e.dataType,right_click:!!e.right_click})}),o.push(u)}s[t]=o,h.setItem("lMapping-"+n,JSON.stringify(s)),f.Preference.findBy("key","shouldSendErrorReports",d.bind(function(e){if(!e||e.isTrue()){var t=h.getItem("mapping-to-push");if(t)try{t=JSON.parse(t)}catch(n){t={}}else t={};a.payload.changed?(t[r.signature]=r,d.each(r.fields,function(e){e.label&&(e.label=e.label.replace(/(^\s+)|(\s+$)/g,"").replace(/\s+/g," "))})):delete t[r.signature],h.setItem("mapping-to-push",JSON.stringify(t))}else h.removeItem("mapping-to-push")},this)),this.clearCache(),f.Preference.findBy("key","mapping:mapper",function(t){f.Preference.findBy("key","mapping:reviewer",function(e){t||e?(console.log("**** pushing mapping"),ABINE_DNTME.require(["modules"],function(n){n.mappingsModule.forceMappingUpdate(function(){if(i(),a.payload.formHtml){var e={id:a.payload.formSignature,my_mapping:!0,mapper:t?t.value:null};n.mappingsModule.getOneFormMappings(e,d.bind(function(e){var t=d.find(e,function(e){return e.self});t&&t.id&&n.mappingsModule.sendFormBlob({form_id:t.id,html:a.payload.formHtml},function(){})},this))}})})):(console.log("**** not pushing mapping"),i())})})},mappingsForSite:function(t,e){var n=t.params[0];if("null"!=n){var a=u.fetch(n);a?t.returnJSON(a):f.MappedForm.getByDomain(n,function(e){u.add(n,e),t.returnJSON(e)})}else t.returnJSON?t.returnJSON([]):e&&e()},localMappingForSite:function(t){var e=t.params[0];f.MappedForm.getByDomain(e,function(e){t.returnJSON(e)},!0)},getByDomain:function(e,t,n){var a=p(e);if(!n){var i=h.getItem("mapping-"+a,null);i&&(i=(i=JSON.parse(i))[e])}var r=h.getItem("lMapping-"+a,null);r&&(r=(r=JSON.parse(r))[e]),t(s(i,r))},getAllForms:function(e){var t=h.getItem("mapping-buckets",null),n=[];if(t){t=JSON.parse(t);for(var a=0;a<t.length;a++){var i=h.getItem("mapping-"+t[a],null);if(i)for(var r in i=JSON.parse(i))for(var s=i[r],o=0;o<s.length;o++)n.push(s[o])}}e(n)},saveAllForms:function(e){for(var t={},n=[],a=0;a<e.length;a++){var i=e[a];(s=p(i.domain))in t||(t[s]={},n.push(s)),i.domain in t[s]||(t[s][i.domain]=[]),t[s][i.domain].push(i)}for(a=0;a<256;a++)h.removeItem("mapping-"+(a<16?"0"+a.toString(16):a.toString(16)));h.setItem("mapping-buckets",JSON.stringify(n));var r=0;for(var s in t)o.setTimeout(function(e){return function(){h.setItem("mapping-"+e,JSON.stringify(t[e]))}}(s),r),r+=20;this.clearCache()},clearForms:function(){var e=h.getItem("mapping-buckets",null);if(e){h.removeItem("mapping-buckets"),e=JSON.parse(e);for(var t=0;t<e.length;t++)h.removeItem("mapping-"+e[t])}},clearCache:function(){delete u,u=new n(l)}}),f.MappedForm=c}),ABINE_DNTME.define("abine/storage/note",["documentcloud/underscore","persistence","abine/storageMixins","abine/emailServer","storage","abine/config"],function(e,t,n,a,i){var r=t.define("Note",{label:"TEXT",domain:"TEXT",description:"TEXT",pushed:"INTEGER",createdAt:"DATE",modifiedAt:"DATE"});return r.enableCaching(),e.extend(r,n.DefaultActions,{routes:{"read/note/all":"index"}}),r.useEncryption(["label","description","domain"]),
r.useSyncStorage(),i.Note=r}),ABINE_DNTME.define("abine/storage/pageData",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/localStorage"],function(t,e,n,a,m){var i=e.define("PageData",{domain:"TEXT"});return t.extend(i,n.DefaultActions,{routes:{"create/pageData":"createLocal"},createLocal:function(p,e){a.Preference.findBy("key","shouldSendErrorReports",t.bind(function(e){if(!e||e.isTrue()){var t=m.getItem("pageData-to-push");if(t)try{t=JSON.parse(t)}catch(h){t={}}else t={};var n=p.payload,a=n.domain,i=(t[a]||"0:0:0:0:0:0:0:0").split(":"),r="0",s=parseInt(i[1]),o=parseInt(i[2]),c=parseInt(i[3]),l=parseInt(i[4]),u=parseInt(i[5]),d=parseInt(i[6]),f=parseInt(i[7]);n.page_view&&s++,n.login&&o++,n.register&&c++,n.checkout&&l++,n.login_fill&&u++,n.register_fill&&d++,n.checkout_fill&&f++,t[a]=r+":"+s+":"+o+":"+c+":"+l+":"+u+":"+d+":"+f,m.setItem("pageData-to-push",JSON.stringify(t))}else m.removeItem("pageData-to-push")},this)),e&&e({})}}),a.PageData=i}),ABINE_DNTME.define("abine/storage/panelActivity",["documentcloud/underscore","persistence","abine/storageMixins","storage"],function(e,i,t,r){var n=i.define("PanelActivity",{panelId:"INTEGER",impressions:"INTEGER",clicks:"INTEGER",users:"INTEGER",completions:"INTEGER",masks:"INTEGER",discloses:"INTEGER",closes:"INTEGER"});return n.enableCaching("panelId"),e.extend(n.prototype,{reset:function(e){e?(this.impressions-=e.impressions,this.clicks-=e.clicks,this.completions-=e.completions,this.users-=e.users,this.masks-=e.masks,this.discloses-=e.discloses,this.closes-=e.closes):(this.impressions=0,this.clicks=0,this.completions=0,this.users=0,this.masks=0,this.discloses=0,this.closes=0),i.flush()},hasData:function(){return 0<this.impressions+this.clicks+this.completions+this.masks+this.discloses+this.closes},isMarketingPanel:function(){return this.panelId<1e6}}),e.extend(n,t.DefaultActions,{routes:{"read/panelActivity/all":"index","read/panelActivity/:id":"showByPanelId","create/panelActivity":"create","update/panelActivity/click":"addClick","update/panelActivity/conversion":"addConversion","update/panelActivity/impression":"addImpression","update/panelActivity/masked":"addMasked","update/panelActivity/disclosed":"addDisclosed","update/panelActivity/closed":"addClosed","update/panelActivity/:id":"update","delete/panelActivity/:id":"destroy"},createPanelActivity:function(e){var t=new r.PanelActivity({panelId:e,impressions:0,users:0,clicks:0,masks:0,discloses:0,closes:0,completions:0});return i.add(t),t},updateMetric:function(t,n,a){r.PanelActivity.findBy("panelId",t.payload.panelId,e.bind(function(e){e=e||this.createPanelActivity(t.payload.panelId),t.payload.revert?e[n]--:e[n]++,i.flush(),a?a.call(this,e):t.returnEntities&&t.returnEntities(e)},this))},addImpression:function(e,t){this.updateMetric(e,"impressions",t)},addClick:function(e,t){this.updateMetric(e,"clicks",t)},addMasked:function(e,t){this.updateMetric(e,"masks",t)},addDisclosed:function(e,t){this.updateMetric(e,"discloses",t)},addClosed:function(e,t){this.updateMetric(e,"closes",t)},addConversion:function(e,t){this.updateMetric(e,"completions",t)},showByPanelId:function(t,n){r.PanelActivity.findBy("panelId",t.params[0],function(e){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})}}),n.useLocalStorage(),r.PanelActivity=n}),ABINE_DNTME.define("abine/storage/preference",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/config","persistence/caching"],function(n,i,e,r,t){var s=function(){},o=i.define("Preferences",{key:"TEXT",value:"TEXT"});return o.enableCaching("key"),n.extend(o.prototype,{setTrue:function(){this.value="true"},setFalse:function(){this.value="false"},isTrue:function(){return 1==this.value||"true"===this.value},isFalse:function(){return!this.isTrue()},isEmpty:function(){return!this.value||""==this.value||"null"==(this.value+"").toLowerCase()}}),n.extend(o,e.DefaultActions,{routes:{"read/preference/all":"index","read/preference/name/:key":"showOneByKey","read/preference/prefspage":"showForPrefsPage","read/preference/:id":"show","create/preference":"create","update/preference/restore":"restore","update/preference/:id":"update","delete/preference/:id":"destroy"},showOneByKey:function(t,n){o.findBy("key",t.params[0],function(e){n?n.call(this,e):t&&t.returnEntities&&t.returnEntities(e)})},getSync:function(e){var t=null;return r.Preference.isCached()&&r.Preference.findBy("key",e,function(e){t=e}),t},findOrCreate:function(n,a){a=a||s,r.Preference.findBy("key",n.key,function(e){if(e)a(e);else{var t=new r.Preference(n);i.add(t),i.flush(function(){a(t)})}})},removeByKey:function(e,t){t=t||s,r.Preference.findBy("key",e,function(e){e?(i.remove(e),i.flush(function(){t(e)})):t(e)})},createOrModify:function(t,n){n=n||s,r.Preference.findBy("key",t.key,function(e){e?e.value=t.value:(e=new r.Preference(t),i.add(e)),i.flush(function(){n(e)})})},createOrIncrementByInteger:function(t,n){n=n||s,r.Preference.findBy("key",t.key,function(e){e?e.value===parseInt(e.value)&&(e.value=e.value+t.value):(e=new r.Preference(t),i.add(e)),i.flush(function(){n(e)})})},decrementByIntegerIfExists:function(t,n){n=n||s,r.Preference.findBy("key",t.key,function(e){e&&e.value===parseInt(e.value)&&(e.value=e.value-t.value,t.options&&t.options.nonNegative&&e.value<0&&(e.value=0)),i.flush(function(){n(e)})})},batchFindBy:function(e,t){t=t||s;var a={};n.async.forEach(e,n.bind(function(t,n){this.findBy(t.by,t.value,function(e){a[t.value]=e,n()})},this),function(){t(a)})},batchRemoveBy:function(e,t){t=t||s,n.async.forEach(e,n.bind(function(e,t){this.findBy(e.by,e.value,function(e){e&&i.remove(e),t()})},this),function(){i.flush(function(){t()})})},batchCreateOrModify:function(e,t){t=t||s,n.async.forEach(e,n.bind(function(e,t){this.createOrModify(e,function(){t()})},this),function(){t()})},retainDefaults:function(t){var e=function(e){return e.key in{entitledToSync:1,entitledToPayments:1,entitledToPhone:1,hasEnabledPayments:1}};r.Preference.listCached(e,n.bind(function(e){n.each(e,function(e){i.remove(e)}),i.flush(function(){t()})},this))},setupUpgradeDefaults:function(t){t=t||s;var a={};n.async.forEach(o._upgradeDefaults,n.bind(function(t,n){this.findBy("key",t.key,function(e){a[t.key]=e,n()})},this),function(){n.each(o._upgradeDefaults,n.bind(function(e){a[e.key]||i.add(new o(e)),i.flush(function(){t()})},this))})}}),o.useLocalStorage(),o._defaults=[{key:"freshInstall",value:"true"},{key:"showNotifications",value:"true"},{key:"helpMeLogin",value:"true"},{key:"showMedals",value:t.silent?"false":"true"},{key:"suggestProtectedEmail",value:t.silent?"false":"true"},{key:"promptWhenSavingAccounts",value:t.silent?"false":"true"},{key:"promptWhenSavingCards",value:t.silent?"false":"true"},{key:"suggestStrongPassword",value:t.silent?"false":"true"},{key:"suggestProtectedPhone",value:t.silent?"false":"true"},{key:"suggestProtectedCard",value:t.silent?"false":"true"},{key:"suggestRealCard",value:t.silent?"false":"true"},{key:"suggestAddresses",value:t.silent?"false":"true"},{key:"suggestIdentities",value:t.silent?"false":"true"},{key:"confirmProtectedCard",value:"true"},{key:"shouldSendErrorReports",value:"true"},{key:"shouldSendShoppingFeedback",value:"true"},{key:"showMapper",value:"false"},{key:"showTrackersOnload",value:(t.silent,"false")},{key:"showInTheKnowGrowls",value:"true"},{key:"showPremiumSubscriptionPanel",value:"true"},{key:"rememberAccounts",value:t.silent?"false":"true"},{key:"submitAccount",value:"true"},{key:"rememberCards",value:t.silent?"false":"true"},{key:"showWeeklyReports",value:t.silent?"false":"true"},{key:"footerCampaign",value:.5<Math.random()?"A":"B"},{key:"countNotifications",value:"0"},{key:"showCheckoutPanelGrowl",value:"false"},{key:"splitTests",value:""},{key:"dnt_language",value:"en"}],o._upgradeDefaults=[{key:"showPrivateSearchState",value:"true"},{key:"suggestRealCard",value:t.silent?"false":"true"},{key:"suggestIdentities",value:t.silent?"false":"true"},{key:"submitAccount",value:"true"},{key:"promptWhenSavingAccounts",value:t.silent?"false":"true"},{key:"promptWhenSavingCards",value:t.silent?"false":"true"},{key:"shouldSendShoppingFeedback",value:"true"},{key:"dnt_language",value:"en"}],r.Preference=o}),ABINE_DNTME.define("abine/storage/realCard",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/config","abine/ajax","abine/localStorage"],function(s,e,t,r,n,a,i){function o(e){e=e.replace(/\D/g,"");var t=d.rules;for(var n in t)if(t.hasOwnProperty(n)&&"prefixes"in t[n])for(var a=t[n],i=0,r=a.prefixes.length;i<r;++i)if(a.prefixes.hasOwnProperty(i)){var s=a.prefixes[i];if(new RegExp("^"+s.toString()).test(e))return n}return!1}function c(e,r){function t(e){var t=s+"_generic";if(e&&e.bin&&s in d.rules){var n=d.rules[s];for(var a in n){var i=n[a];if(i.bank&&e.bank.match(i.bank))if(i.category){if(e.card_category&&e.card_category.match(i.category)){t=a;break}}else t=a}}r(t)}if(e){var n=(e=e.replace(/\D/g,"")).substr(0,6),s=o(e);n in f?t(f[n]):a.ajax({url:"https://www.binlist.net/json/"+n,success:function(e){t(f[n]=e)},error:function(){f[n]={},t({})}})}else r({})}function l(e,n){e||(e=""),e.match(/amex/i)&&(e="american_express");var t=[e,"all"],a=null;return s.each(t,function(e){if(!a&&e in d.rules&&n in d.rules[e]){var t=d.rules[e][n].style;t in d.styles&&(a=d.styles[t])}}),a||"generic"==n||(a=l(e,"generic")),a||{}}function u(e){var t;try{t=i.getItem("card-rules")}catch(n){return void setTimeout(function(){u(!0)},500)}t&&(t=JSON.parse(t)).version>d.version&&(d=t,e=!0),e&&(s.each(d.rules,function(e){s.each(e,function(e){e.bank&&(e.bank=new RegExp(e.bank,"i")),e.category&&(e.category=new RegExp(e.category,"i"))})}),s.each(d.offers,function(e){e.domain&&(e.domain_str=e.domain,e.domain=new RegExp(e.domain.replace(/\./g,"\\."),"i")),e.cardType="offer"}))}var d={version:5,rules:{visa:{prefixes:[4],amair:{name:"AAdvantage",bank:"no-match",style:"amair"},bofa_cash:{group:"Bank of America",name:"Cash Rewards",bank:"no-match",style:"chip_card_1"},bofa_travel:{group:"Bank of America",name:"Travel Rewards",bank:"no-match",style:"chip_card_1"},bofa_americard:{group:"Bank of America",name:"BankAmericard",bank:"no-match",style:"chip_card_1"},bofa_default:{group:"Bank of America",name:"Others",bank:"bank.*of.*america",style:"chip_card_1"},barclays_default:{name:"Barclays Bank",bank:"barclays.*bank",style:"chip_card_1"},capone_business_platinum:{group:"Capital One",name:"Business Platinum",bank:"no-match",style:"capone_business_platinum"},capone_quicksilver:{group:"Capital One",name:"Quicksilver",bank:"no-match",style:"capone_quicksilver"},capone_venture:{group:"Capital One",name:"Venture",bank:"no-match",style:"capone_venture"},capone_default:{group:"Capital One",name:"Others",bank:"capital.*one",style:"chip_card_1"},chase_freedom:{group:"Chase",name:"Freedom",bank:"no-match",style:"chase"},chase_sapphire:{group:"Chase",name:"Sapphire",bank:"no-match",style:"chase_sapphire"},chase_slate:{group:"Chase",name:"Slate",bank:"no-match",style:"chase_slate"},chase_united:{group:"Chase",name:"United",bank:"no-match",style:"chase"},chase_marriott:{group:"Chase",name:"Marriott Rewards",bank:"no-match",style:"chip_card_2"},chase_default:{group:"Chase",name:"Others",bank:"chase.*bank",style:"chase"},citi_rewards:{group:"Citi",name:"Rewards",bank:"no-match",style:"citi"},citi_ty_prem:{group:"Citi",name:"Thankyou Premiere",bank:"no-match",style:"citi"},citi_default:{group:"Citi",name:"Others",bank:"no-match",style:"citi"},first_default:{name:"First National Bank",bank:"first.*national.*bank",style:"chip_card_1"},gecap_default:{name:"GE Capital",bank:"no-match",style:"chip_card_1"},greendot_visa:{name:"Green Dot",bank:"no-match",style:"greendot"},marriott:{name:"Marriott Rewards",bank:"no-match",style:"chip_card_2"},southwest:{name:"Southwest Rewards",bank:"no-match",style:"chip_card_2"},pnc_default:{name:"PNC Bank",bank:"pnc.*bank",style:"chip_card_1"},usaa_default:{name:"USAA",bank:"usaa.*bank",style:"chip_card_1"},usbank_default:{name:"US Bank",bank:"us bank",style:"chip_card_1"},wellsfargo_default:{name:"Wells Fargo Bank",bank:"wells.*fargo",style:"chip_card_1"},visa_generic:{name:"Visa",bank:".*",style:"generic"}},mastercard:{prefixes:[51,52,53,54,55],bofa_mlb:{group:"Bank of America",name:"MLB",bank:"no-match",style:"chip_card_1"},bofa_default:{group:"Bank of America",name:"Others",bank:"bank.*of.*america",style:"chip_card_1"},barclays_default:{name:"Barclays Bank",bank:"barclays.*bank",style:"chip_card_1"},capone_default:{name:"Capital One",bank:"capital.*one",style:"chip_card_1"},chase_default:{name:"Chase",bank:"chase.*bank",style:"chase"},citi_biz:{group:"Citi",name:"Business",bank:"no-match",style:"citi"},citi_cashback:{group:"Citi",name:"Cash Back",bank:"no-match",style:"citi"},citi_doublecash:{group:"Citi",name:"Double Cash",bank:"no-match",style:"citi_doublecash"},citi_prof:{group:"Citi",name:"Professional",bank:"no-match",style:"citi"},citi_simplicity:{group:"Citi",name:"Simplicity",bank:"no-match",style:"citi"},citi_ty_pref:{group:"Citi",name:"Thankyou Preferred",bank:"no-match",style:"citi"},citi_default:{group:"Citi",name:"Others",bank:"no-match",style:"citi"},first_default:{name:"First National Bank",bank:"first.*national.*bank",style:"chip_card_1"},gecap_default:{name:"GE Capital",bank:"no-match",style:"chip_card_1"},greendot_mc:{name:"Green Dot",bank:"no-match",style:"greendot"},neteller_mc:{name:"Netellar",bank:"no-match",style:"chip_card_1"},optimal_mc:{name:"Optimal Payments",bank:"no-match",style:"chip_card_3"},pnc_default:{name:"PNC Bank",bank:"pnc.*bank",style:"chip_card_1"},skrill_mc:{name:"Skrill",bank:"no-match",style:"chip_card_3"},usaa_default:{name:"USAA",bank:"usaa.*bank",style:"chip_card_1"},usbank_default:{name:"US Bank",bank:"us bank",style:"chip_card_1"},wellsfargo_default:{name:"Wells Fargo Bank",bank:"wells.*fargo",style:"chip_card_1"},master_generic:{name:"Master Card",bank:".*",style:"generic"}},american_express:{prefixes:[34,37],amex_platinum:{name:"American Express Platinum",bank:"american.*express",category:"platinum",style:"amex_platinum"},amex_gold:{name:"American Express Gold",bank:"american.*express",category:"gold",style:"chip_card_1"},amex_cash:{name:"American Express Cash",bank:"no-match",style:"amex_cash"},britair:{name:"British Airways",bank:"british.*airways",style:"chip_card_1"},amex_delta:{name:"Delta Skymiles",bank:"delta.*sky.*miles",style:"chip_card_1"},amex_generic:{name:"American Express",bank:".*",style:"generic"}},discover:{prefixes:[6011,62,64,65],discover_it:{name:"Discover IT",bank:"no-match",style:"discover_it"},discover_generic:{name:"Discover",bank:".*",style:"generic"}},diners_club:{prefixes:[305,36,38],diners_generic:{name:"Diners Club",bank:".*",style:"generic"}},carte_blanche:{prefixes:[300,301,302,303,304,305]},jcb:{prefixes:[35]},enroute:{prefixes:[2014,2149]},maestro:{prefixes:[5018,5020,5038,6304,6759,6761]},laser:{prefixes:[6304,6706,6771,6709]},all:{homedepot:{name:"Home Depot",bank:"no-match",style:"homedepot"},kohls:{name:"Kohls",bank:"no-match",style:"kohls"},generic:{name:"Others",bank:"no-match",style:"generic"}}},styles:{generic:{base:{"font-size":15,color:"white"},number:{top:73,left:32,"font-size":28},name:{top:175,left:20},expiry:{top:125,left:200},cvc:{top:125,left:50}},amex_platinum:{base:{"font-size":15,color:"white"},number:{top:120,left:32,"font-size":28,padding:5,"background-color":"rgba(0,0,0,0.5)","border-radius":5},name:{top:180,left:40},expiry:{top:180,left:200},cvc:{top:160,left:200}},amex_cash:{base:{"font-size":15,color:"white"},number:{top:120,left:32,"font-size":28,padding:5,"background-color":"rgba(0,0,0,0.5)","border-radius":5},name:{top:180,left:40,color:"black"},expiry:{top:180,left:235,color:"black"},cvc:{top:160,left:235,color:"black"}},amair:{base:{"font-size":15,color:"white"},number:{top:110,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:150},cvc:{top:160,left:150}},chip_card_1:{base:{"font-size":15,color:"white"},number:{top:120,left:42,"font-size":28},name:{top:180,left:30},expiry:{top:180,left:156},cvc:{top:160,left:150}},chip_card_2:{base:{"font-size":15,color:"white"},number:{top:125,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:150},cvc:{top:160,left:150}},chip_card_3:{base:{"font-size":15,color:"black"},number:{top:125,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:150},cvc:{top:160,left:150}},capone_business_platinum:{base:{"font-size":15,color:"black"},number:{top:93,left:32,"font-size":28},name:{top:180,left:120},expiry:{top:135,left:200},cvc:{top:137,left:50}},capone_quicksilver:{base:{"font-size":15,color:"white"},number:{top:113,left:38,"font-size":28},name:{top:180,left:20},expiry:{top:140,left:164},cvc:{top:160,left:164}},capone_venture:{base:{"font-size":15,color:"white"},number:{top:110,left:35,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:230},cvc:{top:160,left:228}},chase_sapphire:{base:{"font-size":15,color:"white"},number:{top:130,left:35,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:230},cvc:{top:160,left:228}},chase:{base:{"font-size":15,color:"white"},number:{top:125,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:150},cvc:{top:160,left:150}},chase_slate:{base:{"font-size":15,color:"white"},number:{top:125,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:200},cvc:{top:160,left:200}},citi_doublecash:{base:{"font-size":15,color:"white"},number:{top:125,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:200},cvc:{top:160,left:200}},citi:{base:{"font-size":15,color:"white"},number:{top:120,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:150},cvc:{top:160,left:150}},discover_it:{base:{"font-size":15,color:"white"},number:{top:110,left:35,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:230},cvc:{top:160,left:228}},homedepot:{base:{"font-size":15,color:"white"},number:{top:85,left:35,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:170},cvc:{top:160,left:179}},greendot:{base:{"font-size":15,color:"white","text-shadow":"1px 1px 1px #000"},number:{top:93,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:135,left:150},cvc:{top:137,left:20}},kohls:{base:{"font-size":15,color:"white"},number:{top:90,left:60,"font-size":28},name:{top:180,left:60},expiry:{top:180,left:230},cvc:{top:160,left:228}}},offers:[{id:"homedepot",brand:"homedepot",domain:"homedepot.com",url:"https://www.citicards.com/cards/acq/Apply.do?screenID=3211&app=UNSOL&sc=30005&langId=EN&siteId=PLCN_HOMEDEPOT"},{id:"britair",brand:"britair",domain:"britishairways.com",url:"https://creditcards.chase.com/credit-cards/british-airways-credit-card.aspx"}]},f={};u(!0);var h=e.define("RealCard",{label:"TEXT",first_name:"TEXT",last_name:"TEXT",number:"TEXT",expiry_month:"TEXT",expiry_year:"TEXT",cvc:"TEXT",type:"TEXT",brand:"TEXT",address_id:"TEXT",pushed:"INTEGER",createdAt:"DATE",modifiedAt:"DATE"});return s.extend(h.prototype,{detectCardType:function(){this.type=o(this.number)},detectCardBrand:function(){c(this.number,s.bind(function(e){this.brand=e},this))},getFullName:function(){return((this.first_name||"")+" "+(this.last_name||"")).replace(/^[\s]+|[\s]+$]/g,"")},getMM:function(){var e=parseInt(this.expiry_month);return(e<10?"0":"")+e},getYY:function(){return parseInt(this.expiry_year)%100},getMMYY:function(){return this.getMM()+"/"+parseInt(this.expiry_year)%100},getMMYYYY:function(){return this.getMM()+"/"+parseInt(this.expiry_year)},jsonWithAddress:function(e){var t=this.toJSON();return e&&t.address_id&&t.address_id in e?t.address=e[t.address_id]:t.address=t.address_id=null,t.cardType="real_card",t.type||(t.type=o(t.number)||""),t.brand&&""!=t.brand||(t.type.match(/visa/)?t.brand="visa_generic":t.type.match(/master/)?t.brand="master_generic":t.type.match(/discover/)?t.brand="discover_generic":t.type.match(/diner/)?t.brand="diners_generic":t.type.match(/amex|american/)?t.brand="amex_generic":t.brand="generic"),t.styles=l(t.type,t.brand),t}}),h.enableCaching(),s.extend(h,t.DefaultActions,{routes:{"read/realCard/all":"indexWithAddress","search/realCard/:q":"search","read/realCard/site/:id":"indexWithAddressAndOffers","read/realCard/offers/:id":"indexOffers"},search:function(t,n){var a=new RegExp(atob(t.params[0]),"i");r.RealCard.listCached(function(e){return e.number&&e.number.match(a)||e.label&&e.label.match(a)||e.first_name&&e.first_name.match(a)||e.last_name&&e.last_name.match(a)||e.type&&e.type.match(a)},function(e){n?n.call(this,e):t.returnEntities&&t.returnEntities(e)})},detectCardType:function(e){return o(e)},detectCardBrand:function(e,t){c(e,t)},getCardStyles:function(e,t){return l(e,t)},indexWithAddressAndOffers:function(a,i){ABINE_DNTME.require(["modules"],function(){r.RealCard.indexWithAddress(null,function(t){var n=s.map(t,function(e){return e.brand});r.RealCard.getOfferCards(a,function(e){e.forEach(function(e){-1==n.indexOf(e.brand)&&t.unshift(e)}),i?i.call(this,t):a.returnJSON(t)})})})},indexOffers:function(a,i){ABINE_DNTME.require(["modules"],function(){r.RealCard.index(null,function(t){var n=s.map(t,function(e){return e.brand});t=[];r.RealCard.getOfferCards(a,function(e){e.forEach(function(e){-1==n.indexOf(e.brand)&&t.unshift(e)}),i?i.call(this,t):a.returnJSON(t)})})})},indexWithAddress:function(a,i){r.Address.index(null,function(e){var n={};s.each(e,function(e){n[e.id]=e.toJSON()}),r.RealCard.index(null,function(e){var t=[];s.each(e,function(e){t.push(e.jsonWithAddress(n))}),i?i.call(this,t):a.returnJSON(t)})})},updateCardRules:function(){var e="https://rules.abine.com/card-rules.json?from=extension";a.ajax({url:e,success:function(e){e&&e.version>d.version&&(i.setItem("card-rules",JSON.stringify(e)),u())}})},getOfferCards:function(e,t){var n=e.params[0],a=d.offers,i=s.filter(a,function(e){return n.match(e.domain)}),r=[];s.each(i,function(e){(e=s.extend({},e)).domain=e.domain_str,delete e.domain_str,r.push(e)}),t?t.call(this,r):e.returnJSON(r)}}),h.useEncryption(["label","first_name","last_name","number","expiry_month","expiry_year","cvc","type"]),h.useSyncStorage(),r.RealCard=h}),ABINE_DNTME.define("abine/storage/registry",["abine/timer","abine/storageRouter","storage"],function(a,t,i){return{registerStorageEntities:function(e){e.registerEntity(i.Blacklist,"blacklist"),e.registerEntity(i.DisposableCard,"disposableCard"),e.registerEntity(i.DisposableEmail,"disposableEmail"),e.registerEntity(i.DisposablePhone,"disposablePhone"),e.registerEntity(i.LoginUrl,"loginUrl"),e.registerEntity(i.AutofillFeedback,"autofillFeedback"),e.registerEntity(i.MappedForm,"mappedForm"),e.registerEntity(i.MappedField,"mappedField"),e.registerEntity(i.PanelActivity,"panelActivity"),e.registerEntity(i.Preference,"preference"),e.registerEntity(i.ShieldedCard,"shieldedCard"),e.registerEntity(i.ShieldedEmail,"shieldedEmail"),e.registerEntity(i.ShieldedPhone,"shieldedPhone"),e.registerEntity(i.EmailDomain,"emailDomain"),e.registerEntity(i.TabData,"tabData"),e.registerEntity(i.Address,"address"),e.registerEntity(i.Account,"account"),e.registerEntity(i.Identity,"identity"),e.registerEntity(i.RealCard,"realCard"),e.registerEntity(i.Note,"note"),e.registerEntity(i.PageTracker,"pageTracker"),e.registerEntity(i.PageData,"pageData"),e.registerEntity(i.CustomTabData,"customTabData"),e.registerEntity(i.BlacklistOrPreference,"blacklistOrPreference"),e.registerEntity(i.GlobalData,"globalData"),e.registerEntity(i.GlobalTracker,"globalTracker"),e.registerEntity(i.GlobalPreference,"globalPreference"),e.registerEntity(i.GlobalFeature,"globalFeature"),e.registerEntity(i.DntStats,"dntStats"),e.registerEntity(i.TrackerInfo,"trackerInfo"),e.registerEntity(i.Advt,"advt"),e.registerEntity(i.ExtensionVersion,"extensionVersion")},emptyDatabase:function(e,n){t.StorageRouter.initializeWebSQLStorage({dbName:"idme_test",dbDescription:"Storage for the unit tests",dbSizeInBytes:5242880,ready:function(){var e=15;i.Account.all().destroyAll(function(){e--}),i.Address.all().destroyAll(function(){e--}),i.Blacklist.all().destroyAll(function(){e--}),i.RealCard.all().destroyAll(function(){e--}),i.Identity.all().destroyAll(function(){e--}),i.Note.all().destroyAll(function(){e--}),i.DisposableCard.all().destroyAll(function(){e--}),i.DisposableEmail.all().destroyAll(function(){e--}),i.DisposablePhone.all().destroyAll(function(){e--}),i.Preference.all().destroyAll(function(){e--}),i.MappedForm.all().destroyAll(function(){e--}),i.MappedField.all().destroyAll(function(){e--}),i.ShieldedCard.all().destroyAll(function(){e--}),i.ShieldedEmail.all().destroyAll(function(){e--}),i.ShieldedPhone.all().destroyAll(function(){e--});var t=function(){0<e?a.setTimeout(t,50):n.call()};a.setTimeout(t,50)}})}}}),ABINE_DNTME.define("abine/storage/shieldedCard",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/eventLogger","persistence/caching","abine/config","abine/licenseServer"],function(e,t,n,i,a,r,s,o,c){var l=t.define("ShieldedCards",{last_four:"TEXT",first_name:"TEXT",last_name:"TEXT",month:"TEXT",year:"TEXT",card_type:"TEXT",address1:"TEXT",address2:"TEXT",city:"TEXT",state_abbreviation:"TEXT",zip:"TEXT",createdAt:"DATE",modifiedAt:"DATE",pushVersion:"INTEGER"});return l.enableCaching(),e.extend(l.prototype,{}),e.extend(l,n.DefaultActions,{routes:{"read/shieldedCard/all":"index","read/shieldedCard/:id":"show","create/shieldedCard":"createFromServer","update/shieldedCard/:id":"update","delete/shieldedCard/:id":"destroy"},createFromServer:function(n,a){i.Preference.findBy("key","authToken",function(e){!e||e.isEmpty(),this.licenseServer=this.licenseServer||new c,this.licenseServer.billingInfo({},function(e,t){e?ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/storage/shieldedCard]#[createFromServer]# error event in shieldedCard.createFromServer call to license server"):(n.payload.first_name=t.first_name,n.payload.last_name=t.last_name,n.payload.month=t.month,n.payload.year=t.year,n.payload.card_type=t.card_type,n.payload.zip=t.zip,n.payload.last_four=t.last_four,n.payload.address1=t.address1,n.payload.address2=t.address2,n.payload.city=t.city,n.payload.state_abbreviation=t.state,l.create(n,a))})})}}),i.ShieldedCard=l}),ABINE_DNTME.define("abine/storage/shieldedEmail",["documentcloud/underscore","persistence","abine/storageMixins","abine/config","abine/emailServer","storage","persistence/caching"],function(o,e,t,n,a,c){var l=e.define("ShieldedEmails",{guid:"TEXT",userId:"INT",email:"TEXT",first_name:"TEXT",last_name:"TEXT",active:"BOOL",createdAt:"DATE",modifiedAt:"DATE",pushVersion:"INTEGER"});return l.enableCaching("email"),o.extend(l,t.DefaultActions,{routes:{"read/shieldedEmail/all":"indexWithAltEmail","read/shieldedEmail/:id":"show","delete/shieldedEmail/:id":"destroy"},indexWithAltEmail:function(r,s){c.Preference.batchFindBy([{by:"key",value:"altEmail1"},{by:"key",value:"altEmail2"}],function(i){c.Identity.index(null,function(a){l.index(r,function(e){var t=e&&0<e.length?e[0]:null;if(t){(t=t.toJSON()).altEmails=[];var n={};n[t.email]=!0,i.altEmail1&&i.altEmail1.value&&(t.altEmails.push({email:i.altEmail1.value,id:t.id+":"+t.altEmails.length}),n[i.altEmail1.value.toLowerCase()]=1),i.altEmail2&&i.altEmail2.value&&(t.altEmails.push({email:i.altEmail2.value,id:t.id+":"+t.altEmails.length}),n[i.altEmail2.value.toLowerCase()]=1),o.each(a,function(e){e.email&&-1!=e.email.indexOf("@")&&(n[e.email.toLowerCase()]||(t.altEmails.push({email:e.email,id:t.id+":"+t.altEmails.length}),n[e.email.toLowerCase()]=1))}),l.respondWithJSON([t],r,s)}else l.respondWithEntities(t,r,s)})})})}}),c.ShieldedEmail=l}),ABINE_DNTME.define("abine/storage/shieldedPhone",["documentcloud/underscore","persistence","abine/storageMixins","storage","persistence/caching","abine/phoneServer","abine/config"],function(c,e,t,n){var l=e.define("ShieldedPhones",{country_code:"TEXT",number:"TEXT",is_validated:"TEXT",rails_id:"INTEGER",auth_token:"TEXT",createdAt:"DATE",modifiedAt:"DATE",pushVersion:"INTEGER"});return l.enableCaching(),c.extend(l.prototype,{refresh:function(e){e()},getPrettyNumber:function(){return"("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal()},getAreaCode:function(){return this.number.substr(0,3)},getExchange:function(){return this.number.substr(3,3)},getLocal:function(){return this.number.substr(6,4)},isValidated:function(){return"true"==this.is_validated}}),c.extend(l,t.DefaultActions,{routes:{"read/shieldedPhone/all":"indexWithRefresh","read/shieldedPhone/:id":"showWithRefresh"},showWithRefresh:function(t,n){l.load(t.params[0],function(e){e.refresh(function(){l.show(t,n)})})},indexWithRefresh:function(a,s){var o=Math.floor(1e5*Math.random())+":";l.index(null,function(e){c.async.forEach(e,function(e,t){e.refresh(t)},function(e){e&&ABINE_DNTME.log.error("[ERROR CALLBACK]#[abine/storage/shieldedPhone]#[indexWithRefresh]# error event in ShieldedPhone.index async forEach"),n.Identity.index(null,function(n){l.index(a,function(e){var i={},r=[];if(0<e.length){var t=e[0].toJSON();i[t.number.toString()]=1,r.push(t)}else r.push({});c.each(n,function(e){if(e.phone&&-1!=e.phone.indexOf("+")){var t=e.phone.replace("+","").split(" "),n=t[0],a=t[1];i[a]||(r.push({country_code:n,number:a,identity:!0,id:o+r.length}),i[a]=1)}}),l.respondWithJSON(r,a,s)})})})})}}),n.ShieldedPhone=l}),ABINE_DNTME.define("abine/storage/tabData",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/ajax"],function(p,e,t,m,s){function g(e){e=e||new Date;var t=new Date(e.getFullYear(),0,0);return Math.floor((e-t)/864e5)}function i(t,n,a){try{ABINE_DNTME.require(["modules"],function(e){e.mappingsModule.sendTrackerAllow(t,n,a,ABINE_DNTME.dnt_api.getRulesVersion())})}catch(e){}}function y(n,a){a=a||emptyCallback,n in r?a(r[n]):s.ajax({url:n+"/.well-known/gpc",success:function(e){try{e=JSON.parse(e)}catch(t){e={}}r[n]=e&&"gpc"in e?e.gpc:"invalid",a(r[n])},error:function(){r[n]="error",a(r[n])}})}var b=864e5,r={},n=function(){};p.extend(n,t.DefaultActions,{routes:{"create/pageTracker":"toggleTracker"},toggleTracker:function(e){var t=e.sender,n=ABINE_DNTME.dnt_api.getTabData(t);e.payload.blocked?ABINE_DNTME.dnt_api.block(e.payload.name,n.host):(ABINE_DNTME.dnt_api.allow(e.payload.name,n.host),i(n.host,n.url,e.payload.name))}});var a=function(){};p.extend(a,t.DefaultActions,{routes:{"create/customTabData":"setCustomData"},setCustomData:function(e){ABINE_DNTME.dnt_api.setCustomTabData(e.sender,e.payload.name,e.payload.value)}});var o=function(){};p.extend(o,t.DefaultActions,{routes:{"update/blacklistOrPreference/:id":"save"},save:function(t,n){if("blacklist"==t.payload.type){if("gpc"==t.payload.name)return void chrome.permissions.request({permissions:["webNavigation"]},function(e){e?ABINE_DNTME.dnt_api.setGPC(t.payload.domain,!t.payload.value):console.log("permission denied"),n()});var e={payload:{domain:t.payload.domain,changed:t.payload.name,suppressWebapp:t.payload.suppressWebapp},params:[t.payload.id],sender:t.sender};if(e.payload[t.payload.name]=t.payload.value,"tracker"==t.payload.name&&t.payload.value){var a=ABINE_DNTME.dnt_api.getTabData(t.sender);i(t.payload.domain,a.url,"*")}m.Blacklist.updateOrCreate(e,n)}else m.GlobalPreference.togglePreference(t,n)}});var v=function(){};return p.extend(v,t.DefaultActions,{routes:{"read/tabData/:id":"getTabData","create/tabData":"reportIssue","update/tabData/autofill":"makeDefault"},disableService:function(t){try{chrome.privacy.services[t].get({},function(e){"controllable_by_this_extension"==e.levelOfControl&&chrome.privacy.services[t].set({value:!1},function(){chrome.runtime.lastError===undefined?console.log("chrome "+t+" disabled"):console.log("chrome "+t+" disable failed",chrome.runtime.lastError)})})}catch(e){console.log("exception while disabling "+t,e)}},makeDefault:function(){var t=this;chrome.permissions.request({permissions:["privacy"]},function(e){e?(t.disableService("autofillEnabled"),t.disableService("passwordSavingEnabled"),t.disableService("autofillAddressEnabled"),t.disableService("autofillCreditCardEnabled")):console.log("permission denied")})},reportIssue:function(i){var r=ABINE_DNTME.dnt_api.getTabData(i.sender);m.Preference.batchFindBy([{by:"key",value:"installVersion"}],function(e){var t="";if(r){t=[];for(var n=0;n<r.trackers.length;n++)t.push(r.trackers[n].name);t=t.join(",")}var a={reason:"dntme-feedback"};a.version=ABINE_DNTME.config.version,a.origin=ABINE_DNTME.config.tags[0],a.revision=ABINE_DNTME.config.buildNum,a.oversion=e.installVersion?e.installVersion.value:"",a.url=r?encodeURIComponent(r.url):"",a.description=encodeURIComponent(i.payload.feedback),a.rulesversion=encodeURIComponent(ABINE_DNTME.dnt_api.getRulesVersion()),a.trackers=t,a.domain=encodeURIComponent(r?r.host:""),a.log="",s.ajax({
url:"http://www.abine.com/checkin/dntmefeedback.php",data:"data="+JSON.stringify(a)})})},getWeeklyReportData:function(e,t,n,a){var i=(e.getTime()-t.getTime())/b,r=7;1<t.getDay()&&(r+=7-t.getDay());var s=e.getDay();if(r<=i&&0<s&&s<=3){var o=null;n&&(o=parseInt(n));var c=new Date(e.getTime()-s*b);c.setHours(0,0,0,0);for(var l=!1,u=a.dailyTrackerCounts?JSON.parse(a.dailyTrackerCounts):{},d=0;d<7;d++){var f=new Date(c.getFullYear(),c.getMonth(),c.getDate()-d),h=g(f),p=f.getFullYear();if(p in u&&0<u[p][h]){l=!0;break}}if(l&&(!o||o<c.getTime()))return["January","February","March","April","May","June","July","August","September","October","November","December"][c.getMonth()]+" "+c.getDate()}return null},getBrowserAutoFillStatus:function(t){try{chrome.privacy.services.autofillEnabled.get({},function(e){"controllable_by_this_extension"===e.levelOfControl?t(!1,!0):t(!0,!0)})}catch(e){"Chrome"==ABINE_DNTME.config.browser||"Opera"==ABINE_DNTME.config.browser?t(!1,!0):t(!1,!1)}},getTabData:function(u,d){var f=ABINE_DNTME.dnt_api.getTabData(u.sender);if(f||ABINE_DNTME.require(["abine/dnt/tabData"],function(e){e.get(u.sender),f=ABINE_DNTME.dnt_api.getTabData(u.sender)},null,!0),u.params&&0<u.params.length&&"trackers"==u.params[0])v.respondWithJSON(f,u,d);else{var h=this;this.getBrowserAutoFillStatus(function(c,l){m.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"installDate"},{by:"key",value:"blockTrackers"},{by:"key",value:"helpMeLogin"},{by:"key",value:"submitAccount"},{by:"key",value:"suggestProtectedEmail"},{by:"key",value:"suggestProtectedPhone"},{by:"key",value:"suggestProtectedCard"},{by:"key",value:"suggestRealCard"},{by:"key",value:"suggestAddresses"},{by:"key",value:"suggestIdentities"},{by:"key",value:"hasEnabledPayments"},{by:"key",value:"entitledToPayments"},{by:"key",value:"entitledToPhone"},{by:"key",value:"entitledToAccounts"},{by:"key",value:"entitledToSync"},{by:"key",value:"rememberAccounts"},{by:"key",value:"rememberCards"},{by:"key",value:"sync_store_manager"},{by:"key",value:"understanding_tracker_clicked"},{by:"key",value:"has_mobile"},{by:"key",value:"showMedals"},{by:"key",value:"oldEmail"},{by:"key",value:"loginNotLock"},{by:"key",value:"suggestStrongPassword"},{by:"key",value:"showTrackersOnload"},{by:"key",value:"showWeeklyReports"},{by:"key",value:"weeklyReportClickedOn"},{by:"key",value:"autoPremiumRegisterShown"},{by:"key",value:"showCheckoutPanelGrowl"}],function(o){m.ShieldedPhone.index(null,function(s){m.DisposableEmail.index(null,function(r){m.Blacklist.findBy("domain",f.host,function(i){ABINE_DNTME.dnt_api.forceSaveStats(),m.DntStats.index(null,function(e){f.dntStats=0<e.length?e[0].toJSON():{},f.dntStats.showMedals=!o.showMedals||"true"==o.showMedals.value,f.loggedIn=o.authToken&&o.authToken.value&&""!=o.authToken.value,!f.loggedIn&&o.oldEmail&&o.oldEmail.value&&""!=o.oldEmail.value&&(f.email=o.oldEmail.value),f.loginNotLock=o.loginNotLock&&o.loginNotLock.isTrue(),f.loginNotRegister=f.loginNotLock||f.email,f.unlockScreen=f.email,f.showTrackersOnload=o.showTrackersOnload&&o.showTrackersOnload.isTrue(),f.hasMobileApp=f.loggedIn&&o.has_mobile&&o.has_mobile.isTrue(),f.dropboxEnabled=f.loggedIn&&!!o.sync_store_manager&&("dropbox"==o.sync_store_manager.value||"blur"==o.sync_store_manager.value),f.entitledToSync=o.entitledToSync&&o.entitledToSync.isTrue(),m.Blacklist.index(null,function(t){for(var n in t.sort(function(e,t){return e.domain<t.domain?-1:e.domain>t.domain?1:0}),t=p.map(t,function(e){return e._data})){var e=t[n].domain;m.Blacklist.findBy("domain",e,function(e){t[n].id=e.id})}f.blacklistCollection=t}),i||(i=new m.Blacklist({domain:f.host,tracker:f.disabled})),f.blacklist=i.toJSON(),f.blacklist.loggedIn=f.loggedIn,f.blacklist.globalTracker=ABINE_DNTME.dnt_api.getDefaultBlocking(),f.blacklist.globalPhone=o.suggestProtectedPhone&&o.suggestProtectedPhone.isTrue(),f.blacklist.globalCard=o.suggestProtectedCard&&o.suggestProtectedCard.isTrue(),f.blacklist.globalEmail=o.suggestProtectedEmail&&o.suggestProtectedEmail.isTrue(),f.blacklist.globalPassword=o.suggestStrongPassword&&o.suggestStrongPassword.isTrue(),f.blacklist.globalLogin=o.helpMeLogin&&o.helpMeLogin.isTrue(),f.blacklist.globalRealCard=o.suggestRealCard&&o.suggestRealCard.isTrue(),f.blacklist.globalAddress=o.suggestAddresses&&o.suggestAddresses.isTrue(),f.blacklist.globalAccounts=o.rememberAccounts&&o.rememberAccounts.isTrue(),f.blacklist.globalIdentity=o.suggestIdentities&&o.suggestIdentities.isTrue(),f.blacklist.globalSaveCard=o.rememberCards&&o.rememberCards.isTrue(),f.blacklist.globalSubmitAccount=o.submitAccount&&o.submitAccount.isTrue(),f.blacklist.trackerOff=f.blacklist.tracker||!f.blacklist.globalTracker,f.blacklist.phoneOff=f.blacklist.phone||!f.blacklist.globalPhone,f.blacklist.cardOff=f.blacklist.card||!f.blacklist.globalCard,f.blacklist.emailOff=f.blacklist.email||!f.blacklist.globalEmail,f.blacklist.addressOff=f.blacklist.address||!f.blacklist.globalAddress,f.blacklist.accountOff=f.blacklist.save_account||!f.blacklist.globalAccounts,f.blacklist.realCardOff=f.blacklist.real_card||!f.blacklist.globalRealCard,f.blacklist.loginOff=f.blacklist.account||!f.blacklist.globalLogin,f.blacklist.passwordOff=f.blacklist.password||!f.blacklist.globalPassword,f.blacklist.identityOff=f.blacklist.identity||!f.blacklist.globalIdentity,f.blacklist.saveCardOff=f.blacklist.save_card||!f.blacklist.globalSaveCard,f.blacklist.submitAccountOff=f.blacklist.submit_account||!f.blacklist.globalSubmitAccount,f.blacklist.hasEnabledPhone=o.entitledToPhone&&o.entitledToPhone.isTrue()&&0<s.length&&s[0].isValidated(),f.blacklist.hasEnabledCard=o.autoPremiumRegisterShown&&o.autoPremiumRegisterShown.isTrue()||o.hasEnabledPayments&&o.hasEnabledPayments.isTrue(),f.blacklist.hasEnabledAccounts=o.entitledToAccounts&&o.entitledToAccounts.isTrue(),f.blacklist.has_masked_emails=1<r.length,f.blacklist.has_masked_phones=0<s.length,f.blacklist.premium=f.premium,f.understanding_tracker_clicked=o.understanding_tracker_clicked&&o.understanding_tracker_clicked.isTrue(),f.premium=o.authToken&&""!=o.authToken.value&&o.entitledToPhone&&o.entitledToPhone.isTrue(),f.cardMoney=o.authToken&&""!=o.authToken.value&&o.entitledToPayments&&o.entitledToPayments.isTrue()&&!f.premium,f.showFreeCard=!(f.premium||f.cardMoney),f.dntStats.premium=f.premium,f.dntStats.maskmeInstalled=f.blacklist.maskmeInstalled=f.maskmeInstalled=!!ABINE_DNTME.maskme_installed;var t=new Date;t.setHours(0,0,0,0);var n=new Date(o.installDate?o.installDate.value:t.getTime());if(n.setHours(0,0,0,0),f.installMonth=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][n.getMonth()]+" '"+n.getFullYear().toString().substr(2),f.weeklyReport=null,!ABINE_DNTME.maskme_installed&&(!o.showWeeklyReports||o.showWeeklyReports.isTrue())){var a=null;o.weeklyReportClickedOn&&(a=o.weeklyReportClickedOn.value),f.weeklyReport=h.getWeeklyReportData(t,n,a,f.dntStats)}f.blurDefaultAutofill=c,f.canChangeAutofill=l,f.gpc=ABINE_DNTME.dnt_api.getGPC("*"),f.siteGPC=ABINE_DNTME.dnt_api.getGPC(f.host),f.siteGPC?y(f.url.replace(/^(http[s]?:\/\/[^\/]+).+/i,"$1"),function(e){f.siteRespectsGPC=e,v.respondWithJSON(f,u,d)}):(f.siteRespectsGPC=!1,v.respondWithJSON(f,u,d))})})})})})})}}}),m.TabData=v,m.PageTracker=n,m.CustomTabData=a,m.BlacklistOrPreference=o,v}),ABINE_DNTME.define("abine/storage/trackerData",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/localStorage"],function(t,e,n,i,r){var a=e.define("TrackerData",{domain:"TEXT"});return t.extend(a,n.DefaultActions,{routes:{},createLocal:function(a,e){i.Preference.findBy("key","shouldSendErrorReports",t.bind(function(e){if(!e||e.isTrue()){var t=r.getItem("trackerData-to-push");if(t)try{t=JSON.parse(t)}catch(n){t={}}else t={};t[a.payload.d+":"+a.payload.h]=a.payload.t,r.setItem("trackerData-to-push",JSON.stringify(t))}else r.removeItem("trackerData-to-push")},this)),e&&e({})}}),i.TrackerData=a}),ABINE_DNTME.define("abine/storage/trackerInfo",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/ajax"],function(e,t,n,a,c){var l={},u="/api/v1/lookup",d=t.define("TrackerInfo",{domain:"TEXT",trackers:"TEXT",color:"TEXT",info:"TEXT"});return e.extend(d,n.DefaultActions,{routes:{"read/trackerInfo/index":"getTrackersForDomains"},getTrackersForDomains:function(e,t){function i(){d.respondWithJSON(r,e,t)}var n=e.payload.domains,r=[],a=[];for(var s in n)l[s]?r.push(l[s]):a.push(s);if(0<a.length){var o="https://"+ABINE_DNTME.config.trackerHost+u;c.ajax({url:o,type:"POST",data:{urls:a},success:function(e){for(var t in e)if(e[t].trackers){if("No data"==e[t].trackers)l[t]={domain:t};else{var n,a=e[t].trackers.length;n=a<=1?"green":1<a&&a<=5?"yellow":"red",l[t]={domain:t,trackers:e[t].trackers.join(":"),color:n,info:e[t].info}}r.push(l[t])}i()},error:function(){i()}})}else i()}}),a.TrackerInfo=d}),ABINE_DNTME.define("storage",["persistence","documentcloud/underscore"],function(c,l){var u={dumpToJSON:function(){var e=[];for(var t in u)"meta"in u[t]&&e.push(u[t]);c.dump(e,function(e){JSON.stringify(e)})},purgeDatabase:function(e){c.clean();var t=[];for(var n in u)"meta"in u[n]&&t.push(u[n]);l.async.forEach(t,function(t,n){c.transaction(function(e){e.executeSql("delete from "+t.meta.name,null,function(){n()})})},function(){e()})},clearAllCache:function(s,o){ABINE_DNTME.require(["abine/blurstore-api"],function(r){u.ShieldedPhone.clearCache(function(){u.DisposablePhone.clearCache(function(){u.Account.clearCache(function(){u.Address.clearCache(function(){u.Note.clearCache(function(){u.RealCard.clearCache(function(){u.AccountHistory.clearCache(function(){"blur"!=s&&r.disconnect(),u.Account.index(null,function(i){u.Address.index(null,function(a){u.Note.index(null,function(n){u.RealCard.index(null,function(t){u.AccountHistory.index(null,function(e){"blur"==s?r.connectAndLoad():(l.each(i,function(e){e.pushed=0}),l.each(e,function(e){e.pushed=0}),l.each(a,function(e){e.pushed=0}),l.each(n,function(e){e.pushed=0}),l.each(t,function(e){e.pushed=0}),c.flush()),u.EmailDomain.clearCache(function(){u.CompanyAccount.clearCache(function(){o()})})})})})})})})})})})})})})})}};return u}),ABINE_DNTME.define("abine/modules/license",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","abine/ajax","abine/config","abine/securityManager","abine/licenseServer","abine/responseCodes","modules","abine/crypto","abine/ajax","abine/webapp","abine/memoryStore"],function(h,e,r,u,d,p,m,s,t,n,o,c,p,l,a){var g=function(){},i=function(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},f=new(e.BaseClass.extend({initialize:function(e){this.options=e,this.licenseServer=this.options.licenseServer||new t},setMessenger:function(e){this.messenger=e},startDailyTouch:function(t){t=t||g,u.Preference.findBy("key","lastTouch",h.bind(function(e){e&&e.value?new Date(parseInt(e.value)).valueOf()<i().valueOf()?this.makeDailyActiveTouch(!1,t):this.delayDailyActiveTouch(t):this.makeDailyActiveTouch(!0,function(){t()})},this))},makeDailyActiveTouch:function(e,i){if(i=i||g,ABINE_DNTME.maskme_installed)i();else{var a={};a.install=!!e,u.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"installAuthToken"}],h.bind(function(e){var t=e.authToken,n=e.installAuthToken;t&&!t.isEmpty()&&(a.auth_token=t.value),n&&!n.isEmpty()&&(a.install_auth_token=n.value),this.licenseServer.makeDailyTouch(a,h.bind(function(e,a){e?this.delayDailyActiveTouch(function(){i(e)}):this.writeDailyTouchPref(h.bind(function(){this.delayDailyActiveTouch(function(){if(a.install_auth_token){if(a.splits&&0<a.splits.length){var e=h.reduce(a.splits,function(e,t){return e[t.test_name]=t.bucket_id,e},{});try{u.Preference.createOrModify({key:"splitTests",value:JSON.stringify(e)})}catch(n){}}if(a.config_overrides&&0<a.config_overrides.length){var t=h.reduce(a.config_overrides,function(e,t){return e[t.config_name]=t.config_value,e},{});try{u.Preference.createOrModify({key:"configOverrides",value:JSON.stringify(t)})}catch(n){}}if(a.other_data)try{u.Preference.createOrModify({key:"isBlurUpgrade",value:a.other_data.is_blur_upgrade})}catch(n){}u.Preference.createOrModify({key:"installAuthToken",value:a.install_auth_token},i)}else i()})},this))},this))},this))}},removeDailyTouchPref:function(t){u.Preference.findBy("key","lastTouch",function(e){e?(d.remove(e),d.flush(t)):t()})},delayDailyActiveTouch:function(e){e=e||g;var t=18e5+36e5*Math.random();this.dailyActiveTimeout&&r.clearTimeout(this.dailyActiveTimeout),this.dailyActiveTimeout=r.setTimeout(h.bind(this.startDailyTouch,this),t),e()},writeDailyTouchPref:function(t){t=t||g,u.Preference.findOrCreate({key:"lastTouch"},function(e){e.value=Math.floor(i().valueOf()),e.modifiedAt=i(),d.flush(function(){t()})})},sendFeedbackEmail:function(e,n){n=n||g,e.browserUserAgent="Extension "+ABINE_DNTME.config.browser+" "+ABINE_DNTME.config.version,this.licenseServer.sendFeedbackEmail(e,h.bind(function(e,t){e?n(e):n(null,t)},this))},logAction:function(t,n){n=n||g,u.Preference.findBy("key","sendToolbarClick",h.bind(function(e){e||u.Preference.createOrModify({key:"sendToolbarClick",value:"true"},h.bind(function(){this.licenseServer.logAction(t,h.bind(function(e,t){e?n(e):n(null,t)},this))},this))},this))},logSplitData:function(e,n){n=n||g,this.licenseServer.logSplitData(e,h.bind(function(e,t){e?n(e):n(null,t)},this))},logPasswordFillData:function(e,n){n=n||g,this.licenseServer.logPasswordFillData(e,h.bind(function(e,t){e?n(e):n(null,t)},this))},logout:function(e,n){n=n||g,this.licenseServer.logout({auth_token:e},h.bind(function(e,t){n(e,t)},this))},login:function(n,a){a=a||g;var i=n.password;n.password=c.getServerPassword(i);var e=c.generateKey();n.key=c.encryptKey(i,e),n.verify_key=c.encryptKey(e,e);var t=n.mfa_code,r=n.auth_code;delete n.mfa_cdoe,delete n.auth_cdoe,this.licenseServer.login({application:"manageme",user_login:n,mfa_code:t,auth_code:r,remember_device:"true"},h.bind(function(e,t){e?(n.password=i,a(e,t)):this._afterLoginOrRegister(t,i,function(){a(null,t)})},this))},_afterLoginOrRegister:function(e,t,n){var a=c.decryptKey(t,e.user.key,null,!0);a==e.user.key&&(a=null);var i=null;e.user.companyKey&&(i=c.decryptKey(t,e.user.companyKey,null,!0))==e.user.companyKey&&(i=null),u.Preference.batchCreateOrModify([{key:"authToken",value:e.auth_token},{key:"key",value:a},{key:"ckey",value:i},{key:"installAuthToken",value:e.install_auth_token},{key:"hasRegistered",value:"true"},{key:"passwordHint",value:e.password_hint}],h.bind(function(){s.setAuthToken(e.auth_token,a,i,h.bind(function(){d.flush(h.bind(function(){r.setTimeout(function(){o.mappingsModule.refreshPanels()},2e4),this.messenger.broadcastToAllTabs("broadcast:preference:reload",{}),this.messenger.broadcastToAllTabs("broadcast:register:success",{}),l.reload(),n()},this))},this))},this))},register:function(a,i){i=i||g;var r=a.password,e=a.register_type,t=!("send_password_email"in a)||a.send_password_email;if(!a.generated_password){var n=c.generateKey();a.key=c.encryptKey(r,n),a.verify_key=c.encryptKey(n,n)}delete a.generated_password,a.password=c.getServerPassword(r),a.password_confirmation=a.password,a.tag=m.tags[0],delete a.register_type,delete a.send_password_email;var s=a;u.Preference.createOrModify({key:"registerInProgress",value:"true"},h.bind(function(n){this.licenseServer.register({user:s,application:"manageme",send_password_email:t,register_type:e},h.bind(function(e,t){e?(a.password=r,a.password_confirmation=r,d.remove(n),d.flush(h.bind(function(){this.messenger.broadcastToAllTabs("broadcast:register:failed",{err:e,serverData:t}),i(e,t)},this))):(d.remove(n),this._afterLoginOrRegister(t,r,function(){i(null,t)}))},this))},this))},passwordCardAuth:function(e,n){n=n||g,e.password=c.getServerPassword(e.password),this.licenseServer.passwordCardAuth(e,h.bind(function(e,t){n(e?{success:!1}:{success:!0,token:t.token})},this))},getGenericBiometricKey:function(e,n){n=n||g,a.get("biometricKeyToken",h.bind(function(e){var t=null;e&&(t={old_token:e}),this.licenseServer.getGenericBiometricKey(t,h.bind(function(e,t){n(e?{success:!1}:{success:!0,key:t.key})},this))},this))},createBiometricAuthRequest:function(e,t){t=t||g,this.licenseServer.createBiometricAuthRequest(e,h.bind(function(e){t(e?{success:!1,error:e.errorCode}:{success:!0})},this))},getBiometricAuthResponse:function(e,n){n=n||g,this.licenseServer.getBiometricAuthResponse(e,h.bind(function(e,t){n(e?{success:!1}:t)},this))},subscribe:function(l,u,d,f){f=f||g,this.licenseServer.signature({},h.bind(function(e,t){function n(e){var t=e.indexOf("{"),n=e.lastIndexOf("}"),a=JSON.parse(e.substr(t,n-t+1));a.success?this.licenseServer.subscribed({recurly_token:a.success.token,source:d},h.bind(function(e){e?f(!0,{errors:{base:["Error activating payments"]}}):this.refreshEntitlements(h.bind(function(){this.refreshLastFourCardDigits({},function(){f(!1,{})})},this))},this)):f(!0,a)}function a(e,t){if(200==e){if(t.id)var n={stripe_token:t.id,source:d,ip_address:t.client_ip,plan_code:c,first_six:o.number.substr(0,6)};else n={source:d,plan_code:c,use_existing:"true"};this.licenseServer.stripe_subscribe(n,h.bind(function(e){e?f(!0,{errors:{base:["Error activating payments"]}}):this.refreshEntitlements(h.bind(function(){this.refreshLastFourCardDigits({},function(){f(!1,{})})},this))},this))}else f(!0,{errors:{base:[t.error.message]}})}if(t[u+"_options_signature"]){var i={signature:t[u+"_options_signature"],account:t[u+"_options"].account,billing_info:l,subscription:t[u+"_options"].subscription,currency:t.recurly_config.currency},r=t.recurly_config.subdomain,s="https://"+r+".recurly.com/jsonp/"+r+"/subscribe";p.ajax({dataType:"text",url:s,data:i,success:h.bind(n,this),error:h.bind(n,this)})}else{var o={name:(l.first_name+" "+l.last_name).replace(/^[\s]+|[\s]+$]/,"").replace(/[\s]+]/," "),number:l.number,exp_month:l.month,exp_year:l.year,cvc:l.verification_value,address_line1:l.address1,address_line2:l.address2,address_city:l.city,address_state:l.state,address_zip:l.zip,address_country:l.country},c=t[u+"_options"].subscription.plan_code;o.number?(Stripe.setPublishableKey(m.stripe_key),Stripe.createToken(o,h.bind(a,this))):a.apply(this,[200,{}])}},this))},refreshEntitlements:function(n){n=n||g,this.licenseServer.refreshEntitlements({},h.bind(function(e,t){e?n(e,t):this.updateEntitlementPrefs(t.user.licenses,h.bind(function(){this.updateHasEnabledPaymentsPref(t.user.activated_cards_at,h.bind(function(){this.updateHasAuthorizedCoinbase(t.user.has_authorized_coinbase,h.bind(function(){d.flush(h.bind(function(){this.messenger.broadcastToAllTabs("broadcast:preference:reload",{}),n(null,t)},this))},this))},this))},this))},this))},updateEntitlementPrefs:function(r,s){s=s||g;var o={entitledToSync:"sync",entitledToPhone:"protected_phone",entitledToPayments:"payments",entitledToAccounts:"accounts"},c={},l={},e=function(e){return e.key in o};u.Preference.listCached(e,h.bind(function(e){for(var t in h.each(e,function(e){c[o[e.key]]=e}),o)o[t]in c||(c[o[t]]=new u.Preference({key:t,value:"false"}),d.add(c[o[t]]));var n=c.protected_phone.isTrue(),a=c.payments.isTrue(),i=c.accounts.isTrue();h.each(r,function(e){c[e.feature_code]&&c[e.feature_code].setTrue(),l[e.feature_code]=1}),
// if it wasn't one of the features in the licenses returned, there's no license for it, so mark it false
h.each(h.keys(c),function(e){e in l||c[e].setFalse()}),n&&c.protected_phone.isFalse()&&(u.ShieldedPhone.all().destroyAll(),u.DisposablePhone.all().destroyAll()),u.Preference.createOrModify({key:"hadEmail",value:"true"}),u.Preference.createOrModify({key:"hadPhone",value:c.protected_phone&&c.protected_phone.isTrue()?"true":"false"}),u.Preference.createOrModify({key:"hadCard",value:c.payments&&c.payments.isTrue()?"true":"false"}),c.payments&&c.payments.isTrue()&&this.refreshLastFourCardDigits(),a&&c.payments.setTrue(),!i&&c.accounts&&c.accounts.isTrue()&&u.Preference.batchCreateOrModify([{key:"suggestStrongPassword",value:"true"},{key:"suggestAddresses",value:"true"},{key:"helpMeLogin",value:"true"},{key:"rememberAccounts",value:"true"}]),h.each(e,function(e){d.forceAdd(e)}),d.flush(function(){s()})},this))},refreshLastFourCardDigits:function(e,a){a=a||g,this.licenseServer.billingInfo({},h.bind(function(e,n){e?a(e,n):n.subscription&&!n.subscription.card_not_setup?(u.Preference.findBy("key","cardNotSetup",function(e){e&&d.remove(e)}),u.ShieldedCard.index(null,h.bind(function(e){if(e&&e[0]){var t=e[0];t.last_four=n.last_four,t.first_name=n.first_name,t.last_name=n.last_name,t.month=n.month,t.year=n.year,t.card_type=n.card_type,t.zip=n.zip,d.flush(h.bind(function(){this.messenger.broadcast("broadcast:billinginfo:updated",{}),a(null,n)},this))}else u.ShieldedCard.create({payload:n},h.bind(function(){this.messenger.broadcast("broadcast:billinginfo:updated",{}),a(null,n)},this))},this))):n.subscription&&n.subscription.card_not_setup?u.Preference.createOrModify({key:"cardNotSetup",value:"true"},function(){a(null,n)}):a(null,n)},this))},updateHasEnabledPaymentsPref:function(n,a){a=a||g(),u.Preference.batchFindBy([{by:"key",value:"hasEnabledPayments"},{by:"key",value:"suggestProtectedCard"},{by:"key",value:"autoPremiumRegisterShown"}],h.bind(function(e){var t=e.hasEnabledPayments;t||(t=new u.Preference({key:"hasEnabledPayments",value:"false"}),d.add(t)),t&&t.isTrue()!=Boolean(n)&&(n?(e.autoPremiumRegisterShown&&e.autoPremiumRegisterShown.isTrue()&&(d.remove(e.autoPremiumRegisterShown),e.suggestProtectedCard||(e.suggestProtectedCard=new u.Preference({key:"suggestProtectedCard",value:"true"}),d.add(e.suggestProtectedCard)),e.suggestProtectedCard.setTrue()),t.setTrue()):t.setFalse()),d.flush(function(){a()})},this))},updateHasAuthorizedCoinbase:function(e,t){t=t||g(),u.Preference.createOrModify({key:"hasAuthorizedCoinbase",value:!!e},function(){t()})},retrieveMedalsEarned:function(n){this.licenseServer.retrieveMedalsEarned({},h.bind(function(e,t){e?n(e):n(null,t)}))},pushSync:function(e){this.licenseServer.pushSync({count:e})},incrementMedalsEarned:function(e,n){var t={additional_medals_earned:e};this.licenseServer.incrementMedalsEarned(t,h.bind(function(e,t){e?n(e):n(null,t)},this))},incrementMedalsEarnedWithCurrentMedals:function(n,a){u.DntStats.index(null,h.bind(function(e){var t=(e=e[0]).currentBadgeIndex+1;0<t?(n&&u.Preference.createOrIncrementByInteger({key:"cardsEarned",value:t},function(){}),this.incrementMedalsEarned(t,a)):a()},this))},logCheckout:function(t,n){s.isLocked()?n&&n(!0):u.Preference.findBy("key","shouldSendShoppingFeedback",h.bind(function(e){n=n||g,!e||e.isTrue()?(t.amount&&!isNaN(parseFloat(t.amount))&&(t.amount=parseInt(100*parseFloat(t.amount))),t.device_id=s.getAnonymousId(),this.licenseServer.logCheckout(t,h.bind(function(e,t){e?n(e):n(null,t)}))):n(!0)},this))},retrieveSyncstoreToken:function(n){n=n||g,this.licenseServer.retrieveSyncstoreToken({},h.bind(function(e,t){e?n(e):n(null,t)}))}}))({});return o.licenseModule=f}),ABINE_DNTME.define("abine/modules/panels",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","abine/ajax","abine/config","abine/securityManager","abine/mappingServer","abine/responseCodes","modules","abine/licenseServer","abine/webapp"],function(m,e,t,g,y,n,a,i,r,s,o,c,l){function u(e,t,n,a){var i=[];for(var r in e)if("length"!=r){var s=e[r],o=parseFloat(s.show_rate);if(!(Math.random()>o||0<parseInt(s.masked_emails)))if(-1!=s.field_type.indexOf("new-feature-added")){if(a<new Date(s.created_at)&&d(s,t,n)){i.unshift(s);break}}else d(s,t,n)&&(1<d?i.unshift(s):i.push(s))}return i}function d(e,t,n){var a=e.targeting_option;if(!a)return 1;if(a.masking&&("off"==a.masking&&!ABINE_DNTME.maskme_installed||"on"==a.masking&&ABINE_DNTME.maskme_installed))return 0;if(a.blocked&&ABINE_DNTME.dnt_api.getAllTimeTotalTrackers()<parseInt(a.blocked))return 0;if(a.install_age&&parseInt(a.install_age)>(Date.now()-E)/864e5)return 0;if(a.domain){if(t&&t.match(new RegExp(a.domain,"i")))return 10}else{if(!a.trackers)return 1;if(n>=parseInt(a.trackers))return 1}}function f(i,r,s){g.Preference.findBy("key","new_feature_explored",function(e){var t=!1;e&&(t=new Date(e.value));var n=u(k,i.host,i.total,t);if(0<n.length){if(!n[0].image){var a=n[0].panel_positions[0].panel_section.body.match(/data:[^\'"]+/);a&&(n[0].image=a[0])}g.PanelActivity.addImpression({payload:{panelId:n[0].id}}),T[r]={id:n[0].id,host:i.host}}else T[r]={id:-1,host:i.host};s(T[r])})}function h(n,a){if(k){var e=n.tabId;e in T&&T[e].host!=n.host&&delete T[e],e in T?(e in T&&-1!=T[e].id&&(n.customImage=k[T[e].id].image),a()):f(n,e,function(){e in T&&-1!=T[e].id&&(n.customImage=k[T[e].id].image),a()})}else T={},g.Preference.findBy("key","dynamicPanels",function(e){if(k={length:0},e){var t=JSON.parse(e.value).panels;m.each(t,function(e){-1!=e.field_type.indexOf("dntme-toolbar-button")&&(k[e.id]=e,k.length++)})}0<k.length?h(n,a):a()})}function p(a,i){w?g.Preference.findBy("key","new_feature_explored",function(e){var t=!1;e&&(t=new Date(e.value));var n=u(w,a.host,a.trackers.length,t);0<n.length?(g.PanelActivity.addImpression({payload:{panelId:n[0].id}}),i(n[0])):i(null)}):g.Preference.findBy("key","dynamicPanels",function(e){if(w={length:0},e){var t=JSON.parse(e.value).panels;m.each(t,function(e){-1!=e.field_type.indexOf("dntme-panel")&&(w[e.id]=e,w.length++)})}0<w.length?p(a,i):i(null)})}function b(n,a){if(A){var e=u(A,n.host,n.trackers.length);if(0<e.length&&!(e[0].id in N))return g.PanelActivity.addImpression({payload:{panelId:e[0].id}}),N[e[0].id]=!0,void a(e[0]);a(null)}else g.Preference.findBy("key","dynamicPanels",function(e){if(A={length:0},e){var t=JSON.parse(e.value).panels;m.each(t,function(e){-1!=e.field_type.indexOf("dntme-growl")&&(A[e.id]=e,A.length++)})}0<A.length?b(n,a):a(null)})}function v(t){E?t():g.Preference.findBy("key","installDate",m.bind(function(e){E=e?parseInt(e.value):Date.now(),t()},this))}var _=function(){},E=null,k=null,T={},w=null,A=null,N={},S=new(e.BaseClass.extend({initialize:function(e){this.mappingServer=e.mappingServer||new r,this.licenseServer=e.licenseServer||new c},getToolbarPanel:function(e,t){v(function(){h(e,function(){t(e)})})},doToolbarPanelAction:function(e){if(k&&e in T&&-1!=T[e].id){var t=k[T[e].id],n=t.panel_positions[0].panel_actions;return 0<n.length&&m.each(n,m.bind(function(e){"open_registration_page"==e.name?l.openHome({id:t.id,action:e.name}):"open_page"==e.name?i.openPage(e.extra):"trigger_click"==e.name?g.PanelActivity.addClick({payload:{panelId:t.id}}):"trigger_conversion"==e.name?g.PanelActivity.addConversion({payload:{panelId:t.id}}):"change_show_rate"==e.name?this.changePanelShowRate({panelId:t.id,extra:e.extra}):"no_action"==e.name||("open_plans_page"==e.name?l.openPremium("panelID"+t.id,null,{id:t.id,action:e.name}):"open_snowman_page"==e.name?l.openSnowman(null,{id:t.id,action:e.name}):"open_activate_cards_page"==e.name?l.openCards({id:t.id,action:e.name}):"open_new_premium_feature_added_page"==e.name&&l.openNewFeatureAdded({id:t.id,action:e.name}))},this)),k.length--,delete T[e],ABINE_DNTME.dnt_api.triggerUpdateIcon(e),!0}return!1},getDNTMePanel:function(e,t){var n=ABINE_DNTME.dnt_api.getTabData(e);n?v(function(){p(n,function(e){t(e)})}):t(null)},getDNTMeGrowl:function(e,t){var n=ABINE_DNTME.dnt_api.getTabData(e);n?v(function(){b(n,function(e){t(e)})}):t(null)},changePanelShowRate:function(e,a){a=a||_;var i=e.panelId,r=e.extra;g.Preference.findBy("key","dynamicPanels",m.bind(function(t){var n=JSON.parse(t.value);m.each(n.panels,function(e){e.id==i&&(e.show_rate=r,w&&w[i]&&(w[i].show_rate=r),k&&k[i]&&(k[i].show_rate=r),t.value=JSON.stringify(n))}),y.flush(a)},this))},processPanelData:function(o,c){c=c||_,A=w=k=null,g.DisposableEmail.index(null,m.bind(function(e){var s=e.length;m.each(o.panels,function(e){s>=e.masked_emails&&(e.masked_emails=0)}),g.Preference.findBy("key","dynamicPanels",m.bind(function(e){if(e){var t;try{t=JSON.parse(e.value).panels}catch(r){}t||(t=[]);var n=[],a={},i={};(o=o.panels).forEach(function(e){i[e.id]=1}),m.each(t,function(e){e.id in i?(n.push(e),-(a[e.id]=1)==e.field_type.indexOf("dntme")&&(a[e.field_type]=e.id),s>=e.masked_emails&&(e.masked_emails=0)):g.PanelActivity.findBy("panelId",e.id,m.bind(function(e){e&&y.remove(e)},this))}),o.forEach(function(e){if(!a[e.id]){if(e.field_type in a)for(var t=0;t<n.length;t++)n[t].id==a[e.field_type]&&(n.splice(t,1),t--);n.push(e)}}),e.value=JSON.stringify({panels:n})}else e=new g.Preference({key:"dynamicPanels",value:JSON.stringify(o)}),y.add(e),o=o.panels;m.async.forEach(o,m.bind(function(t,n){g.PanelActivity.findBy("panelId",t.id,m.bind(function(e){e||(e=new g.PanelActivity({panelId:t.id,impressions:0,users:1,clicks:0,completions:0}),y.add(e)),n()},this))},this),m.bind(function(){y.flush(m.bind(function(){c()},this))},this))},this))},this))},setupDynamicPanels:function(e,n){n=n||_,this.mappingServer.getPanels({browser:a.browser,tag:a.tags[0],user_state:e||"unregistered"},m.bind(function(e,t){e?n():this.processPanelData(t.panels,n)},this))},panelConversionCheck:function(e,t){if(t=t||_,ABINE_DNTME.lastPanel&&ABINE_DNTME.lastPanel[e]){var n=ABINE_DNTME.lastPanel[e];delete ABINE_DNTME.lastPanel[e],g.PanelActivity.findBy("panelId",n,function(e){e&&e.completions++,y.flush(function(){t()})})}else t()},
// sends non-marketing panel activity to license server
sendPanelActivity:function(e){function p(){e&&e(),e=null}g.Preference.batchFindBy([{by:"key",value:"shouldSendErrorReports"},{by:"key",value:"suggestProtectedEmail"},{by:"key",value:"suggestProtectedPhone"},{by:"key",value:"entitledToPhone"},{by:"key",value:"hasEnabledPayments"},{by:"key",value:"suggestProtectedCard"},{by:"key",value:"suggestRealCard"},{by:"key",value:"suggestAddresses"},{by:"key",value:"suggestStrongPassword"},{by:"key",value:"helpMeLogin"},{by:"key",value:"rememberAccounts"}],m.bind(function(h){g.ShieldedPhone.index(null,m.bind(function(e){h.browsing=ABINE_DNTME.dnt_api.getDefaultBlocking(),h.errors=h.shouldSendErrorReports&&h.shouldSendErrorReports.isTrue(),h.email=h.suggestProtectedEmail&&h.suggestProtectedEmail.isTrue(),h.phone=h.suggestProtectedPhone&&h.suggestProtectedPhone.isTrue()&&h.entitledToPhone&&h.entitledToPhone.isTrue()&&0<e.length&&e[0].isValidated(),h.card=h.suggestProtectedCard&&h.suggestProtectedCard.isTrue()&&h.hasEnabledPayments&&h.hasEnabledPayments.isTrue(),h.password=h.suggestStrongPassword&&h.suggestStrongPassword.isTrue(),h.address=h.suggestAddresses&&h.suggestAddresses.isTrue(),h.realcard=h.suggestRealCard&&h.suggestRealCard.isTrue(),h.login=h.helpMeLogin&&h.helpMeLogin.isTrue(),h.account=h.rememberAccounts&&h.rememberAccounts.isTrue(),h.errors?g.Account.index(null,m.bind(function(f){g.Address.index(null,m.bind(function(d){g.RealCard.index(null,m.bind(function(a){g.Identity.index(null,m.bind(function(n){g.Note.index(null,m.bind(function(t){g.AccountHistory.index(null,m.bind(function(e){var i=a.length,r=d.length,s=f.length,o=n.length,c=e.length,l=t.length,u=0;u=f.filter(function(e){return!!(e.email||e.username||"").match(new RegExp("@(opayq.com|dontrack.me|abinemail.com|beconfidential.com|blurmail.net|blurme.net|maskmemail.com|maskedmails.com|maskedmail.net|oo-mail.net|goobers.net|maskmemail.net)$","i"))}).length,g.Blacklist.index(null,m.bind(function(e){var a={account:0,address:0,card:0,domain:0,email:0,password:0,phone:0,real_card:0,save_account:0,tracker:0};m.each(e,function(e){m.each(e._data,function(e,t){e&&(a[t]=a[t]+1)})}),g.PanelActivity.index(null,m.bind(function(t){var n={panel_data:{global_settings:{account:h.account?1:0,address:h.address?1:0,card:h.card?1:0,email:h.email?1:0,password:h.password?1:0,phone:h.phone?1:0,real_card:h.realcard?1:0,login:h.login?1:0,tracker:h.browsing?1:0},site_totals:{account:a.account,address:a.address,card:a.card,domain:a.domain,email:a.email,password:a.password,phone:a.phone,real_card:a.real_card,save_account:a.save_account,tracker:a.tracker},user_counts:{accounts_count:s,masked_email_accounts_count:u,real_cards_count:i,addresses_count:r,identities_count:o,notes_count:l,histories_count:c}}};m.each(t,function(e){!e.isMarketingPanel()&&e.hasData()&&(n.panel_data||(n.panel_data={}),n.panel_data[e.panelId]=e.toJSON())}),n.panel_data?this.licenseServer.sendPanelActivity(n,function(e){e?p():(m.each(t,function(e){e.panelId in n.panel_data&&e.reset(n.panel_data[e.panelId])}),y.flush(function(){p()}))}):p()},this))},this))},this))},this))},this))},this))},this))},this)):p()},this))},this))}}))({});return o.panelsModule=S}),ABINE_DNTME.define("abine/modules/mappings",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","abine/ajax","abine/config","abine/securityManager","abine/mappingServer","modules","abine/localStorage"],function(r,e,n,s,o,a,t,c,i,l,u){var d=function(){},f=864e5,h=function(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},p=new(e.BaseClass.extend({initialize:function(e){this.mappingServer=e.mappingServer||new i},startDailyMappingCheck:function(t){t=t||d,s.Preference.findBy("key","lastMappingCheck",r.bind(function(e){e&&e.value?new Date(parseInt(e.value)).valueOf()<(new Date).getTime()-f?this.makeDailyMappingCheck(t):this.delayDailyMappingCheck(t):this.makeDailyMappingCheck(t)},this))},forceMappingUpdate:function(e,t){t||(t=e,e=!1),e||(s.Preference.removeByKey("mapping-version"),s.MappedForm.clearForms()),this.makeDailyMappingCheck(t)},processMapping:function(e,t){Date.now();s.MappedForm.clearForms(),e.login_urls&&s.LoginUrl.saveAll(e.login_urls);var n=[];r.each(e.mappings,function(e){var t={domain:e.domain,signature:e.signature,mapping_signature:e.mapping_signature,formType:e.formType,fields:e.fields};n.push(t)}),s.MappedForm.saveAllForms(n),this.writeDailyMappingCheckPref(r.bind(function(){this.delayDailyMappingCheck(function(){t()})},this))},refreshPanels:function(){s.Preference.batchFindBy([{by:"key",value:"lastUserState"},{by:"key",value:"dynamicPanels"},{by:"key",value:"hasRegistered"},{by:"key",value:"entitledToPhone"}],r.bind(function(e){var t=e.lastUserState?e.lastUserState.value:"",n="unregistered";e.hasRegistered&&e.hasRegistered.isTrue()&&(n=e.entitledToPhone&&e.entitledToPhone.isTrue()?"premium":"registered"),t==n&&e.dynamicPanels||this.makeDailyMappingCheck(!0)},this))},updateFormRules:function(){try{var e="https://rules.abine.com/form-rules-"+ABINE_DNTME.config.environment+".json?from=extension",n=this;a.ajax({url:e,success:function(e){try{(e=JSON.parse(e))&&e.Version&&(u.setItem("form-rules",JSON.stringify(e)),n._cachedFormRules=e)}catch(t){}}})}catch(t){}},setFormRules:function(e){this._cachedFormRules=e},getFormRules:function(e){if(!this._cachedFormRules){var t=u.getItem("form-rules");if(t)try{t=JSON.parse(t),this._cachedFormRules=t}catch(n){}}e(this._cachedFormRules)},makeDailyMappingCheck:function(e,i){e&&!0!==e&&(i=e,e=!1),i=i||d,ABINE_DNTME.maskme_installed?i():(s.RealCard.updateCardRules(),this.updateFormRules(),l.panelsModule.sendPanelActivity(r.bind(function(){var a={get_panels:1,get_login_urls:1,product:"dntme",tag:ABINE_DNTME.config.tags[0],browser:ABINE_DNTME.config.browser};e&&(a.exclude_mapping=!0);var n=r.bind(function(n){s.Preference.findBy("key","shouldSendErrorReports",r.bind(function(e){if(!e||e.isTrue()){s.Preference.findBy("key","mapping:mapper",r.bind(function(i){s.Preference.findBy("key","mapping:batch",r.bind(function(e){var t=u.getItem("mapping-to-push");if(t&&(!c.isLocked()||i))try{var n={forms:t=JSON.parse(t)};i&&i.value&&(n.mapper=i.value),e&&e.value&&"null"!=e.value&&"undefined"!=e.value&&(n.batch=e.value),n.mapper||(n.mapper="user-"+u.getItem("device_id")),this.mappingServer.pushMapping(n,r.bind(function(e){e||u.removeItem("mapping-to-push")},this))}catch(a){u.removeItem("mapping-to-push")}},this))},this));var t=u.getItem("fieldData-to-push");if(t&&"{}"!=t){try{t=JSON.parse(t),this.mappingServer.saveFieldData({field_data:t,anonId:c.getAnonymousId()})}catch(i){}u.removeItem("fieldData-to-push")}var n=u.getItem("trackerData-to-push");if(n&&"{}"!=n){try{n=JSON.parse(n),this.mappingServer.saveTrackerData({t:n,anonId:c.getAnonymousId(),"new":1})}catch(i){}u.removeItem("trackerData-to-push")}var a=u.getItem("pageData-to-push");if(a&&"{}"!=a){try{a=JSON.parse(a),this.mappingServer.savePageData({p:a,anonId:c.getAnonymousId()})}catch(i){}u.removeItem("pageData-to-push")}}else u.removeItem("pageData-to-push"),u.removeItem("trackerData-to-push"),u.removeItem("fieldData-to-push"),u.removeItem("mapping-to-push")},this)),this.mappingServer.getMappingVersion(r.bind(function(e,t){e?this.delayDailyMappingCheck(function(){i()}):s.Preference.findBy("key","mapping-version",r.bind(function(e){!e||parseInt(e.value)<parseInt(t)?(s.Preference.createOrModify({key:"mapping-version",value:t},d),this.mappingServer.getMappings(r.bind(function(e,t){e?this.delayDailyMappingCheck(function(){i()}):(t.new_version&&t.new_version!=ABINE_DNTME.config.version?s.Preference.createOrModify({key:"new_version",value:t.new_version},d):s.Preference.removeByKey("new_version"),t.mappings&&this.processMapping(t,i),t.panels&&s.Preference.createOrModify({key:"lastUserState",value:a.user_state},r.bind(function(){l.panelsModule.processPanelData({panels:t.panels})},this)),n&&n())},this))):this.writeDailyMappingCheckPref(r.bind(function(){this.delayDailyMappingCheck(function(){n&&n()})},this))},this))},this))},this);s.Preference.batchFindBy([{by:"key",value:"shouldSendErrorReports"},{by:"key",value:"dynamicPanels"},{by:"key",value:"hasRegistered"},{by:"key",value:"entitledToPhone"}],r.bind(function(e){if(e.hasRegistered&&e.hasRegistered.isTrue()?e.entitledToPhone&&e.entitledToPhone.isTrue()?a.user_state="premium":a.user_state="registered":a.user_state="unregistered",e.dynamicPanels){var t=JSON.parse(e.dynamicPanels.value);r.each(t.panels,function(e){a.current_panels||(a.current_panels=[]),a.current_panels.push(e.id)})}a.current_panels||(a.current_panels=[-1]),e.shouldSendErrorReports&&e.shouldSendErrorReports.isTrue()?s.PanelActivity.index(null,r.bind(function(e){r.each(e,function(e){e.isMarketingPanel()&&e.hasData()&&(a.panel_data||(a.panel_data={}),a.panel_data[e.panelId]=e.toJSON())}),a.panel_data?n(function(){r.each(e,function(e){e.panelId in a.panel_data&&e.reset(a.panel_data[e.panelId])}),o.flush()}):n()},this)):n()},this))},this)))},writeDailyMappingCheckPref:function(t){t=t||d,s.Preference.findOrCreate({key:"lastMappingCheck"},function(e){e.value=Math.floor(h().valueOf()),e.modifiedAt=h(),o.flush(function(){t()})})},sendTrackerAllow:function(e,t,n,a){t=t.replace(/[\?].+$/,""),this.mappingServer.sendTrackerAllow({domain:e,url:t,tracker:n,version:a})},delayDailyMappingCheck:function(e){e=e||d;var t=18e5+36e5*Math.random();this.dailyMappingCheckTimeout&&n.clearTimeout(this.dailyMappingCheckTimeout),this.dailyMappingCheckTimeout=n.setTimeout(r.bind(this.startDailyMappingCheck,this),t),e()},getMapperDetails:function(n){this.mappingServer.getMapperDetails({},r.bind(function(e,t){e?n():n(t)},this))},getOneFormMappings:function(e,n){this.mappingServer.getOneFormMappings(e,r.bind(function(e,t){e?n():n(t)},this))},sendAutofillFeedback:function(e,n){this.mappingServer.sendAutofillFeedback(e,r.bind(function(e,t){e?n():n(t)},this))},sendFormBlob:function(e,n){this.mappingServer.sendFormBlob(e,r.bind(function(e,t){e?n():n(t)},this))}}))({});return l.mappingsModule=p}),ABINE_DNTME.define("abine/modules/criticalProcess",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","modules"],function(e,t,n,a,i,r){var s=function(){},o=new(t.BaseClass.extend({initialize:function(e,t){t=t||s},setMessenger:function(e){this.messenger=e},start:function(e){this.messenger.broadcast("background:criticalprocess:start",e)},end:function(e){this.messenger.broadcast("background:criticalprocess:end",e)},update:function(e){this.messenger.broadcast("background:criticalprocess:update",e)},askForReview:function(e){this.messenger.broadcast("background:criticalprocess:review",e)},error:function(e){this.messenger.broadcast("background:criticalprocess:error",e)}}))({});return r.criticalProcess=o}),ABINE_DNTME.define("abine/modules/payments",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","modules","abine/paymentsServer","abine/memoryStore"],function(a,e,t,n,i,r,s,o){var c=new(e.BaseClass.extend({initialize:function(e){this.paymentsServer=e.paymentsServer||new s},retrieveCardCredit:function(n){this.paymentsServer.retrieveCardCredit({},a.bind(function(e,t){e?n(e):n(null,t)}))},retrieveCardFee:function(e,n){this.paymentsServer.retrieveCardFee(e,a.bind(function(e,t){e?n(e):n(null,t)}))},verifyCardRequest:function(t,n){o.get("biometricKeyToken",a.bind(function(e){e&&(t.old_token=e),this.paymentsServer.verifyCardRequest(t,a.bind(function(e,t){e?n(e):n(null,t)}))},this))}}))({});return r.paymentsModule=c}),ABINE_DNTME.define("abine/modules/phone",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","modules","abine/phoneServer"],function(t,e,n,a,i,r,s){var o=function(){},c=new(e.BaseClass.extend({initialize:function(e){this.phoneServer=e.phoneServer||new s},getPhone:function(e,n){n=n||o,this.phoneServer.getPhone(e,t.bind(function(e,t){n(e,t)},this))},logDisposableFilled:function(e,n){n=n||o,this.phoneServer.logDisposableFilled(e,t.bind(function(e,t){n(e,t)},this))},restorePhone:function(e,n){n=n||o,this.phoneServer.restorePhone(e,t.bind(function(e,t){n(e,t)},this))}}))({});return r.phoneModule=c}),ABINE_DNTME.define("abine/modules/email",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","modules","abine/emailServer"],function(t,e,n,a,i,r,s){var o=function(){},c=new(c=e.BaseClass.extend({initialize:function(e){this.server=e.server||new s},sendDomainFeedback:function(e,n){n=n||o,this.server.sendDomainFeedback(e,t.bind(function(e,t){e?n(e):n(null,t)}))}}))({});return r.EmailModule=c}),ABINE_DNTME.define("modules",[],function(){return{}}),ABINE_DNTME.require("abine/modules/license"),ABINE_DNTME.require("abine/modules/payments"),ABINE_DNTME.require("abine/modules/panels"),ABINE_DNTME.require("abine/modules/phone"),ABINE_DNTME.require("abine/modules/mappings"),ABINE_DNTME.require("abine/modules/criticalProcess"),ABINE_DNTME.require("abine/modules/email"),ABINE_DNTME.require("abine/storage/blacklist"),ABINE_DNTME.require("abine/storage/disposableCard"),ABINE_DNTME.require("abine/storage/disposableEmail"),ABINE_DNTME.require("abine/storage/disposablePhone"),ABINE_DNTME.require("abine/storage/loginUrl"),ABINE_DNTME.require("abine/storage/extensionVersion"),ABINE_DNTME.require("abine/storage/autofillFeedback"),ABINE_DNTME.require("abine/storage/mappedForm"),ABINE_DNTME.require("abine/storage/mappedField"),ABINE_DNTME.require("abine/storage/panelActivity"),ABINE_DNTME.require("abine/storage/preference"),ABINE_DNTME.require("abine/storage/shieldedCard"),ABINE_DNTME.require("abine/storage/shieldedEmail"),ABINE_DNTME.require("abine/storage/shieldedPhone"),ABINE_DNTME.require("abine/storage/emailDomain"),ABINE_DNTME.require("abine/storage/fieldData"),ABINE_DNTME.require("abine/storage/trackerData"),ABINE_DNTME.require("abine/storage/pageData"),ABINE_DNTME.require("abine/storage/tabData"),ABINE_DNTME.require("abine/storage/address"),ABINE_DNTME.require("abine/storage/identity"),ABINE_DNTME.require("abine/storage/accountHistory"),ABINE_DNTME.require("abine/storage/account"),ABINE_DNTME.require("abine/storage/companyAccount"),ABINE_DNTME.require("abine/storage/realCard"),ABINE_DNTME.require("abine/storage/globalData"),ABINE_DNTME.require("abine/storage/dntStats"),ABINE_DNTME.require("abine/storage/note"),ABINE_DNTME.require("abine/storage/trackerInfo"),ABINE_DNTME.require("abine/storage/advt"),ABINE_DNTME.context="BG",ABINE_DNTME.define("aws",function(){return ABINE_DNTME.AWS=AWS,AWS}),ABINE_DNTME.require(["documentcloud/underscore","abine/window","abine/backgroundMessenger","abine/backgroundInit","abine/eventLogger","abine/stubs","abine/contextMenu","abine/webapp","abine/localStorage","abine/blurstore-api"],function(e,t,n,a,i,r,s,o,c){function l(){chrome.windows.getLastFocused({populate:!0},function(e){for(var t=0;t<e.tabs.length;t++)if(e.tabs[t].active){u.trigger("toolbar:clicked",{tabId:e.tabs[t].id});break}})}ABINE_DNTME.MASKME_EXTENSION_ID={dpkiidbpeijnaaacjlfnijncdlkicejg:1,klmeacceapcofljgjhopncjdlekjjmpp:1},ABINE_DNTME.userAgent=window.navigator.userAgent,chrome.runtime&&chrome.runtime.onMessageExternal&&chrome.runtime.onMessageExternal.addListener(function(e,t){t.id in ABINE_DNTME.MASKME_EXTENSION_ID&&(ABINE_DNTME.maskme_installed=!0,c.setItem("maskme.installed","1"))});var u=new n.BackgroundMessenger;ABINE_DNTME.backgroundMessenger=u,a.once("storage:initialized",function(){chrome.browserAction.onClicked.addListener(function(){ABINE_DNTME.config.environment,l()}),s.contextMenuHelper.init(u),chrome.tabs.query({},function(e){for(var t={file:"old_tab_content.js",allFrames:!1,runAt:"document_idle"},n=0;n<e.length;n++)try{-1==e[n].url.indexOf(ABINE_DNTME.config.webAppHost)&&0==e[n].url.indexOf("http")&&chrome.tabs.executeScript(e[n].id,t)}catch(a){}}),o.reload()}),a.initialize(u),chrome.extension.onRequest.addListener(function(e,n){function a(e){if(!(e>=i.length)){if(i[e].file)var t=i[e];else t={file:i[e],allFrames:!0,runAt:"document_idle"};"undefined"!=typeof n.frameId&&n.frameId&&(delete t.allFrames,t.frameId=n.frameId),chrome.tabs.executeScript(n.tab.id,t,function(){a(e+1)})}}if(!ABINE_DNTME.maskme_installed)if("injectContentScript"==e.eventName){var i=["almond-min.js","jquery-min.js","underscore-min.js","backbone-min.js","common.js","common-content.js"];i.push(e.payload),a(0)}else"processFormsInNewFrame"==e.eventName&&u.send("contentManager:processNewFrame",e.frame_id,n.tab.id)});Date.now(),ABINE_DNTME.startTime});