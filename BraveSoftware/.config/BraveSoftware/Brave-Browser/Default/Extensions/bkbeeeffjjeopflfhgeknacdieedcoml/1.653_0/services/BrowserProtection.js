"use strict";var BrowserProtection=function(){var n=[],t=function(n){return TopSites.isTopSite(n.toLowerCase())},i=function(n,i){if(n&&i){var r=(new Date).getTime(),u=new URI(n);t(u.hostname())?i(new BrowserProtectionResult(n,BrowserProtectionResult.ResultType.KNOWNSAFE,BrowserProtectionResult.ResultOrigin.TOPSITE),(new Date).getTime()-r):Settings.get(function(t){var o=window.navigator.languages?window.navigator.languages[0]:window.navigator.userLanguage||window.navigator.language;var l=navigator.appVersion,a=navigator.userAgent,v=navigator.appName,y=""+parseFloat(navigator.appVersion),f=JSON.stringify({correlationId:TelemetryManager.generateGuid(),destination:{uri:UrlHelpers.normalizeHostname(u.hostname()+u.path())},identity:{client:{version:chrome.runtime.getManifest().version.replace(".","")},device:{id:t.instanceID},user:{locale:o}},userAgent:navigator.userAgent}),e=PatentHash.hash(f),s=JSON.stringify({authId:"6D2E7D9C-1334-4FC2-A549-5EC504F0E8F1",hash:e.hash,key:e.key}),h="SmartScreenHash "+btoa(s),c={additionalHeaders:{Authorization:h},url:"https://bf.smartscreen.microsoft.com/api/browser/Navigate/1",contentType:"application/json; charset=utf-8",crossDomain:!0,data:f};awa.service.post(c).then(function(t){var u,f;t.allow?(u=BrowserProtectionResult.ResultType.ALLOWED,t.responseCategory==="Untrusted"&&(u=BrowserProtectionResult.ResultType.UNTRUSTED),i(new BrowserProtectionResult(n,u,BrowserProtectionResult.ResultOrigin.ENDPOINT),(new Date).getTime()-r)):(f=BrowserProtectionResult.ResultType.MALICIOUS,t.responseCategory==="Phishing"&&(f=BrowserProtectionResult.ResultType.PHISHING),i(new BrowserProtectionResult(n,f,BrowserProtectionResult.ResultOrigin.ENDPOINT,t.reportFeedback),(new Date).getTime()-r))},function(){i(new BrowserProtectionResult(n,BrowserProtectionResult.ResultType.ALLOWED,BrowserProtectionResult.ResultOrigin.FAIL),(new Date).getTime()-r)})})}},r=function(t){if(t){var i=new URI(t);n.push(i.hostname()+i.path())}},u=function(t){if(t){var i=new URI(t),r=i.hostname()+i.path();n=n.filter(function(n){return n!==r})}},f=function(t){var r=!1;if(t){var i=new URI(t),u=i.hostname()+i.path(),f=i.domain();r=n.some(function(n){return n===u})}return r};return{checkIfUriIsMalicious:i,addUrlToBypassList:r,removeUrlFromBypassList:u,isUrlOnBypassList:f}}()